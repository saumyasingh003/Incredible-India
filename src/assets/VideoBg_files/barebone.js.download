/* VimeoPlayer - v4.24.28 - 2023-08-30 - https://player.vimeo.com/NOTICE.txt */
!function(t){"use strict";var n={object:!0,symbol:!0},i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,n,i){return t(i={path:n,exports:{},require:function(t,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&i.path)}},i.exports),i.exports}var r,u,o,s,a=function(t){return null!=t},c=Object.keys,h=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}()?Object.keys:function(t){return c(a(t)?Object(t):t)},f=function(t){if(!a(t))throw new TypeError("Cannot use null or undefined");return t},l=Math.max,d=function(){var t,n=Object.assign;return"function"==typeof n&&(n(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}()?Object.assign:function(t,n){var i,e,r,u=l(arguments.length,2);for(t=Object(f(t)),r=function(e){try{t[e]=n[e]}catch(t){i||(i=t)}},e=1;e<u;++e)h(n=arguments[e]).forEach(r);if(void 0!==i)throw i;return t},v=Array.prototype.forEach,p=Object.create,m=function(t,n){var i;for(i in t)n[i]=t[i]},y=function(t){var n=p(null);return v.call(arguments,(function(t){a(t)&&m(Object(t),n)})),n},w=function(t){return"function"==typeof t},b="razdwatrzy",g=String.prototype.indexOf,_="function"==typeof b.contains&&!0===b.contains("dwa")&&!1===b.contains("foo")?String.prototype.contains:function(t){return g.call(this,t,arguments[1])>-1},E=e((function(t){(t.exports=function(t,n){var i,e,r,u,o;return arguments.length<2||"string"!=typeof t?(u=n,n=t,t=null):u=arguments[2],null==t?(i=r=!0,e=!1):(i=_.call(t,"c"),e=_.call(t,"e"),r=_.call(t,"w")),o={value:n,configurable:i,enumerable:e,writable:r},u?d(y(u),o):o}).gs=function(t,n,i){var e,r,u,o;return"string"!=typeof t?(u=i,i=n,n=t,t=null):u=arguments[3],null==n?n=void 0:w(n)?null==i?i=void 0:w(i)||(u=i,i=void 0):(u=n,n=i=void 0),null==t?(e=!0,r=!1):(e=_.call(t,"c"),r=_.call(t,"e")),o={get:n,set:i,configurable:e,enumerable:r},u?d(y(u),o):o}})),k=function(t){if(!function(t){return!!t&&("symbol"==typeof t||!!t.constructor&&"Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag])}(t))throw new TypeError(t+" is not a symbol");return t},T=Object.create,S=Object.defineProperties,A=Object.defineProperty,R=Object.prototype,O=T(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),s=!0}catch(t){}}var M=function(){var t=T(null);return function(n){for(var i,e,r=0;t[n+(r||"")];)++r;return t[n+=r||""]=!0,A(R,i="@@"+n,E.gs(null,(function(t){e||(e=!0,A(this,i,E(t)),e=!1)}))),i}}();o=function(t){if(this instanceof o)throw new TypeError("TypeError: Symbol is not a constructor");return u(t)};var j=u=function t(n){var i;if(this instanceof t)throw new TypeError("TypeError: Symbol is not a constructor");return s?r(n):(i=T(o.prototype),n=void 0===n?"":String(n),S(i,{t:E("",n),i:E("",M(n))}))};S(u,{for:E((function(t){return O[t]?O[t]:O[t]=u(String(t))})),keyFor:E((function(t){var n;for(n in k(t),O)if(O[n]===t)return n})),hasInstance:E("",r&&r.hasInstance||u("hasInstance")),isConcatSpreadable:E("",r&&r.isConcatSpreadable||u("isConcatSpreadable")),iterator:E("",r&&r.iterator||u("iterator")),match:E("",r&&r.match||u("match")),replace:E("",r&&r.replace||u("replace")),search:E("",r&&r.search||u("search")),species:E("",r&&r.species||u("species")),split:E("",r&&r.split||u("split")),toPrimitive:E("",r&&r.toPrimitive||u("toPrimitive")),toStringTag:E("",r&&r.toStringTag||u("toStringTag")),unscopables:E("",r&&r.unscopables||u("unscopables"))}),S(o.prototype,{constructor:E(u),toString:E("",(function(){return this.i}))}),S(u.prototype,{toString:E((function(){return"Symbol ("+k(this).t+")"})),valueOf:E((function(){return k(this)}))}),A(u.prototype,u.toPrimitive,E("",(function(){var t=k(this);return"symbol"==typeof t?t:t.toString()}))),A(u.prototype,u.toStringTag,E("c","Symbol")),A(o.prototype,u.toStringTag,E("c",u.prototype[u.toStringTag])),A(o.prototype,u.toPrimitive,E("c",u.prototype[u.toPrimitive]));var C=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!n[typeof Symbol.iterator]&&!!n[typeof Symbol.toPrimitive]&&!!n[typeof Symbol.toStringTag]}()?Symbol:j;if(function(){for(var t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n){var i=t[n];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),"undefined"!=typeof DOMTokenList&&!function(){var t=document.createElement("div");return t.classList.toggle("test-class",!1),!t.classList.contains("test-class")}()){var I=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,n){!0!==n?!1!==n?I.call(this,t):this.remove(t):this.add(t)}}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function N(t,n,i){return n&&D(t.prototype,n),i&&D(t,i),t}function P(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function L(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,e)}return i}function F(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?L(Object(i),!0).forEach((function(n){P(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function U(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,n){return(B=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function q(t,n,i){return(q=V()?Reflect.construct:function(t,n,i){var e=[null];e.push.apply(e,n);var r=new(Function.bind.apply(t,e));return i&&B(r,i.prototype),r}).apply(null,arguments)}function W(t){var n="function"==typeof Map?new Map:void 0;return(W=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return q(t,arguments,H(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),B(i,t)})(t)}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],e=!0,r=!1,u=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done)&&(i.push(o.value),!n||i.length!==n);e=!0);}catch(t){r=!0,u=t}finally{try{e||null==s.return||s.return()}finally{if(r)throw u}}return i}}(t,n)||z(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(t){return function(t){if(Array.isArray(t))return K(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,n){if(t){if("string"==typeof t)return K(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?K(t,n):void 0}}function K(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}function X(t,n){return t===n||t!=t&&n!=n}function J(t,n){for(var i=t.length;i--;)if(X(t[i][0],n))return i;return-1}"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var e=arguments[i];if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])}return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var u=n[r];if(t.call(e,u,r,n))return u;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){for(var n=Object(this),i=n.length>>>0,e=arguments[1],r=0;r<i;){var u=n[r];if(t.call(e,u,r,n))return r;r++}return-1}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,n){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),e=i.length>>>0;if(0===e)return!1;var r=0|n,u=Math.max(r>=0?r:e-Math.abs(r),0);function o(t,n){return t===n||"number"==typeof t&&"number"==typeof n&&isNaN(t)&&isNaN(n)}for(;u<e;){if(o(i[u],t))return!0;u++}return!1}}),String.prototype.includes||(String.prototype.includes=function(t,n){return"number"!=typeof n&&(n=0),!(n+t.length>this.length)&&-1!==this.indexOf(t,n)}),Object.values||(Object.values=function(t){return Object.keys(t).map((function(n){return t[n]}))}),String.prototype.startsWith||(String.prototype.startsWith=function(t,n){return this.slice(n||0,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,n){return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-t.length,n)===t}),Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!=t},void 0===Number.parseFloat&&(Number.parseFloat=window.parseFloat),void 0===Number.parseInt&&(Number.parseInt=window.parseInt),void 0===Number.isFinite&&(Number.isFinite=function(t){return"number"==typeof t&&isFinite(t)}),Array.prototype.entries||(Array.prototype.entries=function(){var t,n=this,i=0;function e(){}return e.prototype.next=function(){return i>n.length-1&&(t=!0),t?{value:void 0,done:!0}:{value:[i,n[i++]],done:!1}},e.prototype[C.iterator]=function(){return this},new e}),Array.prototype[C.iterator]||(Array.prototype[C.iterator]=function(){var t,n=this,i=0;function e(){}return e.prototype.next=function(){return i>n.length-1&&(t=!0),t?{value:void 0,done:!0}:{value:n[i++],done:!1}},e.prototype[C.iterator]=function(){return this},new e}),Object.entries||(Object.entries=function(t){for(var n=Object.keys(t),i=n.length,e=new Array(i);i--;)e[i]=[n[i],t[n[i]]];return e}),Object.is||Object.defineProperty(Object,"is",{value:function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}}),"classList"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"classList",{get:function(){var t=this;return{contains:function(n){return-1!==t.className.baseVal.split(" ").indexOf(n)},add:function(n){var i=(t.getAttribute("class")+" "+n).trim();return t.setAttribute("class",i)},remove:function(n){var i=t.getAttribute("class")||"",e=new RegExp("(?:^|\\s)"+n+"(?!\\S)","g");i=i.replace(e,"").trim(),t.setAttribute("class",i)},toggle:function(t){this.contains(t)?this.remove(t):this.add(t)}}}});var Q=Array.prototype.splice;function Z(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}Z.prototype.clear=function(){this.u=[],this.size=0},Z.prototype.delete=function(t){var n=this.u,i=J(n,t);return!(i<0||(i==n.length-1?n.pop():Q.call(n,i,1),--this.size,0))},Z.prototype.get=function(t){var n=this.u,i=J(n,t);return i<0?void 0:n[i][1]},Z.prototype.has=function(t){return J(this.u,t)>-1},Z.prototype.set=function(t,n){var i=this.u,e=J(i,t);return e<0?(++this.size,i.push([t,n])):i[e][1]=n,this};var tt="object"==("undefined"==typeof global?"undefined":x(global))&&global&&global.Object===Object&&global,nt="object"==("undefined"==typeof self?"undefined":x(self))&&self&&self.Object===Object&&self,it=tt||nt||Function("return this")(),et=it.Symbol,rt=Object.prototype,ut=rt.hasOwnProperty,ot=rt.toString,st=et?et.toStringTag:void 0,at=Object.prototype.toString,ct=et?et.toStringTag:void 0;function ht(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":ct&&ct in Object(t)?function(t){var n=ut.call(t,st),i=t[st];try{t[st]=void 0;var e=!0}catch(t){}var r=ot.call(t);return e&&(n?t[st]=i:delete t[st]),r}(t):function(t){return at.call(t)}(t)}function ft(t){var n=x(t);return null!=t&&("object"==n||"function"==n)}function lt(t){if(!ft(t))return!1;var n=ht(t);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}var dt=it["h"],vt=function(){var t=/[^.]+$/.exec(dt&&dt.keys&&dt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),pt=Function.prototype.toString;function mt(t){if(null!=t){try{return pt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var yt=/^\[object .+?Constructor\]$/,wt=Function.prototype,bt=Object.prototype,gt=wt.toString,_t=bt.hasOwnProperty,Et=RegExp("^"+gt.call(_t).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function kt(t,n){var i=function(t,n){return null==t?void 0:t[n]}(t,n);return function(t){return!(!ft(t)||function(t){return!!vt&&vt in t}(t))&&(lt(t)?Et:yt).test(mt(t))}(i)?i:void 0}var Tt=kt(it,"Map"),St=kt(Object,"create"),At=Object.prototype.hasOwnProperty,Rt=Object.prototype.hasOwnProperty;function Ot(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function Mt(t,n){var i=t.u;return function(t){var n=x(t);return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t}(n)?i["string"==typeof n?"string":"hash"]:i.map}function jt(t){var n=-1,i=null==t?0:t.length;for(this.clear();++n<i;){var e=t[n];this.set(e[0],e[1])}}function Ct(t){var n=this.u=new Z(t);this.size=n.size}Ot.prototype.clear=function(){this.u=St?St(null):{},this.size=0},Ot.prototype.delete=function(t){var n=this.has(t)&&delete this.u[t];return this.size-=n?1:0,n},Ot.prototype.get=function(t){var n=this.u;if(St){var i=n[t];return"__lodash_hash_undefined__"===i?void 0:i}return At.call(n,t)?n[t]:void 0},Ot.prototype.has=function(t){var n=this.u;return St?void 0!==n[t]:Rt.call(n,t)},Ot.prototype.set=function(t,n){var i=this.u;return this.size+=this.has(t)?0:1,i[t]=St&&void 0===n?"__lodash_hash_undefined__":n,this},jt.prototype.clear=function(){this.size=0,this.u={hash:new Ot,map:new(Tt||Z),string:new Ot}},jt.prototype.delete=function(t){var n=Mt(this,t).delete(t);return this.size-=n?1:0,n},jt.prototype.get=function(t){return Mt(this,t).get(t)},jt.prototype.has=function(t){return Mt(this,t).has(t)},jt.prototype.set=function(t,n){var i=Mt(this,t),e=i.size;return i.set(t,n),this.size+=i.size==e?0:1,this},Ct.prototype.clear=function(){this.u=new Z,this.size=0},Ct.prototype.delete=function(t){var n=this.u,i=n.delete(t);return this.size=n.size,i},Ct.prototype.get=function(t){return this.u.get(t)},Ct.prototype.has=function(t){return this.u.has(t)},Ct.prototype.set=function(t,n){var i=this.u;if(i instanceof Z){var e=i.u;if(!Tt||e.length<199)return e.push([t,n]),this.size=++i.size,this;i=this.u=new jt(e)}return i.set(t,n),this.size=i.size,this};var It=function(){try{var t=kt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function xt(t,n,i){"__proto__"==n&&It?It(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}var Dt=Object.prototype.hasOwnProperty;function Nt(t,n,i){var e=t[n];Dt.call(t,n)&&X(e,i)&&(void 0!==i||n in t)||xt(t,n,i)}function Pt(t,n,i,e){var r=!i;i||(i={});for(var u=-1,o=n.length;++u<o;){var s=n[u],a=e?e(i[s],t[s],s,i,t):void 0;void 0===a&&(a=t[s]),r?xt(i,s,a):Nt(i,s,a)}return i}function Lt(t){return null!=t&&"object"==x(t)}function Ft(t){return Lt(t)&&"[object Arguments]"==ht(t)}var Ut=Object.prototype,Ht=Ut.hasOwnProperty,Bt=Ut.propertyIsEnumerable,Vt=Ft(function(){return arguments}())?Ft:function(t){return Lt(t)&&Ht.call(t,"callee")&&!Bt.call(t,"callee")},qt=Array.isArray,Wt="object"==(void 0===t?"undefined":x(t))&&t&&!t.nodeType&&t,Gt=Wt&&"object"==("undefined"==typeof module?"undefined":x(module))&&module&&!module.nodeType&&module,$t=Gt&&Gt.exports===Wt?it.Buffer:void 0,Yt=($t?$t.isBuffer:void 0)||function(){return!1},zt=/^(?:0|[1-9]\d*)$/;function Kt(t,n){var i=x(t);return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&zt.test(t))&&t>-1&&t%1==0&&t<n}function Xt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Jt={};function Qt(t){return function(n){return t(n)}}Jt["[object Float32Array]"]=Jt["[object Float64Array]"]=Jt["[object Int8Array]"]=Jt["[object Int16Array]"]=Jt["[object Int32Array]"]=Jt["[object Uint8Array]"]=Jt["[object Uint8ClampedArray]"]=Jt["[object Uint16Array]"]=Jt["[object Uint32Array]"]=!0,Jt["[object Arguments]"]=Jt["[object Array]"]=Jt["[object ArrayBuffer]"]=Jt["[object Boolean]"]=Jt["[object DataView]"]=Jt["[object Date]"]=Jt["[object Error]"]=Jt["[object Function]"]=Jt["[object Map]"]=Jt["[object Number]"]=Jt["[object Object]"]=Jt["[object RegExp]"]=Jt["[object Set]"]=Jt["[object String]"]=Jt["[object WeakMap]"]=!1;var Zt="object"==(void 0===t?"undefined":x(t))&&t&&!t.nodeType&&t,tn=Zt&&"object"==("undefined"==typeof module?"undefined":x(module))&&module&&!module.nodeType&&module,nn=tn&&tn.exports===Zt&&tt.process,en=function(){try{return tn&&tn.require&&tn.require("util").types||nn&&nn.binding&&nn.binding("util")}catch(t){}}(),rn=en&&en.isTypedArray,un=rn?Qt(rn):function(t){return Lt(t)&&Xt(t.length)&&!!Jt[ht(t)]},on=Object.prototype.hasOwnProperty;function sn(t,n){var i=qt(t),e=!i&&Vt(t),r=!i&&!e&&Yt(t),u=!i&&!e&&!r&&un(t),o=i||e||r||u,s=o?function(t,n){for(var i=-1,e=Array(t);++i<t;)e[i]=n(i);return e}(t.length,String):[],a=s.length;for(var c in t)!n&&!on.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||u&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Kt(c,a))||s.push(c);return s}var an=Object.prototype;function cn(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||an)}function hn(t,n){return function(i){return t(n(i))}}var fn=hn(Object.keys,Object),ln=Object.prototype.hasOwnProperty;function dn(t){if(!cn(t))return fn(t);var n=[];for(var i in Object(t))ln.call(t,i)&&"constructor"!=i&&n.push(i);return n}function vn(t){return null!=t&&Xt(t.length)&&!lt(t)}function pn(t){return vn(t)?sn(t):dn(t)}var mn=Object.prototype.hasOwnProperty;function yn(t){return vn(t)?sn(t,!0):function(t){if(!ft(t))return function(t){var n=[];if(null!=t)for(var i in Object(t))n.push(i);return n}(t);var n=cn(t),i=[];for(var e in t)("constructor"!=e||!n&&mn.call(t,e))&&i.push(e);return i}(t)}var wn="object"==(void 0===t?"undefined":x(t))&&t&&!t.nodeType&&t,bn=wn&&"object"==("undefined"==typeof module?"undefined":x(module))&&module&&!module.nodeType&&module,gn=bn&&bn.exports===wn?it.Buffer:void 0,_n=gn?gn.allocUnsafe:void 0;function En(t,n){if(n)return t.slice();var i=t.length,e=_n?_n(i):new t.constructor(i);return t.copy(e),e}function kn(t,n){var i=-1,e=t.length;for(n||(n=Array(e));++i<e;)n[i]=t[i];return n}function Tn(){return[]}var Sn=Object.prototype.propertyIsEnumerable,An=Object.getOwnPropertySymbols,Rn=An?function(t){return null==t?[]:(t=Object(t),function(t,n){for(var i=-1,e=null==t?0:t.length,r=0,u=[];++i<e;){var o=t[i];n(o)&&(u[r++]=o)}return u}(An(t),(function(n){return Sn.call(t,n)})))}:Tn;function On(t,n){for(var i=-1,e=n.length,r=t.length;++i<e;)t[r+i]=n[i];return t}var Mn=hn(Object.getPrototypeOf,Object),jn=Object.getOwnPropertySymbols?function(t){for(var n=[];t;)On(n,Rn(t)),t=Mn(t);return n}:Tn;function Cn(t,n,i){var e=n(t);return qt(t)?e:On(e,i(t))}function In(t){return Cn(t,pn,Rn)}function xn(t){return Cn(t,yn,jn)}var Dn=kt(it,"DataView"),Nn=kt(it,"Promise"),Pn=kt(it,"Set"),Ln=kt(it,"WeakMap"),Fn=mt(Dn),Un=mt(Tt),Hn=mt(Nn),Bn=mt(Pn),Vn=mt(Ln),qn=ht;(Dn&&"[object DataView]"!=qn(new Dn(new ArrayBuffer(1)))||Tt&&"[object Map]"!=qn(new Tt)||Nn&&"[object Promise]"!=qn(Nn.resolve())||Pn&&"[object Set]"!=qn(new Pn)||Ln&&"[object WeakMap]"!=qn(new Ln))&&(qn=function(t){var n=ht(t),i="[object Object]"==n?t.constructor:void 0,e=i?mt(i):"";if(e)switch(e){case Fn:return"[object DataView]";case Un:return"[object Map]";case Hn:return"[object Promise]";case Bn:return"[object Set]";case Vn:return"[object WeakMap]"}return n});var Wn=qn,Gn=Object.prototype.hasOwnProperty,$n=it.Uint8Array;function Yn(t){var n=new t.constructor(t.byteLength);return new $n(n).set(new $n(t)),n}var zn=/\w*$/,Kn=et?et.prototype:void 0,Xn=Kn?Kn.valueOf:void 0;function Jn(t,n){var i=n?Yn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var Qn=Object.create,Zn=function(){function t(){}return function(n){if(!ft(n))return{};if(Qn)return Qn(n);t.prototype=n;var i=new t;return t.prototype=void 0,i}}();function ti(t){return"function"!=typeof t.constructor||cn(t)?{}:Zn(Mn(t))}var ni=en&&en.isMap,ii=ni?Qt(ni):function(t){return Lt(t)&&"[object Map]"==Wn(t)},ei=en&&en.isSet,ri=ei?Qt(ei):function(t){return Lt(t)&&"[object Set]"==Wn(t)},ui={};function oi(t,n,i,e,r,u){var o,s=1&n,a=2&n,c=4&n;if(i&&(o=r?i(t,e,r,u):i(t)),void 0!==o)return o;if(!ft(t))return t;var h=qt(t);if(h){if(o=function(t){var n=t.length,i=new t.constructor(n);return n&&"string"==typeof t[0]&&Gn.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!s)return kn(t,o)}else{var f=Wn(t),l="[object Function]"==f||"[object GeneratorFunction]"==f;if(Yt(t))return En(t,s);if("[object Object]"==f||"[object Arguments]"==f||l&&!r){if(o=a||l?{}:ti(t),!s)return a?function(t,n){return Pt(t,jn(t),n)}(t,function(t,n){return t&&Pt(n,yn(n),t)}(o,t)):function(t,n){return Pt(t,Rn(t),n)}(t,function(t,n){return t&&Pt(n,pn(n),t)}(o,t))}else{if(!ui[f])return r?t:{};o=function(t,n,i){var e=t.constructor;switch(n){case"[object ArrayBuffer]":return Yn(t);case"[object Boolean]":case"[object Date]":return new e(+t);case"[object DataView]":return function(t,n){var i=n?Yn(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Jn(t,i);case"[object Map]":return new e;case"[object Number]":case"[object String]":return new e(t);case"[object RegExp]":return function(t){var n=new t.constructor(t.source,zn.exec(t));return n.lastIndex=t.lastIndex,n}(t);case"[object Set]":return new e;case"[object Symbol]":return function(t){return Xn?Object(Xn.call(t)):{}}(t)}}(t,f,s)}}u||(u=new Ct);var d=u.get(t);if(d)return d;u.set(t,o),ri(t)?t.forEach((function(e){o.add(oi(e,n,i,e,t,u))})):ii(t)&&t.forEach((function(e,r){o.set(r,oi(e,n,i,r,t,u))}));var v=c?a?xn:In:a?keysIn:pn,p=h?void 0:v(t);return function(t,n){for(var i=-1,e=null==t?0:t.length;++i<e&&!1!==n(t[i],i););}(p||t,(function(e,r){p&&(e=t[r=e]),Nt(o,r,oi(e,n,i,r,t,u))})),o}function si(t){return oi(t,5)}ui["[object Arguments]"]=ui["[object Array]"]=ui["[object ArrayBuffer]"]=ui["[object DataView]"]=ui["[object Boolean]"]=ui["[object Date]"]=ui["[object Float32Array]"]=ui["[object Float64Array]"]=ui["[object Int8Array]"]=ui["[object Int16Array]"]=ui["[object Int32Array]"]=ui["[object Map]"]=ui["[object Number]"]=ui["[object Object]"]=ui["[object RegExp]"]=ui["[object Set]"]=ui["[object String]"]=ui["[object Symbol]"]=ui["[object Uint8Array]"]=ui["[object Uint8ClampedArray]"]=ui["[object Uint16Array]"]=ui["[object Uint32Array]"]=!0,ui["[object Error]"]=ui["[object Function]"]=ui["[object WeakMap]"]=!1;var ai=e((function(t,n){t.exports=function(t){var n={};return(t=t||{}).prependOn=function(n,i){return t.on(n,i,!0)},t.eventNames=function(){return Object.keys(n)},t.on=function(i,e,r){for(var u=0,o=(i=[].concat(i)).length;u<o;u++){var s=i[u];if(!s)throw new Error("Tried to listen for an undefined event.");n[s]||(n[s]=[]),r?n[s].unshift(e):n[s].push(e)}return t},t.once=function(n,i,e){function r(){i.apply(t.off(n,r),arguments)}return r.handler=i,t.on(n,r,e)},t.off=function(i,e){if(!i)return n={},t;for(var r=0,u=(i=[].concat(i)).length;r<u;r++){var o=i[r];if(!o)throw new Error("Tried to remove an undefined event.");if(o in n)if(e){var s=n[o].indexOf(e);if(-1===s)for(var a=0,c=n[o].length;a<c;a++)if(n[o][a].handler===e){s=r;break}if(-1===s)return t;n[o].splice(s,1)}else delete n[o]}return t},t.fire=function(i){if(!i)throw new Error("Tried to fire an undefined event.");if(i in n)for(var e=n[i].slice(0),r=0,u=e.length;r<u;r++)if(e[r].apply(t,e.slice.call(arguments,1)),t.l){delete t.l;break}return t},t.halt=function(){return t.l=!0,t},t}}));function ci(t){return function(n){for(var i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.forEach((function(i){for(var e in i){var r=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,Object.assign(r,t))}})),n}}var hi=ci({enumerable:!1,configurable:!0,writeable:!1}),fi=ci({enumerable:!1,configurable:!1,writeable:!1}),li=ci({enumerable:!0,configurable:!0,writeable:!1}),di=e((function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.6+9869a4bc
 */
t.exports=function(){function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},e=0,r=void 0,u=void 0,o=function(t,n){d[e]=t,d[e+1]=n,2===(e+=2)&&(u?u(v):p())},s="undefined"!=typeof window?window:void 0,a=s||{},c=a.MutationObserver||a.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(v,1)}}var d=new Array(1e3);function v(){for(var t=0;t<e;t+=2)(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0;e=0}var p=void 0;function m(t,n){var i=this,e=new this.constructor(b);void 0===e[w]&&C(e);var r=i.m;if(r){var u=arguments[r-1];o((function(){return M(r,e,u,i.g)}))}else R(i,e,t,n);return e}function y(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var n=new this(b);return k(n,t),n}p=h?function(){return process.nextTick(v)}:c?function(){var t=0,n=new c(v),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}():f?function(){var t=new MessageChannel;return t.port1.onmessage=v,function(){return t.port2.postMessage(0)}}():void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(r=t.runOnLoop||t.runOnContext)?function(){r(v)}:l()}catch(t){return l()}}():l();var w=Math.random().toString(36).substring(2);function b(){}var g={error:null};function _(t){try{return t.then}catch(t){return g.error=t,g}}function E(n,i,e){i.constructor===n.constructor&&e===m&&i.constructor.resolve===y?function(t,n){1===n.m?S(t,n.g):2===n.m?A(t,n.g):R(n,void 0,(function(n){return k(t,n)}),(function(n){return A(t,n)}))}(n,i):e===g?(A(n,g.error),g.error=null):void 0===e?S(n,i):t(e)?function(t,n,i){o((function(t){var e=!1,r=function(i,r,u,o){try{i.call(r,(function(i){e||(e=!0,n!==i?k(t,i):S(t,i))}),(function(n){e||(e=!0,A(t,n))}))}catch(t){return t}}(i,n,0,0,t._);!e&&r&&(e=!0,A(t,r))}),t)}(n,i,e):S(n,i)}function k(t,n){t===n?A(t,new TypeError("You cannot resolve a promise with itself")):function(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}(n)?E(t,n,_(n)):S(t,n)}function T(t){t.k&&t.k(t.g),O(t)}function S(t,n){void 0===t.m&&(t.g=n,t.m=1,0!==t.T.length&&o(O,t))}function A(t,n){void 0===t.m&&(t.m=2,t.g=n,o(T,t))}function R(t,n,i,e){var r=t.T,u=r.length;t.k=null,r[u]=n,r[u+1]=i,r[u+2]=e,0===u&&t.m&&o(O,t)}function O(t){var n=t.T,i=t.m;if(0!==n.length){for(var e=void 0,r=void 0,u=t.g,o=0;o<n.length;o+=3)e=n[o],r=n[o+i],e?M(i,e,r,u):r(u);t.T.length=0}}function M(n,i,e,r){var u=t(e),o=void 0,s=void 0,a=void 0,c=void 0;if(u){if((o=function(t,n){try{return t(n)}catch(t){return g.error=t,g}}(e,r))===g?(c=!0,s=o.error,o.error=null):a=!0,i===o)return void A(i,new TypeError("A promises callback cannot return that same promise."))}else o=r,a=!0;void 0!==i.m||(u&&a?k(i,o):c?A(i,s):1===n?S(i,o):2===n&&A(i,o))}var j=0;function C(t){t[w]=j++,t.m=void 0,t.g=void 0,t.T=[]}var I=function(){function t(t,i){this.S=t,this.promise=new t(b),this.promise[w]||C(this.promise),n(i)?(this.length=i.length,this.A=i.length,this.g=new Array(this.length),0===this.length?S(this.promise,this.g):(this.length=this.length||0,this.R(i),0===this.A&&S(this.promise,this.g))):A(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype.R=function(t){for(var n=0;void 0===this.m&&n<t.length;n++)this.O(t[n],n)},t.prototype.O=function(t,n){var i=this.S,e=i.resolve;if(e===y){var r=_(t);if(r===m&&void 0!==t.m)this.M(t.m,n,t.g);else if("function"!=typeof r)this.A--,this.g[n]=t;else if(i===x){var u=new i(b);E(u,t,r),this.j(u,n)}else this.j(new i((function(n){return n(t)})),n)}else this.j(e(t),n)},t.prototype.M=function(t,n,i){var e=this.promise;void 0===e.m&&(this.A--,2===t?A(e,i):this.g[n]=i),0===this.A&&S(e,this.g)},t.prototype.j=function(t,n){var i=this;R(t,void 0,(function(t){return i.M(1,n,t)}),(function(t){return i.M(2,n,t)}))},t}(),x=function(){function n(t){this[w]=j++,this.g=this.m=void 0,this.T=[],b!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof n?function(t,n){try{n((function(n){k(t,n)}),(function(n){A(t,n)}))}catch(n){A(t,n)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.finally=function(n){var i=this.constructor;return t(n)?this.then((function(t){return i.resolve(n()).then((function(){return t}))}),(function(t){return i.resolve(n()).then((function(){throw t}))})):this.then(n,n)},n}();return x.prototype.then=m,x.all=function(t){return new I(this,t).promise},x.race=function(t){var i=this;return n(t)?new i((function(n,e){for(var r=t.length,u=0;u<r;u++)i.resolve(t[u]).then(n,e)})):new i((function(t,n){return n(new TypeError("You must pass an array to race."))}))},x.resolve=y,x.reject=function(t){var n=new this(b);return A(n,t),n},x.C=function(t){u=t},x.I=function(t){o=t},x.D=o,x.polyfill=function(){var t=void 0;if(void 0!==i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var e=null;try{e=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===e&&!n.cast)return}t.Promise=x},x.Promise=x,x}()})),vi=window.Promise||di;vi.allSettled||(vi.allSettled=function(t){return vi.all(t.map((function(t){return t.then((function(t){return{status:"fulfilled",value:t}})).catch((function(t){return{status:"rejected",reason:t}}))})))});var pi=function(t){return new vi((function(n,i){return setTimeout(n,t)}))},mi={defer:!0,async:!0};function yi(t,n){n=Object.assign(mi,n);var i=window.vpimport__=window.vpimport__||{cache:{}};if(i.cache[t])return i.cache[t].N;var e=new vi((function(e,r){var u=document.getElementsByTagName("head")[0],o=document.createElement("script");o.src=""+t,o.defer=n.defer,o.async=n.async,o.onreadystatechange=o.onload=function(){var n=Object.keys(i).filter((function(t){return"cache"!==t}))[0];i.cache[t].P=i[n],delete i[n],e(i.cache[t].P),u.removeChild(o)},o.onerror=function(n){r(n),delete i.cache[t],u.removeChild(o)},u.appendChild(o)}));return i.cache[t]={N:e},e}function wi(t){for(var n=function(t){return t&&"object"===x(t)},i=arguments.length,e=new Array(i>1?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];return e.reduce((function(t,i){return Object.keys(i||{}).forEach((function(e){var r=t[e],u=i[e];r&&void 0===u||(Array.isArray(u)?t[e]=(r||[]).concat(u):n(u)?t[e]=wi({},r,u):t[e]=u)})),t}),t)}function bi(){var t,n,i=new vi((function(i,e){t=i,n=e}));return i.resolve=t,i.reject=n,i}function gi(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t}function _i(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function Ei(t){return _i()-t}function ki(t){if("object"!==x(t))return"";var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n.length?n.join("&"):""}function Ti(t){return"string"!=typeof t?{}:t.replace("?","").split("&").reduce((function(t,n){if(n.length>0){var i=n.substring(0,n.indexOf("=")),e=n.substring(n.indexOf("=")+1);t[i]=decodeURIComponent(e)}return t}),{})}function Si(t,n){var i=ki(n),e=-1===t.indexOf("?")?"?":"&";return"".concat(t).concat(i?"".concat(e).concat(i):"")}var Ai={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(t){return t>=200&&t<300},retryStatus:function(t){return[408,413,429].includes(t)||t>=500&&t<600}};function Ri(t,n){var i=this;this.headers={},this.perfTimings={},wi(this,n),this.ok=2==(this.status/100|0),this.body=t,this.text=function(){return vi.resolve(t)},this.json=function(){return vi.resolve(JSON.parse(t))},this.blob=function(){return vi.resolve(new Blob([t]))},this.arrayBuffer=function(){return vi.resolve(t)},this.clone=function(){return new Ri(t,i)},this.isVimeoResponse=!0}var Oi=function(t){function n(){var n;return(n=t.call(this,"The operation was aborted.")||this).name="AbortError",n}return U(n,t),n}(W(Error)),Mi=function(t){function n(n){var i;return(i=t.call(this,n.statusText)||this).name="HTTPError",i.response=n,i}return U(n,t),n}(W(Error)),ji=function(t){function n(){var n;return(n=t.call(this,"A network error occurred.")||this).name="NetworkError",n}return U(n,t),n}(W(Error)),Ci=function(t){function n(n){var i;return(i=t.call(this,"Request timed out.")||this).name="TimeoutError",i.timeoutMs=n,i}return U(n,t),n}(W(Error));function Ii(){}function xi(t,n,i){if(!t.s){if(i instanceof Di){if(!i.s)return void(i.o=xi.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(xi.bind(null,t,n),xi.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var Di=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var u=1&r?n:i;if(u){try{xi(e,1,u(this.v))}catch(t){xi(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?xi(e,1,n?n(r):r):i?xi(e,1,i(r)):xi(e,2,r)}catch(t){xi(e,2,t)}},e},t}();function Ni(t){return t instanceof Di&&1&t.s}function Pi(t){var n=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}((function(e){return function(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}(e,(function(r){var u=!1;i++;var o=function(n){if(!t.retryAbortErrors&&n instanceof Oi)return 0;if(n instanceof Ci)return 0;if(i>=t.retry)return 0;if(n instanceof Mi){if(!t.retryStatus(n.response.status))return 0;var e=n.response.headers["retry-after"];if(e&&t.retryStatus(n.response.status)){var r=Number(e);return isNaN(r)?r=Date.parse(e)-Date.now():r*=1e3,r}if(413===n.response.status)return 0}return.3*Math.pow(2,i-1)*1e3}(r);return function(s,a){var c=function(){if(0!==o&&i>0)return function(t,n,i){return t&&t.then||(t=vi.resolve(t)),n?t.then(n):t}(pi(o),(function(){var o=t.hooks.beforeRetry||[];return function(t,n){return t&&t.then?t.then(n):n()}(function(t,n,i){var e,r,u=-1;return function i(o){try{for(;++u<t.length;)if((o=n(u))&&o.then){if(!Ni(o))return void o.then(i,r||(r=xi.bind(null,e=new Di,2)));o=o.v}e?xi(e,1,o):e=o}catch(t){xi(e||(e=new Di),2,t)}}(),e}(o,(function(n){return function(t,n){return t&&t.then?t.then(Ii):vi.resolve()}((0,o[n])(t,r,i))})),(function(){return u=!0,n(e)}))}))}();return c&&c.then?c.then(a):a(c)}(0,(function(n){if(u)return n;if(t.throwHttpErrors)throw r}))}))})),i=0;return n}function Li(t,n,i){return i?n?n(t):t:(t&&t.then||(t=vi.resolve(t)),n?t.then(n):t)}function Fi(t,n,i){if(!t.s){if(i instanceof Ui){if(!i.s)return void(i.o=Fi.bind(null,t,n));1&n&&(n=i.s),i=i.v}if(i&&i.then)return void i.then(Fi.bind(null,t,n),Fi.bind(null,t,2));t.s=n,t.v=i;var e=t.o;e&&e(t)}}var Ui=function(){function t(){}return t.prototype.then=function(n,i){var e=new t,r=this.s;if(r){var u=1&r?n:i;if(u){try{Fi(e,1,u(this.v))}catch(t){Fi(e,2,t)}return e}return this}return this.o=function(t){try{var r=t.v;1&t.s?Fi(e,1,n?n(r):r):i?Fi(e,1,i(r)):Fi(e,2,r)}catch(t){Fi(e,2,t)}},e},t}();function Hi(t){return t instanceof Ui&&1&t.s}function Bi(t,n,i){var e,r,u=-1;return function o(s){try{for(;++u<t.length&&(!i||!i());)if((s=n(u))&&s.then){if(!Hi(s))return void s.then(o,r||(r=Fi.bind(null,e=new Ui,2)));s=s.v}e?Fi(e,1,s):e=s}catch(t){Fi(e||(e=new Ui),2,t)}}(),e}function Vi(t,n){return t&&t.then?t.then(n):n(t)}function qi(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}var Wi={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},Gi=["get"];function $i(t,n){var i=qi((function(){var t=!1,i=!1,e=n.hooks.beforeRequest||[];return Vi(Bi(e,(function(r){return Li((0,e[r])(n),(function(e){return e instanceof Yi?(n=e,void(i=!0)):(null==e?void 0:e.isVimeoResponse)?(t=!0,vi.resolve(e).then(zi(n))):void 0}))}),(function(){return i||t})),(function(i){return t?i:function(t,n){var i=t.url,e=t.method,r=t.body,u=t.onDownloadProgress,o=100;return new vi((function(s,a){var c=n?new n:new XMLHttpRequest,h=window.performance;for(var f in c.open(e.toUpperCase(),i,t.async),t.timeout&&(c.timeout=t.timeout),c.onload=function(){if(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:")){var t={};c.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(n,i,e){t[i]=t[i]?"".concat(t[i],",").concat(e):e}));var n={};if(window.performance&&void 0!==window.performance.getEntriesByType){var i=window.performance.getEntriesByType("resource");if(i.length&&i.length>=o&&("function"==typeof h.clearResourceTimings&&h.clearResourceTimings(),"function"==typeof h.setResourceTimingBufferSize&&(h.setResourceTimingBufferSize(500),o=500)),i.length){var e=i.filter((function(t){return t.name===c.responseURL})).sort((function(t,n){return t.connectStart-n.connectStart}));e.length&&(n=e[e.length-1].toJSON())}}s(new Ri(c.response,{headers:t,statusText:c.statusText,status:c.status,url:c.responseURL,perfTimings:n}))}},c.onabort=function(){a(new Oi)},c.onerror=function(){a(new ji)},c.ontimeout=function(){a(new Ci(t.timeout))},"function"==typeof u&&c.addEventListener("progress",u),t.headers)c.setRequestHeader(f,t.headers[f]);t.withCredentials&&(c.withCredentials=!0),t.responseType&&(c.responseType=t.responseType),t.abort=c.abort.bind(c),c.send(r||null)}))}(n).then(zi(n))}))})),e=n=new Yi(t,n),r=e.method,u=e.json,o=e.jwt,s=e.searchParams;if(u&&(n.headers["Content-Type"]=Wi.json,n.body=JSON.stringify(u)),o&&(n.headers.Authorization="jwt ".concat(o)),s){var a=$(n.url.split("?"),2),c=a[0],h=a[1];n.url=Si(c,F(F({},Ti(h)),s))}var f=-1!==Gi.indexOf(r.toLowerCase())?Pi(n)(i):i(),l=function(t){f[t]=qi((function(){return n.headers["Content-Type"]=Wi[t],Li(f,(function(n){return n.clone()[t]()}))}))};for(var d in Wi)l(d);return function t(n,i){var e=n.then.bind(n);return Object.assign(n,{abort:i,then:function(){return t(e.apply(void 0,arguments),i)}})}(f,(function(){return n.abort()}))}function Yi(t,n){wi(this,Ai,t="string"==typeof t?{url:t}:t,n)}function zi(t){var n=t.validateStatus,i=t.throwHttpErrors,e=t.hooks;return qi((function(r){var u=e.afterResponse||[];return Vi(Bi(u,(function(n){return Li((0,u[n])(t,r.clone()),(function(t){t instanceof Ri&&(r=t)}))})),(function(){if(!n||n(r.status))return r;if(i)throw new Mi(r);return r}))}))}["get","post","put","patch","head","delete"].forEach((function(t){return $i[t]=function(n,i){return $i(n,F({method:t},i))},$i[t]}));function Ki(t,n,i){switch(i.length){case 0:return t.call(n);case 1:return t.call(n,i[0]);case 2:return t.call(n,i[0],i[1]);case 3:return t.call(n,i[0],i[1],i[2])}return t.apply(n,i)}function Xi(t){return t}var Ji=Math.max;function Qi(t){return function(){return t}}var Zi=It?function(t,n){return It(t,"toString",{configurable:!0,enumerable:!1,value:Qi(n),writable:!0})}:Xi,te=Date.now,ne=function(t){var n=0,i=0;return function(){var e=te(),r=16-(e-i);if(i=e,r>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(Zi);function ie(t,n){return ne(function(t,n,i){return n=Ji(void 0===n?t.length-1:n,0),function(){for(var e=arguments,r=-1,u=Ji(e.length-n,0),o=Array(u);++r<u;)o[r]=e[n+r];r=-1;for(var s=Array(n+1);++r<n;)s[r]=e[r];return s[n]=i(o),Ki(t,this,s)}}(t,n,Xi),t+"")}function ee(t,n,i){(void 0!==i&&!X(t[n],i)||void 0===i&&!(n in t))&&xt(t,n,i)}var re=function(t,n,i){for(var e=-1,r=Object(t),u=i(t),o=u.length;o--;){var s=u[++e];if(!1===n(r[s],s,r))break}return t},ue=Function.prototype,oe=Object.prototype,se=ue.toString,ae=oe.hasOwnProperty,ce=se.call(Object);function he(t,n){if(("constructor"!==n||"function"!=typeof t[n])&&"__proto__"!=n)return t[n]}function fe(t,n,i,e,r){t!==n&&re(n,(function(u,o){if(r||(r=new Ct),ft(u))!function(t,n,i,e,r,u,o){var s=he(t,i),a=he(n,i),c=o.get(a);if(c)ee(t,i,c);else{var h=u?u(s,a,i+"",t,n,o):void 0,f=void 0===h;if(f){var l=qt(a),d=!l&&Yt(a),v=!l&&!d&&un(a);h=a,l||d||v?qt(s)?h=s:function(t){return Lt(t)&&vn(t)}(s)?h=kn(s):d?(f=!1,h=En(a,!0)):v?(f=!1,h=Jn(a,!0)):h=[]:function(t){if(!Lt(t)||"[object Object]"!=ht(t))return!1;var n=Mn(t);if(null===n)return!0;var i=ae.call(n,"constructor")&&n.constructor;return"function"==typeof i&&i instanceof i&&se.call(i)==ce}(a)||Vt(a)?(h=s,Vt(s)?h=function(t){return Pt(t,yn(t))}(s):ft(s)&&!lt(s)||(h=ti(a))):f=!1}f&&(o.set(a,h),r(h,a,e,u,o),o.delete(a)),ee(t,i,h)}}(t,n,o,i,fe,e,r);else{var s=e?e(he(t,o),u,o+"",t,n,r):void 0;void 0===s&&(s=u),ee(t,o,s)}}),yn)}function le(t,n,i,e,r,u){return ft(t)&&ft(n)&&(u.set(n,t),fe(t,n,void 0,le,u),u.delete(n)),t}function de(t){return ie((function(n,i){var e=-1,r=i.length,u=r>1?i[r-1]:void 0,o=r>2?i[2]:void 0;for(u=t.length>3&&"function"==typeof u?(r--,u):void 0,o&&function(t,n,i){if(!ft(i))return!1;var e=x(n);return!!("number"==e?vn(i)&&Kt(n,i.length):"string"==e&&n in i)&&X(i[n],t)}(i[0],i[1],o)&&(u=r<3?void 0:u,r=1),n=Object(n);++e<r;){var s=i[e];s&&t(n,s,e,u)}return n}))}var ve=de((function(t,n,i,e){fe(t,n,i,e)})),pe=ie((function(t){return t.push(void 0,le),Ki(ve,void 0,t)})),me=function(){function t(t){this.L=!1,this.F=!1,this.U=t,ai(this)}N(t,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]);var n=t.prototype;return n.showPicker=function(){},n.getFile=function(){var t=this.constructor.displayName.replace("ExternalDisplay","");if(this.U.externalDisplayFiles[t])return this.U.externalDisplayFiles[t];var n=this.constructor.supportedVideoTypes,i=this.U.files.filter((function(t){return-1!==n.indexOf(t.mime)})).sort((function(t,i){return t.mime===i.mime?t.priority-i.priority:n.indexOf(t.mime)-n.indexOf(i.mime)}));if(!i.length)throw new Error("No files available for ".concat(this.constructor.displayName," external display."));return i[0]},N(t,[{key:"active",get:function(){return this.F}},{key:"available",get:function(){return this.L}},{key:"element",get:function(){return document.createElement("div")}}]),t}(),ye={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},we={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},be={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},ge={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",DRM_KEY_SWITCH:"drmkeyswitch",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_UPDATED:"streamupdated",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend",DROPPED_FRAME_PERCENT_EXCEEDED:"droppedframepercentexceeded"},_e={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent",STALL_JUMP:"livestalljump"},Ee={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable",AMBISONIC_UNSUPPORTED:"ambisonicunsupported"},ke={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Te={BRAIN_ML_MODEL_ERR:"brainmlmodelerr",BRAIN_ML_MODEL_NET_ERR:"brainmlmodelresperr",BRAIN_ML_MODEL_TIMEOUT:"brainmlmodeltimeout",BRAIN_ML_SWITCH_TO_SKYFIRE:"brainmlmodelswitchtoskyfire",BRAIN_ML_MODEL_INPUTS:"brainmlmodelinputs"},Se=Object.assign({},ye,we,be,ge,Ee,_e,ke,Te),AirPlayExternalDisplay=function(t){function AirPlayExternalDisplay(n){var i;return(i=t.call(this,n)||this).H=document.createElement("video"),i.H.setAttribute("data-airplay",""),i.H.setAttribute("x-webkit-airplay","allow"),i.addVideoEventListeners(),i}U(AirPlayExternalDisplay,t),N(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]);var n=AirPlayExternalDisplay.prototype;return n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.H;n.addEventListener(ye.LOADED_METADATA,(function(n){t.fire(ye.LOADED_METADATA,n)})),n.addEventListener("webkitplaybacktargetavailabilitychanged",(function(n){switch(n.availability){case"available":t.L||(t.L=!0,t.fire(be.AIRPLAY_AVAILABLE));break;case"not-available":t.L&&(t.L=!1,t.fire(be.AIRPLAY_UNAVAILABLE))}})),n.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",(function(n){if(n.target.webkitCurrentPlaybackTargetIsWireless)return t.F=!0,void t.fire(be.AIRPLAY_ACTIVATED);t.F=!1,t.fire(be.AIRPLAY_DEACTIVATED)}))},n.showPicker=function(){var t=this;this.H.webkitShowPlaybackTargetPicker(),this.loadMetadata().then((function(){return t.H.webkitShowPlaybackTargetPicker()})).catch((function(){}))},n.loadMetadata=function(){var t=this;return this.H.readyState>=1?vi.resolve():new vi((function(n,i){t.H.addEventListener(ye.LOADED_METADATA,(function(){n()})),t.H.src=t.getFile().src}))},N(AirPlayExternalDisplay,[{key:"element",get:function(){return this.H},set:function(t){if(!(t instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");t!==this.H&&(this.addVideoEventListeners(t),this.H=t,this.H.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}(me),Ae=window.WeakMap||function(){var t=Object.defineProperty,n=Date.now()%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+n+++"__"};return i.prototype.set=function(n,i){if("object"!==x(n)&&"function"!=typeof n)throw new TypeError("Invalid value used as weak map key");var e=n[this.name];return e&&e[0]===n?e[1]=i:t(n,this.name,{value:[n,i],writable:!0}),this},i.prototype.get=function(t){var n;return(n=t[this.name])&&n[0]===t?n[1]:void 0},i.prototype.delete=function(t){var n=t[this.name];return!(!n||n[0]!==t||(n[0]=n[1]=void 0,0))},i.prototype.has=function(t){var n=t[this.name];return!!n&&n[0]===t},i}(),Re=window.Array.from,Oe=[1];"function"==typeof Re&&Re(Oe)===Oe&&(Re=!1);var Me=Re||function(t){return[].slice.call(t,0)},je=navigator.userAgent.toLowerCase();const Ce=["googlebot","google-inspectiontool"];function Ie(t){t=t.toLowerCase();var n=new RegExp(t).test(je);return"safari"===t?n&&new RegExp("version").test(je):n}function xe(t){var n=document.createElement("div"),i=t.charAt(0).toUpperCase()+t.slice(1),e=(t+" "+["Webkit","Moz","O","ms"].join(i+" ")+i).split(" ");for(var r in e){var u=e[r];if(void 0!==n.style[u])return u}return t}var De=!!Ie("android")&&(parseFloat(je.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Ne=window.devicePixelRatio||1,Pe=!(!Ie("windows phone")&&!Ie("iemobile"))&&(parseFloat(je.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Le=!!Ie("msie")&&parseFloat(je.replace(/^.*msie (\d+).*$/,"$1")),Fe=!!Ie("trident")&&parseFloat(je.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,Ue=Ie("ipad;")||Ie("iphone;")||Ie("ipod touch;")?parseFloat(je.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")):navigator.userAgent.includes("Mac")&&"ontouchend"in document,He="MacIntel"===navigator.platform&&void 0!==navigator.standalone,Be=Ie("opera")||Ie("opr"),Ve=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(je);function qe(){if(!Ie("safari"))return[];var t=je.split(" ").find((function(t){return/version\//.test(t)}));return t?t.replace("version/","").split(".").map((function(t){return parseInt(t,10)})):[]}var We=Ie("safari")&&Ie("apple")&&!Ie("chrome")&&!Ie("android")&&qe()[0]>=11,Ge={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:De,appleMail:Ve,hasAutoplayPolicy:De||Ue||We||function(){if(!Ie("chrome"))return[];var t=je.split(" ").find((function(t){return Ue?/CriOS\//.test(t):/chrome\//.test(t)}));return t?t.replace("chrome/","").split(".").map((function(t){return parseInt(t,10)})):[]}()[0]>=66,iOS:Ue,iPadOS:He,mobileAndroid:De&&Ie("mobile"),browser:{bb10:Ie("bb10"),chrome:Ie("chrome"),firefox:Ie("firefox"),ie:Le||Fe,edge:Ie("edge"),opera:Be,safari:Ie("safari")&&Ie("apple")&&!Ie("chrome")&&!Ie("android")},devicePixelRatio:Ne,iPhone:Ie("iphone;")||Ie("ipod touch;")||Ie("ipod;"),iPad:Ie("ipad;"),iPadNonRetina:Ie("ipad;")&&Ne<2,mac:Ie("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}catch(t){}return t}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Ie("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:xe("transform"),transitionProperty:xe("transition"),webp:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:Pe,isGoogleBot:(()=>{const t=je.toLowerCase();return Ce.some(n=>t.includes(n))})(),storageAccessAPI:"requestStorageAccess"in document&&"hasStorageAccess"in document},$e=/mac os x 10_13/.test(je),Ye=Ge.iOS&&Ge.iOS>=11,ze="undefined"!=typeof matchMedia&&(matchMedia("(color-gamut: p3)").matches&&screen.pixelDepth>24||matchMedia("(dynamic-range: high), (video-dynamic-range: high)").matches);function Ke(t="hvc1"){return"undefined"!=typeof MediaSource?MediaSource.isTypeSupported(`video/mp4; codecs="${t}"`):We&&($e||Ye)}function Xe(){return!(Ge.iOS||Ge.iPad||Ge.browser.ie)&&(!Ie("safari")||qe()[0]>11||11===qe()[0]&&(qe()[2]>1||qe()[1]>0))}Ge.hevc=Ke(),Ge.hevcMain10=Ke("hvc1.2.4.H150.90"),Ge.hdr=ze,Ge.dolbyVision=function(){var t="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="dvh1"');if(!t){var n=document.createElement("video");"canPlayType"in n&&(t="probably"===n.canPlayType('video/mp4; codecs="dvh1"'))}if(He||Ge.iOS){var i=qe(),e=i[0],r=i[1];if(e<14||14===e&&r<1)return!1}return t}(),Ge.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),Ge.av1="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),Ge.webvr=!(!window.navigator||!("getVRDisplays"in window.navigator)),Ge.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),Ge.spatialPlayback=Xe(),Ge.spatialHEVC=!Ge.browser.safari&&Xe()&&Ke(),Ge.stereoscopic=Ge.spatialPlayback&&Ge.mobileAndroid;var Je=function(){var t=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}();function Qe(t,n){var i,e=0;return P(i={},C.iterator,(function(){return this})),P(i,"next",(function(){return e<t.length?{done:!1,value:n?[t[e],n[e++]]:t[e++]}:{done:!0}})),i}var Ze=function(t){for(var n=0,i=this.length;n<i;n++)if(this[n].id==="".concat(t))return this[n];return null};function tr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.item=function(t){return this[t]},t.getTrackById=Ze,t}function nr(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function ir(t){return nr()-t}function er(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^(16*Math.random()>>t)/4).toString(16)}))}function rr(t){for(var n=window.atob(t),i=n.length,e=new Uint8Array(i),r=0;r<i;r++)e[r]=n.charCodeAt(r);return e}function ur(t){return rr(t).buffer}function or(t,n,i,e){var r=0,u=0,o=t,s=n,a=i/e;return o/s>=a?(u=s,r=(a*s).toFixed(2)):(r=o,u=(o/a).toFixed(2)),{width:r,height:u,left:Math.max((o-r)/2,0),top:Math.max((s-u)/2,0)}}function sr(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}function ar(t,n){var i=t;return n&&(i+=';codecs="'.concat(n,'"')),i}function cr(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t=parseFloat(t),isNaN(t))return 0;var i=Math.pow(10,n);return Math.round(t*i)/i}function hr(t,n){return t&&t.tests&&t.tests[n]?t.tests[n]:null}function fr(t){return t&&"ML"===t.displayName}var TelecineError=function(t,n){this.name=t,this.message=n,Object.freeze(this)},lr=new Ae,dr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=parseFloat(t);if(isNaN(i))throw new TypeError("Time must be a number.");if(i<0)throw new TypeError("Time must be a positive number.");this.time=t,this.data=n,this.id=er();try{var e="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new e(t,t+.25,JSON.stringify(n)),this.vttCue.id=this.id}catch(t){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}lr.set(this.vttCue,this),Object.freeze(this)}return t.fromVTTCue=function(n){if(lr.has(n))return lr.get(n);var i={};try{i=JSON.parse(n.text)}catch(t){}return new t(n.startTime,i)},t}();function vr(t,n,i){var e;try{document.removeChild({})}catch(r){e=Object.create(Object.getPrototypeOf(r),{name:{value:n,configurable:!0,writable:!0},code:{value:t,configurable:!0,writable:!0},message:{value:i,configurable:!0,writable:!0},toString:{value:function(){return"".concat(n,": DOM Exception ").concat(t)},configurable:!0,writable:!0}})}return Object.freeze(e)}var pr=function(t,n){if(!t||void 0===t[n])throw vr(1,"INDEX_SIZE_ERR");return t[n]};function mr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(P({get length(){return t.length},start:function(n){return pr(t,n)},end:function(t){return pr(n,t)}},C.iterator,(function(){return Qe(t,n)})))}mr.from=function(t){if(!(t instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var n=[],i=[],e=0,r=t.length;e<r;e++)n.push(t.start(e)),i.push(t.end(e));return mr(n,i)};function yr(){}var wr=document.createElement("video"),br={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},gr=function(){var t="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in t?t.DISABLED:"disabled",hidden:"HIDDEN"in t?t.HIDDEN:"hidden",showing:"SHOWING"in t?t.SHOWING:"showing"}}(),_r=function(){var t=document.createElement("track");return"track"in t&&"oncuechange"in t.track}(),Er=new Ae,kr=function(){function t(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.B=t,this.V=i,this.q=null,this.W=null,this.G=[],ai(this),this.on(ye.LOADED_METADATA,(function(){return n.$()})),this.on(ye.PLAY,(function(){return n.Y()}));var e=t.querySelector("video");e||((e=document.createElement("video")).preload="none",this.B.appendChild(e)),e.setAttribute("tabindex","-1"),this.U=e,i.playRequest&&(this.K=i.playRequest,this.K.video=e),i.htmlScanner&&i.htmlScanner.controls&&(this.U.controls=!0),this.X=this.handleVideoEvent.bind(this),this.addVideoEventListeners(),this.J="none",this.Z=!1,this.tt=!1,this.nt=-1,this.it=!1}N(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return t.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof wr.canPlayType)return t;for(var n in br){var i=br[n];Ge.android&&"application/vnd.apple.mpegurl"===n||(Ge.android&&!Ge.mobileAndroid&&"video/mp4"===n&&Ge.android instanceof String?parseInt(Ge.android.split(".")[0],10)>3&&t.push(n):wr.canPlayType(i).replace(/^no$/,"")&&t.push(n))}return t}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(Ge.android||Ge.iOS||Ge.iPadOS)return!1;var t=wr.volume;return wr.volume=.5*t,wr.volume!==t}},{key:"supportsTextTracks",get:function(){return void 0!==wr.textTracks&&wr.textTracks instanceof TextTrackList}},{key:"supportsPlaybackRate",get:function(){if(Ge.android&&Je&&Je.major<52)return!1;var t=wr.playbackRate;wr.playbackRate=.5*t;var n=t!==wr.playbackRate;return wr.playbackRate=t,n}}]);var n=t.prototype;return n.deactivate=function(){this.q&&(this.q.off("filesrcupdate"),this.q.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.it||this.removeSnapshot(),this.U.style.display="none"},n.reactivate=function(){this.addVideoEventListeners(),this.U.style.display=""},n.addVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.U;Object.keys(ye).forEach((function(i){var e=ye[i];n.addEventListener(e,t.X)}))},n.removeVideoEventListeners=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.U;Object.keys(ye).forEach((function(i){var e=ye[i];n.removeEventListener(e,t.X)}))},n.play=function(t){var n=this;return this.K.start(t).catch((function(t){throw n.et(t),t}))},n.et=function(t){this.fire(ye.ERROR,new TelecineError(null==t?void 0:t.name,null==t?void 0:t.message))},n.pause=function(){this.K.cancel(),this.U.pause()},n.onpause=function(){},n.ontimeupdate=function(){this.nt=this.currentTime},n.addTextTrack=function(t){var n,i,e=this;t.src?((n=document.createElement("track")).kind=t.kind,n.src=t.src,n.id="telecine-track-".concat(t.id),n.srclang=t.language,n.label=t.label,this.U.appendChild(n),i=n.track):(i=this.U.addTextTrack(t.kind,t.label,t.language),this.rt=this.rt||{},this.rt["telecine-track-".concat(t.id)]=i),i.addEventListener("cuechange",(function(){return t.dispatchEvent("cuechange")})),this.U.addEventListener("timeupdate",(function(){sr(e.U)&&(t.mode=i.mode)}));var r=function(){var n=Ge.iOS&&sr(e.U);!t.ut||n?t.mode=i.mode:i.mode=gr[t.mode]},u=[];if(n?n.addEventListener("load",r):r(),["loadeddata","seeking"].forEach((function(t){e.U.addEventListener(t,r),u.push([t,r])})),t.ut&&(i.mode=gr[t.mode]),!_r){var o=[],s=function(){if(i&&"disabled"!==gr[i.mode]){if(o.length!==i.activeCues.length)return t.dispatchEvent("cuechange"),void(o=Me(i.activeCues));for(var n=0,e=i.activeCues.length;n<e;n++)if(i.activeCues[n].startTime!==o[n].startTime)return t.dispatchEvent("cuechange"),void(o=Me(i.activeCues))}};this.U.addEventListener("timeupdate",s),u.push(["timeupdate",s])}return Er.set(t,u),i},n.removeTextTrack=function(t){var n=this,i=this.U.querySelector("#telecine-track-".concat(t.id));i&&this.U.removeChild(i);var e=Er.get(t);Array.isArray(e)&&e.forEach((function(t){var i=$(t,2),e=i[0],r=i[1];n.U.removeEventListener(e,r)}))},n.getCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n?Me(n.cues):[]},n.getActiveCuesForTrack=function(t){var n=this.getTrackById("telecine-track-".concat(t.id));return n&&n.activeCues?Me(n.activeCues):[]},n.setModeForTrack=function(t,n){var i=this.getTrackById("telecine-track-".concat(t.id));return i&&i.mode!==gr[n]&&(i.mode=gr[n],_r||"disabled"===n||t.dispatchEvent("cuechange")),this},n.setSrcForTrack=function(t,n){var i=this.U.querySelector("#telecine-track-".concat(t.id));return i&&null===i.track.cues&&(i.src=n),this},n.ot=function(t,n){var i,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.st||(this.st=this.U.addTextTrack("chapters"),this.st.mode="hidden");var r=t.timecode,u=e?e.timecode:n,o=window.VTTCue||window.TextTrackCue;try{i=new o(r,u,t.title)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}i.size=(u-r)/n,i.id=r,this.st.addCue(i)},n.addChapter=function(t,n){var i=this.video.chapters,e={timecode:t,title:n};i.push(e),i.sort((function(t,n){return t.timecode-n.timecode}));var r=i[i.indexOf(e)+1];this.ot(e,this.video.duration,r),this.ct(this.st,this.video.duration)},n.removeChapter=function(t){try{this.st.removeCue(t)}catch(t){throw new TelecineError("ChaptersNotSupported","Chapters are not supported in this browser.")}var n=this.video.chapters.find((function(n){return n.timecode===t.timecode}));this.video.chapters.splice(n,1),this.ct(this.st,this.video.duration)},n.ct=function(t,n){for(var i=0;i<t.cues.length;i++){var e=t.cues[i],r=t.cues[i+1],u=r?r.startTime:n;e.endTime=u,e.size=(u-e.startTime)/n}this.fire(ge.CHAPTER_CUES_UPDATED)},n.addChapters=function(t,n){var i=this;0!==t.length&&n&&(t=t.filter((function(t){return i.ht(t,n)}))).sort((function(t,n){return t.timecode-n.timecode})).forEach((function(e,r){return i.ot(e,n,t[r+1])}))},n.addCuePoint=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.ft||(this.ft=this.U.addTextTrack("metadata"),this.ft.mode="hidden",this.ft.addEventListener("cuechange",(function(t){Me(t.target.activeCues).forEach((function(t){n.fire(ge.CUE_POINT,dr.fromVTTCue(t))}))})),this.U.addEventListener("canplay",(function(t){n.ft.mode="hidden"}))),t=parseFloat(t),isNaN(t))throw new TypeError("Time must be a number.");if(t<0||t>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");var e=new dr(t,i);return this.ft.addCue(e.vttCue),e},n.removeCuePoint=function(t){if(!t)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this.ft.removeCue(t.vttCue),!0},n.removeAllCuePoints=function(){var t=this;return this.ft&&this.ft.length&&Me(this.ft.cues).forEach((function(n){t.ft.removeCue(n)})),!0},n.requestPictureInPicture=function(){try{var t=this;return function(n,i){var e=function(){if(t.U.readyState<1)return function(t,n){return t&&t.then?t.then(yr):vi.resolve()}(t.lt())}();return e&&e.then?e.then(i):i()}(0,(function(){switch(t.pictureInPictureSupportType){case"pip-api":return t.U.requestPictureInPicture();case"webkit-presentation-mode":return t.U.webkitSetPresentationMode("picture-in-picture");default:throw new Error("Picture-in-picture is not supported by this browser")}}))}catch(t){return vi.reject(t)}},n.lt=function(){var t=this;return this.preload="auto",new vi((function(n){t.once(ye.LOADED_METADATA,n)}))},n.exitPictureInPicture=function(){try{switch(this.pictureInPictureSupportType){case"pip-api":return document.exitPictureInPicture();case"webkit-presentation-mode":return this.U.webkitSetPresentationMode("inline");default:throw new Error("Picture-in-picture is not supported by this browser")}}catch(t){return vi.reject(t)}},n.onerror=function(){if(!this.U.error)return!1;switch(this.U.error.code){case this.U.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.dt("MediaSrcNotSupportedError","The media was not suitable."),this.vt(),!1;case this.U.error.MEDIA_ERR_DECODE:return-1!==this.nt&&Ge.iOS?(this.U.load(),this.currentTime=this.nt,this.nt=-1,!1):(this.dt("MediaDecodeError","The media could not be decoded."),this.vt(),!1);case this.U.error.MEDIA_ERR_NETWORK:return this.dt("MediaNetworkError","A network error ocurred while fetching the media."),!1;case this.U.error.MEDIA_ERR_ABORTED:return this.dt("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this.dt("MediaUnknownError","An unknown error occurred."),!1}},n.dt=function(t,n){this.fire(ye.ERROR,new TelecineError(t,n))},n.onended=function(){if(this.U.paused||this.U.pause(),this.currentTime<this.U.duration)return!1},n.onwaiting=function(){return!1},n.onwebkitbeginfullscreen=function(){this.tt=!0},n.onwebkitendfullscreen=function(){this.tt=!1},n.onwebkitpresentationmodechanged=function(){this.fire(this.pictureInPictureActive?ye.ENTER_PICTURE_IN_PICTURE:ye.LEAVE_PICTURE_IN_PICTURE)},n.shouldHandleVideoEvent=function(t){return!0},n.handleVideoEvent=function(t){t.target===this.U&&!1!==this.shouldHandleVideoEvent(t)&&("function"==typeof this["on".concat(t.type)]&&!1===this["on".concat(t.type)](t)||this.fire(t.type))},n.swapVideo=function(t,n){var i=t.paused;this.removeVideoEventListeners(t),t.parentElement.replaceChild(n,t),t.pause(),n.currentTime=t.currentTime,i||n.play(),this.addVideoEventListeners(n),this.U=n},n.onexternaldisplayactivated=function(t){this.Z||(this.U!==t.element&&(this.pt=this.U,this.swapVideo(this.U,t.element)),this.Z=!0)},n.onexternaldisplaydeactivated=function(t){this.Z&&(this.pt&&(this.swapVideo(t.element,this.pt),this.pt=null),this.Z=!1)},n.setVideoSrc=function(t){this.U.src=t},n.canSeekTo=function(t){var n=this.duration;if(n&&t>n&&(t=n),this.U.seekable.length>0)for(var i=0,e=this.U.seekable.length;i<e;i++)if(this.U.seekable.start(i)<=t&&this.U.seekable.end(i)>=t)return!0;return!1},n.seekToTime=function(t){var n=this;return this.canSeekTo(t)?(this.U.currentTime=t,vi.resolve(this.U.currentTime)):new vi((function(i,e){var r=function e(){n.canSeekTo(t)&&(Object.keys(ye).forEach((function(t){var i=ye[t];n.U.removeEventListener(i,e)})),n.U.currentTime=t,i(n.U.currentTime))};Object.keys(ye).forEach((function(t){var i=ye[t];n.U.addEventListener(i,r)}))}))},n.takeSnapshot=function(){var t=this.B.querySelector("[telecine-snapshot]");t||((t=document.createElement("canvas")).setAttribute("telecine-snapshot",""),this.B.appendChild(t)),t.setAttribute("width","".concat(this.B.clientWidth,"px")),t.setAttribute("height","".concat(this.B.clientHeight,"px")),t.style.display="";var n=or(this.U.clientWidth,this.U.clientHeight,this.U.videoWidth,this.U.videoHeight),i=n.width,e=n.height,r=n.left,u=n.top;t.style.cssText="position:absolute;width:".concat(i,"px;height:").concat(e,"px;left:").concat(r,"px;top:").concat(u,"px");var o=t.getContext("2d");t.width>0&&t.height>0&&o.drawImage(this.U,0,0,t.width,t.height)},n.removeSnapshot=function(){var t=this.B.querySelector("[telecine-snapshot]");t&&(t.style.display="none")},n.getTrackById=function(t){if(this.rt&&this.rt[t])return this.rt[t];if("function"==typeof this.U.textTracks.getTrackById)return this.U.textTracks.getTrackById(t);var n=document.getElementById(t);return n?n.track:null},n.initDrm=function(){var t=this.q.drmHandler;t&&t.init(this)},n.showExternalDisplayPicker=function(t){if(!this.G.length)throw new TelecineError("ExternalDisplayUnvailable","No external displays are available.");if(t){var n=this.G.filter((function(n){return n.constructor.displayName.replace("ExternalDisplay","")===t}))[0];if(!n)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");n.showPicker()}else this.G[0].showPicker()},n.yt=function(){return this.wt.length<1?null:this.wt.slice(0).sort((function(t,n){return t.priority-n.priority}))[0]},n.bt=function(){var t=this.yt();t?this.currentFile=t:this.fire(ge.SCANNER_ERROR,{reason:"all files failed"})},n.ht=function(t,n){return void 0!==t.timecode&&t.timecode>=0&&t.timecode<=n&&void 0!==t.title},n.vt=function(){var t=this.wt.indexOf(this.W);this.wt.splice(t,1),this.bt()},n.Y=function(){if("mediaSession"in navigator){var t={title:this.q.title,artist:this.q.subtitle,artwork:[]};this.q.metadata.thumbnail&&t.artwork.push({src:this.q.metadata.thumbnail}),navigator.mediaSession.metadata=new MediaMetadata(t)}},n.$=function(){var t,n=this;"function"==typeof(null==(t=navigator.mediaSession)?void 0:t.setActionHandler)&&(navigator.mediaSession.setActionHandler("play",(function(){n.play().then((function(){return n.fire(ke.MEDIASESSION_PLAY)})).catch(n.et.bind(n))})),navigator.mediaSession.setActionHandler("pause",(function(){n.pause(),n.fire(ke.MEDIASESSION_PAUSE)})),navigator.mediaSession.setActionHandler("seekforward",(function(){n.currentTime=Math.min(n.duration,n.currentTime+10),n.fire(ke.MEDIASESSION_SEEK_FORWARD)})),navigator.mediaSession.setActionHandler("seekbackward",(function(){n.currentTime=Math.max(0,n.currentTime-10),n.fire(ke.MEDIASESSION_SEEK_BACKWARD)})))},N(t,[{key:"chaptersTrack",get:function(){return this.st}},{key:"manifest",get:function(){return this.gt}},{key:"buffered",get:function(){return mr.from(this.U.buffered)}},{key:"cuePoints",get:function(){var t,n;return(null==(t=this.ft)?void 0:t.cues)&&"function"==typeof(null==(n=this.ft)?void 0:n.cues[C.iterator])?Me(this.ft.cues).map((function(t){return dr.fromVTTCue(t)})):[]}},{key:"currentFile",get:function(){return this.W},set:function(n){var i=this,e=!this.U.paused,r=this.currentTime,u=!this.W||n.video.id!==this.W.video.id;if(u||this.takeSnapshot(),this.W=n,u&&(this.U.preload=this.J),this.constructor===t&&this.U.readyState>0&&(this.U.currentTime=0),(Ge.iOS||Ge.android)&&this.W.video.title){var o=this.W.video.title;this.W.video.subtitle&&(o="".concat(o," ").concat(this.W.video.subtitle)),this.U.setAttribute("title",o)}else this.U.removeAttribute("title");this.setVideoSrc(this.W.src,u),this.fire(ge.CURRENT_FILE_CHANGE,n),Ge.iOS&&!u&&this.play().catch(this.et.bind(this)),this.constructor!==t||u?e&&this.play().catch(this.et.bind(this)):(this.seekToTime(r).then((function(t){return e&&i.play().catch(i.et.bind(i)),t})).catch((function(){})),this.once("canplay",(function(){return i.removeSnapshot()})),this.once("playing",(function(){return i.removeSnapshot()})))}},{key:"currentTime",get:function(){return this.U.currentTime},set:function(t){this.seekToTime(t)}},{key:"duration",get:function(){return this.U.duration}},{key:"ended",get:function(){return this.U.ended}},{key:"externalDisplayAvailable",get:function(){return this.G.some((function(t){return t.available}))}},{key:"externalDisplayActive",get:function(){return this.G.some((function(t){return t.active}))}},{key:"loop",get:function(){return this.U.loop},set:function(t){this.U.loop=t}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return this.U.muted},set:function(t){this.U.muted=t}},{key:"playsinline",get:function(){return this.U.playsinline},set:function(t){this.U.playsinline=t,t?this.U.setAttribute("playsinline",""):this.U.removeAttribute("playsinline")}},{key:"paused",get:function(){return this.U.paused}},{key:"defaultPlaybackRate",get:function(){return this.U.defaultPlaybackRate},set:function(t){this.U.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.U.playbackRate},set:function(t){this.U.playbackRate=t}},{key:"played",get:function(){return this.U.played}},{key:"seekable",get:function(){return this.U.seekable}},{key:"seeking",get:function(){return this.U.seeking}},{key:"preload",get:function(){return this.J},set:function(t){this.U.preload=t,this.J=t}},{key:"autoPictureInPicture",get:function(){return this.U.autoPictureInPicture},set:function(t){this.U.autoPictureInPicture=t}},{key:"disablePictureInPicture",get:function(){return this.U.disablePictureInPicture},set:function(t){this.U.disablePictureInPicture=t}},{key:"pictureInPictureActive",get:function(){return"picture-in-picture"===this.U.webkitPresentationMode||!!document.pictureInPictureElement}},{key:"pictureInPictureEnabled",get:function(){if(this.disablePictureInPicture)return!1;switch(this.pictureInPictureSupportType){case"pip-api":return document.pictureInPictureEnabled;case"webkit-presentation-mode":return!0;default:return!1}}},{key:"pictureInPictureSupportType",get:function(){return"pictureInPictureEnabled"in document?"pip-api":!("function"!=typeof this.U.webkitSetPresentationMode||!this.U.webkitSupportsPresentationMode("picture-in-picture"))&&"webkit-presentation-mode"}},{key:"video",get:function(){return this.q},set:function(t){var n=this;if(this.reactivate(),this.q!==t){if(this.q&&(this.q.off("filesrcupdate"),this.q.off("texttracksrcupdate")),this.removeAllCuePoints(),this.q=t,this.wt=t.files.filter((function(t){return-1!==n.constructor.supportedVideoTypes.indexOf(t.mime)})),this.q.on("filesrcupdate",(function(t){t===n.W&&n.bt()})),this.q.on("texttracksrcupdate",(function(t){n.video.currentScanner&&n.video.currentScanner.setSrcForTrack(t,t.src)})),this.V.externalDisplays&&this.V.externalDisplays.length){this.G=[];var i=this.constructor.supportedExternalDisplays;Array.isArray(i)||(i=[]);var e=i.map((function(t){return t.displayName}));this.V.externalDisplays.filter((function(t){return t.supported&&-1!==e.indexOf(t.displayName)})).forEach((function(i){var e=new i(t),r=i.displayName.replace("ExternalDisplay","");e.on(ye.LOADED_METADATA,(function(t){return n.fire(ye.LOADED_METADATA,t)})),e.on("available",(function(){return n.fire(we.AVAILABLE,{type:r})})),e.on("unavailable",(function(){return n.fire(we.UNAVAILABLE,{type:r})})),e.on("activated",(function(){"function"==typeof n.onexternaldisplayactivated&&n.onexternaldisplayactivated(e),n.fire(we.ACTIVATED,{type:r})})),e.on("deactivated",(function(){"function"==typeof n.onexternaldisplaydeactivated&&n.onexternaldisplaydeactivated(e),n.fire(we.DEACTIVATED,{type:r})})),n.G.push(e)}))}this.bt(),Ge.iOS&&this.G.forEach((function(t){"AirPlay"===t.constructor.displayName&&(t.element=n.U)})),this.initDrm()}}},{key:"videoElement",get:function(){return this.U}},{key:"videoWidth",get:function(){return this.U.videoWidth}},{key:"videoHeight",get:function(){return this.U.videoHeight}},{key:"volume",get:function(){return function(t){return Math.sqrt(t)}(this.U.volume)},set:function(t){this.U.volume=function(t){return Math.pow(t,2)}(t)}},{key:"readyState",get:function(){return this.U.readyState}}]),t}(),Tr={};try{Tr.Set=Set}catch(t){!function(t,n){var i=n(e.prototype,{size:{configurable:!0,get:function(){return this._t.length}}});function e(t){n(this,{_t:{value:[]}}),t&&t.forEach(this.add,this)}function r(n,i){return-1<(t=n._t.indexOf(i))}function u(t){return[t,t]}i.add=function(t){return r(this,t)||this._t.push(t),this},i.clear=function(){var t=this._t.length;this._t.splice(0,t)},i.delete=function(n){return r(this,n)&&!!this._t.splice(t,1)},i.entries=function(){return this._t.map(u)},i.forEach=function(t,n){this._t.forEach((function(i,e){t.call(n,i,i,this)}),this)},i.has=function(t){return r(this,t)},i.keys=i.values=function(){return this._t.slice(0)},Tr.Set=e}(0,Object.defineProperties)}var Sr=Tr.Set;function Ar(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return 0;for(var i=0,e=0,r=0;r<t.length;r++){var u=n[r]||1;e+=u,i+=t[r]*u}return i/e}function Rr(t){if(0===t.length)return 0;for(var n=0,i=0;i<t.length;i++)n+=1/t[i];return t.length/n}function Or(t,n){if(t.sort(),0===t.length)return 0;if(n<=0)return t[0];if(n>=1)return t[t.length-1];var i=t.length*n,e=Math.floor(i),r=e+1,u=i%1;return r>=t.length?t[e]:t[e]*(1-u)+t[r]*u}function Mr(t){t.sort((function(t,n){return t-n}));var n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}function jr(){return"undefined"!=typeof performance?performance.now():Date.now()}var Cr=function(t){function n(){return t.apply(this,arguments)||this}return U(n,t),n}(W(Error));function Ir(){}var xr=[],Dr=[],Nr=[];function Pr(t,n,i){return i?n?n(t):t:(t&&t.then||(t=vi.resolve(t)),n?t.then(n):t)}var Lr=[],Fr=function(){function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.retryCount,i=void 0===n?3:n,e=t.parallel,r=void 0===e?1:e,u=t.includeWithSpeeds,o=void 0===u||u,s=t.timeout,a=void 0===s?0:s,c=t.retryAbortErrors,h=void 0===c||c;this.Et=[],this.kt=new Sr,this.Tt=new Ae,this.St=i,this.At=!1,this.Rt=!1,this.Ot=r,this.Mt=o,this.jt=a,this.Ct=h,this.It()}t.getPercentileSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,i=xr.slice(-t);return Or(i,n)},t.getAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=xr.slice(-t);return Ar(i,n)},t.getHarmonicAverageSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=xr.slice(-t);return Rr(n)},t.getVolatilityScaler=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=xr.slice(-t);if(n.length<3)return null;var i=Ar(n,[]),e=Math.min.apply(Math,Y(n));return e/i},t.getMedianSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=xr.slice(-t);return Mr(n)},t.getResponseSpeeds=function(){return xr},t.getProgressSpeeds=function(){return Lr},t.getFailedSegments=function(){return Dr},t.getSuccessfulSegments=function(){return Nr};var n=t.prototype;return n.add=function(t,n){var i=this;return new vi((function(e,r){var u=i.xt(t,e,r);i.Dt(u,n),i.At&&!i.Rt&&i.Nt()}))},n.start=function(){this.At||(this.At=!0,this.Nt())},n.stop=function(){this.At=!1},n.abort=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.Et.filter((function(t){return!n||n===t.stream}));i.forEach((function(n){n.reject(new Cr("Stream manually aborted")),t.fire("downloadabort",n.identifier)})),this.Et=this.Et.filter((function(t){return n&&n!==t.stream})),this.kt.forEach((function(t){n&&n!==t.stream||t.request.abort()}))},n.Pt=function(t){for(var n=0;n<this.Et.length&&!(this.Et[n].priority>t.priority);n++);this.Et.splice(n,0,t)},n.It=function(){var t=this;this.Lt=new Ae,ai(this),window.addEventListener("online",(function(){t.start(),t.Ft&&(t.Ft.resolve(),t.Ft=null)})),window.addEventListener("offline",(function(){t.stop(),t.abort(),t.Ft=new bi}))},n.Dt=function(t,n){t.hasOwnProperty("priority")?this.Pt(t):this.Et[n?"unshift":"push"](t)},n.Nt=function(){if(this.At){this.Rt=!0;for(var t=this.Ot-this.kt.size,n=0;n<t;n++)this.Ut()}},n.xt=function(t,n,i){var e=t;return t.id&&(e=t.id),F(F({},t),{},{identifier:e,resolve:n,reject:i})},n.Ht=function(){0!==this.kt.size||0!==this.Et.length?this.kt.size<this.Ot&&this.Nt():this.Rt=!1},n.Ut=function(){if(0!==this.Et.length){var t=this.Et.shift(),n=t.url,i=t.byteRange,e=t.isInitSegmentRequest,r=t.identifier,u=t.timeout,o={stream:t.stream,data:{url:n,isInitSegmentRequest:e,requestSendTime:jr(),uuid:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^16*Math.random()>>t/4).toString(16)}))}},s=this.jt,a=parseInt(u,10);a>=0&&(s=a);var c={url:n,type:"segment",responseType:"arraybuffer",retry:this.St,hooks:{beforeRetry:[this.Bt.bind(this)]},onDownloadProgress:this.Vt(r,o),headers:i&&{Range:"bytes=".concat(i)},retryAbortErrors:this.Ct,timeout:s};this.fire("downloadstart",r),o.request=$i(c).then(this.qt(o,t)).catch(this.Wt(o,t)),this.kt.add(o)}else this.Rt=!1},n.Bt=function(){try{var t=this;return function(n){var i=function(){if(t.Ft)return function(t,n){return t&&t.then?t.then(Ir):vi.resolve()}(t.Ft)}();if(i&&i.then)return i.then(Ir)}()}catch(t){return vi.reject(t)}},n.Vt=function(t,n){var i=this,e=0,r=0,u=jr();return function(o){if(o.lengthComputable){var s=8*(o.loaded-r),a=jr(),c=a-u,h={startTime:u,length:c,bitrate:s/(c/1e3),index:e};e>0&&(Lr.length>=100&&Lr.shift(),Lr.push(h)),u=a,r=o.loaded,e+=1,i.Lt.set(n,{bytesTotal:o.total,bytesLoaded:o.loaded,percent:o.loaded/o.total,identifier:t}),i.fire("progress",t)}}},n.qt=function(t,n){var i=this,e=jr(),r=n.identifier,u=n.resolve;return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}((function(o){var s=jr()-e;return Pr(o.arrayBuffer(),(function(e){return t.data.duration=jr()-t.data.requestSendTime,i.kt.delete(t),i.Lt.delete(t),i.Gt(n,s,e.byteLength),i.fire("downloadend",r,{request:t,response:o}),Nr.push({url:t.data.url,status:200,duration:t.data.duration}),Pr(i.$t(t,e),(function(t){u(e=t),i.Ht()}))}))}))},n.Gt=function(t,n,i){var e=t.includeWithBandwidthChecks,r=n/1e3;if(i>8e3){var u=8*i,o=u/r;if(t.excludeConnectTime&&u<=16e5){var s=(50*Math.max(0,1-u/16e5)+150)/1e3;o=u/Math.max(.1,r-s)}xr.length>100&&xr.shift(),this.Mt&&e&&xr.push(o)}},n.$t=function(t,n){return t.data.url&&t.data.url.match(".ts$")?this.Yt(t,n):vi.resolve(new Uint8Array(n))},n.Yt=function(t,n){try{var i=this;return function(t,n){var e=function(){if(!i.zt)return Pr(i.Kt(),(function(t){i.zt=new t({keepOriginalTimestamps:!0})}))}();return e&&e.then?e.then(n):n()}(0,(function(){return new vi((function(e){i.zt.on("data",(function(n){i.zt.off("data");var r=new Uint8Array(n.initSegment.byteLength+n.data.byteLength);r.set(n.initSegment,0),r.set(n.data,n.initSegment.byteLength),e(t.data.isInitSegmentRequest?n.initSegment:r)})),i.zt.push(new Uint8Array(n)),i.zt.flush()}))}))}catch(t){return vi.reject(t)}},n.Wt=function(t,n){var i=this,e=n.identifier,r=n.reject,u=n.size;return function(n){var o=jr()-t.data.requestSendTime;if(t.data.duration=o,n instanceof Oi)Dr.push({url:t.data.url,status:"abort",duration:o}),i.fire("downloadabort",e);else if(n instanceof Mi)Dr.push({url:t.data.url,status:n.response.status,duration:o}),i.fire("downloaderror",e,n.response.status);else if(n instanceof Ci){if(Dr.push({url:t.data.url,status:"timeout",duration:o}),u>0&&n.timeoutMs>0){var s=8*u/(n.timeoutMs/1e3);s*=.5,xr.push(s)}i.fire("downloadtimeout",e,{timeoutMs:n.timeoutMs})}i.Lt.delete(t),i.kt.delete(t),r(n),i.Ht()}},n.Kt=function(){return yi("module/mux-mp4.js")},N(t,[{key:"parallel",get:function(){return this.Ot},set:function(t){this.Ot=t}},{key:"pendingFetches",get:function(){var t=this,n=[];return this.kt.forEach((function(i){if(t.Lt.get(i)){var e=t.Lt.get(i);e.elapsedTime=jr()-i.data.requestSendTime,n.push(e)}})),n}}]),t}(),Ur=function(){function t(t){ai(this),this.Xt=t,this.Jt=null,this.Qt=null,this.Zt=!1,this.tn=!0,this.nn=null,this.rn=[],this.un=[],this.sn=!1,this.an=null,this.cn=!1,this.hn=void 0,this.fn=!1,this.ln=!0,this.dn={},this.vn=this.pn.bind(this),this.Xt.on("durationset",this.mn.bind(this))}var n=t.prototype;return n.addStream=function(t){var n=this;t.on("segmentadd",(function(){return n.yn()}));var i=this.un.push(t)-1;t.index=i,null===this.Qt&&(this.wn(i),this.Zt=!0)},n.streamIndexAtTime=function(t){return this.dn[void 0]?{stream:this.activeStreamIndex}:this.dn[Math.floor(t/6)]},n.switchTo=function(t){var n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t;"object"===x(t)&&(r=t.index);var u=this.Qt!==r,o=u;if(!u&&this.Zt&&(u=!0),u){this.Zt=!1;var s=this.Qt,a=this.un[s];this.fire("streamchangestart",s,r),a&&o&&i&&a.abort(),this.bn=r,this.wn(r)}return this.yn(),new vi((function(t){u?n.gn=function(){n.bn===r&&(n.gn=null,t(),n.fire("streamchange",r,e))}:t()}))},n.isTimeInBuffer=function(t){for(var n=0;n<this.Jt.buffered.length;n++){var i=this.Jt.buffered.start(n),e=this.Jt.buffered.end(n);if(i<=t&&e>=t)return!0}return!1},n.hasAppendedFinalSegment=function(){return void 0!==this.hn&&this.isTimeInBuffer(this.hn)},n.clear=function(){this.un.forEach((function(t){return t.clear()}))},n.remove=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Xt._n.duration;return new vi((function(e,r){n.rn.push([t,i,e]),n.yn()}))},n.removeEventListeners=function(){this.Jt&&this.Jt.removeEventListener("updateend",this.vn)},n.mn=function(){var t=this.Xt._n.duration,n=Math.floor(t/6);n+=6%t>1?1:0;for(var i=0;i<n;i++)this.dn[i]={stream:null,segment:i,type:"video"}},n.En=function(){this.Jt.addEventListener("updateend",this.vn)},n.wn=function(t){this.tn=!0,this.Qt=t,this.Xt.kn.streamIndex=t},n.pn=function(){this.Tn(),this.Sn(),this.yn()},n.Tn=function(){if(this.cn&&this.endTime)return this.cn=!1,this.hn=this.endTime,void this.Xt.checkEndOfStream();!this.activeStream.hasNextSegment()&&this.hn>0&&"open"===this.Xt._n.readyState&&this.Xt.checkEndOfStream()},n.Sn=function(){this.nn&&(this.fire("appendbufferend",this.nn),this.nn=null,this.gn&&this.gn())},n.yn=function(){if(this.Jt){if(this.activeStream&&"closed"!==this.Xt._n.readyState&&!this.Jt.updating)if(this.rn.length)this.An();else if(!this.sn&&!this.fn)return this.tn?(this.tn=!1,void this.Rn()):void this.On()}else this.on("sourcebufferattach",this.yn)},n.An=function(){var t=this,n=$(this.rn.shift(),3),i=n[0],e=n[1],r=n[2];this.Jt.addEventListener("updateend",(function n(i){t.Jt.removeEventListener("updateend",n),r(),clearTimeout(t.an),t.an=setTimeout((function(){t.sn=!1,t.yn()}),5e3)})),this.Jt.remove(i,e)},n.Rn=function(){var t=this;this.fn=!0,this.activeStream.getInitSegment().then((function(n){return t.nn=null,t.Jt.appendBuffer(n),t.fn=!1,n})).catch((function(n){t.tn=!0,t.fn=!1}))},n.On=function(){var t=this.activeStream.getNextSegment();if(null!==t){var n=this.activeStream.getIdForSegment(t);this.activeStream.isFinal(t)&&(this.cn=!0),this.nn=n,this.fire("appendbufferstart",n);try{this.Jt.appendBuffer(t),this.dn[n.segment]=n,this.ln&&(this.ln=!1,this.fire("initialbufferstart"))}catch(n){if("QuotaExceededError"===n.name){if(this.sn=!0,this.fire("quotaexceedederror",this.Jt.buffered),this.Xt.U.currentTime>6){var i=this.Xt.U.currentTime-6;this.Xt.removeBuffer(0,i)}this.activeStream.Mn.unshift(t)}}}},N(t,[{key:"streams",get:function(){return this.un}},{key:"activeStreamIndex",get:function(){return this.Qt}},{key:"activeStream",get:function(){return this.un[this.Qt]}},{key:"sourceBuffer",get:function(){return this.Jt},set:function(t){this.Jt=t,this.En(),this.fire("sourcebufferattach")}},{key:"endTime",get:function(){var t=this.Jt.buffered;if(t.length>0)return t.end(t.length-1)}}]),t}();function Hr(){}var Br,Vr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Fr;ai(this),this.Mn=[],this.jn=t,this.tn=!0,this.Cn=NaN,this.In=n,this.xn=i,this.xn.start(),this.Dn=new Ae,this.Nn={}}t.isValidSegmentUrl=function(t){return"string"==typeof t||"string"==typeof t.url&&"string"==typeof t.byteRange};var n=t.prototype;return n.getIdForSegment=function(n){return t.isValidSegmentUrl(n)?this.Nn[n]:this.Dn.get(n).id},n.isFinal=function(t){return this.Dn.get(t).final},n.addSegment=function(n){var i=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.identifier,u=void 0===r?null:r,o=e.isFinalSegment,s=void 0!==o&&o,a=e.loadOnly,c=void 0!==a&&a,h=e.priority,f=void 0===h?0:h,l=e.includeWithBandwidthChecks,d=void 0===l||l,v=e.excludeConnectTime,p=void 0!==v&&v,m=e.timeout,y=void 0===m?null:m,w=e.size,b=void 0===w?null:w;return this.tn&&this.getInitSegment(),t.isValidSegmentUrl(n)?(this.Nn[n]=u||n,this.fire("queued",this.getIdForSegment(n)),this.xn.add({url:n.url||n,byteRange:n.byteRange,id:this.getIdForSegment(n),stream:this,includeWithBandwidthChecks:d,excludeConnectTime:p,isInitSegmentRequest:!1,priority:f,timeout:y,size:b}).then((function(t){i.Dn.set(t,{id:u||n,final:s}),i.Mn.push(t),i.fire("bufferqueueadd",i.getIdForSegment(n)),c||i.fire("segmentadd")}))):(this.Dn.set(n,{id:u,final:s}),this.Mn.push(n),this.fire("bufferqueueadd",u),vi.resolve())},n.clear=function(){this.Mn=[]},n.abort=function(){try{var t=this;return function(n,i){var e=function(){if(t.tn)return function(t){if(t&&t.then)return t.then(Hr)}(function(n,i){try{var e=function(t,n){return t&&t.then?t.then(Hr):vi.resolve()}(t.getInitSegment())}catch(t){return}return e&&e.then?e.then(void 0,i):e}(0,(function(t){})))}();return e&&e.then?e.then(i):i()}(0,(function(){t.xn.abort(t)}))}catch(t){return vi.reject(t)}},n.hasNextSegment=function(){return this.Mn.length>0},n.getNextSegment=function(){return 0===this.Mn.length?null:this.Mn.shift()},n.getInitSegment=function(){var n=this,i="object"===x(this.jn)&&"url"in this.jn?this.jn.url:this.jn;return i?(this.tn=!1,t.isValidSegmentUrl(i)?this.xn.add({url:i,byteRange:this.jn.byteRange,id:null,stream:this,isInitSegmentRequest:!0,priority:0}).then((function(t){return n.jn=t,n.jn})):vi.resolve(this.jn)):vi.resolve(null)},N(t,[{key:"codec",get:function(){return this.In},set:function(t){this.In=t}},{key:"index",get:function(){return this.Cn},set:function(t){this.Cn=t}},{key:"pendingFetches",get:function(){return this.xn.pendingFetches}}]),t}(),qr=function(){function t(t){this.U=t,this.At=!1,this.Pn=null,this.Ln={},this.Fn={},this.Un=0,this.Hn=0,this.Bn="default",this.Vn=!1,this.bound={startCheckingDroppedFrames:this.qn.bind(this),stopCheckingDroppedFrames:this.Wn.bind(this),handleVisibilityChanged:this.Gn.bind(this)}}var n=t.prototype;return n.init=function(){this.En()},n.start=function(){return this.qn(),this},n.stop=function(){return this.Wn(),this},n.destroy=function(){this.Wn(),this.$n()},n.getDroppedFrameRate=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average",e=this.Ln[n];if(!e)return 0;if(e.length<t)return 0;var r=e.slice(-t);return"median"===i?Mr(r):Ar(r)},n.getDroppedFrameTotal=function(){return{dropped:this.Yn(),total:this.zn()}},n.En=function(){this.Vn||(this.U.addEventListener("playing",this.bound.startCheckingDroppedFrames),this.U.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this.U.addEventListener("ended",this.bound.stopCheckingDroppedFrames),document.addEventListener("visibilitychange",this.bound.handleVisibilityChanged),this.Vn=!0)},n.$n=function(){this.U.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this.U.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this.U.removeEventListener("ended",this.bound.stopCheckingDroppedFrames),document.removeEventListener("visibilitychange",this.bound.handleVisibilityChanged),this.Vn=!1},n.qn=function(){this.At=!0,this.Kn()},n.Wn=function(){this.At=!1},n.Kn=function(){var t=this;if(this.At&&null!==this.Bn&&(!Ge.browser.safari||!document.hidden&&"hidden"!==document.visibilityState)){clearTimeout(this.Pn);var n=this.Yn(),i=n-this.Un;this.Un=n;var e=this.Xn(),r=e-this.Hn;this.Hn=e,this.Ln[this.Bn]||(this.Ln[this.Bn]=[]),this.Fn[this.Bn]||(this.Fn[this.Bn]=[]),this.Ln[this.Bn].length>100&&this.Ln[this.Bn].shift(),this.Fn[this.Bn].length>100&&this.Fn[this.Bn].shift(),this.Ln[this.Bn].push(i),this.Fn[this.Bn].push(r),this.Pn=setTimeout((function(){t.Kn()}),1e3)}},n.Gn=function(){!Ge.browser.safari||document.hidden&&"hidden"===document.visibilityState||this.Kn()},n.Yn=function(){return"function"==typeof this.U.getVideoPlaybackQuality?this.U.getVideoPlaybackQuality().droppedVideoFrames:this.U.webkitDroppedFrameCount||0},n.zn=function(){return"function"==typeof this.U.getVideoPlaybackQuality?this.U.getVideoPlaybackQuality().totalVideoFrames:this.U.webkitDecodedFrameCount||0},n.Xn=function(){if("function"==typeof this.U.getVideoPlaybackQuality){var t=this.U.getVideoPlaybackQuality();return t.totalVideoFrames-t.droppedVideoFrames-t.corruptedVideoFrames}return this.U.webkitDecodedFrameCount||0},N(t,[{key:"streamIndex",get:function(){return this.Bn},set:function(t){this.Bn=t}}]),t}(),Wr=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.U=t,this.V=n,ai(this);var i=this.V,e=i.fetcherTimeout,r=void 0===e?0:e,u=i.fetcherRetryAbortErrors,o=void 0===u||u;this.kn=new qr(t),this._n=new MediaSource,this.xn=new Fr({parallel:1,timeout:r,retryAbortErrors:o}),this.Jn={},this.Qn=[],this.Zn=null,this.ti=this.ni.bind(this),this.En()}var n=t.prototype;return n.switchTo=function(t){return 1===this.Qn.length&&this.video.switchTo(t)},n.getCurrentSpeed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=void 0===n?"average":n,e=t.howMany,r=void 0===e?10:e,u=t.weights,o=void 0===u?[]:u,s=t.percentile,a=void 0===s?null:s;return"harmonicAverage"===i?Fr.getHarmonicAverageSpeed(r):"average"===i?Fr.getAverageSpeed(r,o):"median"===i?Fr.getMedianSpeed(r):Fr.getPercentileSpeed(r,a)},n.getVolatilityScaler=function(t){return Fr.getVolatilityScaler(t)},n.getResponseSpeeds=function(){return Fr.getResponseSpeeds()},n.getFailedSegments=function(){return Fr.getFailedSegments()},n.getSuccessfulSegments=function(){return Fr.getSuccessfulSegments()},n.getDroppedFrameRate=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average";return this.kn.getDroppedFrameRate(t,n,i)},n.getDroppedFrameTotal=function(){return this.kn.getDroppedFrameTotal()},n.clear=function(){this.Qn.forEach((function(t){return t.clear()}))},n.initFrameDropper=function(){this.kn.init()},n.streamIndexAtTime=function(t,n){return this.Jn[n].streamIndexAtTime(t)?this.Jn[n].streamIndexAtTime(t).stream:null},n.removeBuffer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.U.duration;if(t>=(n=n||0))return vi.resolve();var i=this.Qn.map((function(i){return i.remove(t,n)}));return vi.all(i)},n.addStream=function(t,n){var i=this,e=this.ii(t);if(!this.Jn[e]){var r=new Ur(this,e);this.Jn[e]=r,this.Qn.push(r),this.readyPromise.then((function(){var n;try{n=i._n.addSourceBuffer(t)}catch(t){if(22!==t.code)return void i.fire("srcnotsupported",t);n=i.Jn[e]}i.V.duration&&(n.appendWindowEnd=i.V.duration+.1),r.sourceBuffer=n})).catch((function(t){})),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach((function(t){r.on(t,(function(n){i.fire(t,n)}))}))}var u=new Vr(n,t,this.xn);return["queued","bufferqueueadd"].forEach((function(t){u.on(t,(function(n){i.fire(t,n)}))})),this.Jn[e].addStream(u),u},n.checkEndOfStream=function(){var t=this;this.Qn.every((function(t){return t.hasAppendedFinalSegment()}))&&this.U.addEventListener("timeupdate",(function n(){t.U.removeEventListener("timeupdate",n),t.Qn.every((function(n){return n.isTimeInBuffer(t.U.currentTime)}))&&t.endOfStream()}))},n.abortFetches=function(){this.xn.abort()},n.endOfStream=function(){"open"===this._n.readyState&&(this.ei()||(this._n.endOfStream(),this.fire("endofstream")))},n.destroy=function(){this.clear(),this.ri(),this.off(),this.kn.destroy(),this.xn.abort(),this.U.src&&(this.U.removeAttribute("src"),this.U.load())},n.En=function(){var t=this;this.readyPromise=new vi((function(n,i){t.Zn=n,t._n.addEventListener("sourceopen",t.ti)})),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach((function(n){t.xn.on(n,(function(){for(var i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];t.fire.apply(t,[n].concat(e))}))}))},n.ei=function(){for(var t=0;t<this._n.sourceBuffers.length;t++)if(this._n.sourceBuffers[t].updating)return!0;return!1},n.ni=function(){URL.revokeObjectURL(this.U.src),this._n.removeEventListener("sourceopen",this.ti),this.V.duration&&(this._n.duration=this.V.duration,this.fire("durationset")),this.Zn()},n.ri=function(){this.Qn.forEach((function(t){return t.removeEventListeners()}))},n.ii=function(t){return 0===t.indexOf("audio")?"audio":"video"},N(t,[{key:"mediaSource",get:function(){return this._n}},{key:"pendingFetches",get:function(){return this.xn.pendingFetches}},{key:"streams",get:function(){return 1===this.Qn.length&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this.Qn.length&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this.Jn.video&&this.Jn.video}},{key:"audio",get:function(){return!!this.Jn.audio&&this.Jn.audio}}]),t}(),Gr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n)||this).V=e,i.blacklisted=[],i.whitelisted=[],i.MAX_LOADABLE_SEGMENTS_AUTO=3,i.MAX_LOADABLE_SEGMENTS_LOCKED=15,i.SEGMENT_DURATION=6,i}U(n,t),N(n,[{key:"displayName",get:function(){return"MediaSource"}}]);var i=n.prototype;return i.isTimeInBuffer=function(t,n,i){return this.ui(t,t,n,i,1)},i.getDistanceFromBuffer=function(t,n){for(var i=t,e=0;e<n.length;e++)if(n.start(e)<=t&&n.end(e)>=t){i=n.end(e);break}return i-t},i.blacklist=function(t){this.blacklisted[t]=1},i.lock=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=t},i.filterStreams=function(t,n,i){for(var e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=[],o=!1,s=0;s<t.length;s++)if(e&&e[0]===t[s].width&&e[1]===t[s].height)u.push(t[s]);else{if(o)break;if(!(this.blacklisted[s]&&-1===this.whitelisted.indexOf(s)||this.whitelisted.length&&-1===this.whitelisted.indexOf(s)))if(this.whitelisted.length)u.push(t[s]);else{var a=this.oi(n,i,t[s].width,t[s].height,r),c=1e3/(window.devicePixelRatio||1),h=i<c?1.75:1;a>=h&&(o=!0),u.push(t[s]),e=[t[s].width,t[s].height]}}return u},i.getCurrentSpeed=function(){var t="average",n=3,i=[1,2,5];return this.V.tests&&this.V.tests.harmonic_average&&this.V.tests.harmonic_average.group&&(t="harmonicAverage",n=this.si(),i=[]),this.scanner.sorcerer.getCurrentSpeed({type:t,howMany:n,weights:i})},i.shouldUseSurroundSound=function(t,n){return"240p"!==t[n].quality},i.getAudioIndexFromVideo=function(t,n,i){if(0===n.length)return!1;if(!t[i])return 0;var e=n.filter((function(t){return t.channels>2}));if(e.length>0&&this.shouldUseSurroundSound(t,i)){var r=e[e.length-1];return n.indexOf(r)}return n.length>1&&0===i&&t[i].height<=360&&t.length>1?"mp4a.40.2"===n[0].codecs&&n[0].bitrate<8e4&&"240p"!==t[i].quality?1:0:n.length-1},i.ai=function(t,n,i,e){var r=i/e,u=t-n*r,o=n-t/r,s=t-u,a=n-o;return u>0&&(a=n),o>0&&(s=t),[s,a]},i.oi=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=this.ai(t,n,i,e),o=i*e;r&&(o*=r);var s=window.devicePixelRatio||1,a=u[0]*u[1]*s*s;return o/a},i.si=function(){var t=hr(this.V,"lookahead_count");return t&&t.group&&t.data.count?t.data.count:t&&t.data.segment_lookahead_count?t.data.segment_lookahead_count:this.MAX_LOADABLE_SEGMENTS_AUTO},i.ci=function(t,n,i){var e=i&&i.bitrate>11e6;return 1===this.whitelisted.length?e?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this.si()*this.SEGMENT_DURATION},i.ui=function(t,n,i,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!i)return!1;n=Math.min(n,e);for(var u=0;u<i.length;u++){var o=i.start(u),s=i.end(u),a=cr(o)-r,c=cr(s)+r;if(a<=t&&c>=n){var h=n<o||t>s;if(h)continue;return!0}}return!1},i.hi=function(t){return t.video.length>0&&t.audio.length>0},i.fi=function(t,n,i,e){var r=1;return this.hi(e)&&(r=.05),this.ui(t.start,t.end,n,i,r)},n}(function(){function t(t){this.scanner=t,this.STREAM_TYPE_VIDEO="video",this.STREAM_TYPE_AUDIO="audio"}N(t,[{key:"displayName",get:function(){return"Brain"}}]);var n=t.prototype;return n.destroy=function(){},n.shouldPowerUp=function(t,n){return!1},n.shouldPowerDown=function(t,n){return!1},n.canPowerUp=function(t,n){return 1!==t.length&&n<t.length-1},n.canPowerDown=function(t,n){return 1!==t.length&&n>0},n.filterStreams=function(t){return t},t}()),$r=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).BANDWIDTH_UPSWITCH_THRESHOLD=.85,i.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,i.DEFAULT_TIMEOUT=8e3,i.SEGMENT_RELATIVE_TIMEOUT_RATIO=4/3,i.MINIMUM_TIMEOUT=1e3,i.FRAME_DROP_WINDOW_SECONDS=10,i}U(n,t),N(n,[{key:"displayName",get:function(){return"Skyfire"}}]);var i=n.prototype;return i.shouldPowerUp=function(t,n,i){i&&this.V.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this.V.startingBandwidthThreshold);var e=t.indexOf(n);if(-1===e&&(e=0),!this.canPowerUp(t,e))return vi.resolve({index:!1,reasonForSwitch:null});var r=this.getCurrentSpeed();if(!r)return vi.resolve({index:!1,reasonForSwitch:null});var u=this.li(r,this.BANDWIDTH_UPSWITCH_THRESHOLD,t);return u===e||!i&&u>e&&gi(this.scanner.currentTime,this.scanner.U.buffered)<1.5*this.SEGMENT_DURATION?vi.resolve({index:!1,reasonForSwitch:null}):vi.resolve({index:u,reasonForSwitch:3})},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.U.duration,this.scanner.U.buffered,this.scanner.U.duration);return this.whitelisted.length||this.blacklisted.length||!e?vi.resolve({index:t.length-1,reasonForSwitch:6}):vi.resolve({index:!1,reasonForSwitch:null})}if(!this.canPowerDown(t,i))return vi.resolve({index:!1,reasonForSwitch:null});var r=this.getCurrentSpeed();if(!r)return vi.resolve({index:!1,reasonForSwitch:null});if(this.hasTooManyDroppedFrames(i,n,this.V.droppedFrameSwitchPercent))return this.blacklist(i),vi.resolve({index:i-1,reasonForSwitch:2});var u=this.li(r,this.BANDWIDTH_DOWNSWITCH_THRESHOLD,t);return u===i?vi.resolve({index:!1,reasonForSwitch:null}):vi.resolve({index:u,reasonForSwitch:1})},i.hasTooManyDroppedFrames=function(t,n,i){return this.scanner.sorcerer.getDroppedFrameRate(this.FRAME_DROP_WINDOW_SECONDS,t,"median")/n.framerate*100>=i},i.getTimeEstimateToLoad=function(t,n){if(null===n)return 3;var i=n.segments[t],e=i.end-i.start,r=this.getCurrentSpeed();return e*(n.bitrate+n.audioBitrate)/r*1.3},i.canPlayFromTimeInStream=function(t,n){if(!this.isTimeInBuffer(t,this.scanner.U.buffered,this.scanner.U.duration))return!1;if(!n)return!1;var i=this.getSegmentsToLoad(!1,this.STREAM_TYPE_VIDEO,n);if(0===i.length)return!0;var e=gi(t,this.scanner.U.buffered);return this.getTimeEstimateToLoad(i[0],n)<e},i.getSegmentsToLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.STREAM_TYPE_VIDEO,i=arguments.length>2?arguments[2]:void 0,e=this.scanner.U,r=this.scanner.currentTime,u=[],o=this.ci(r,e.duration,i),s=r+o,a=this.scanner.sorcerer[n].activeStreamIndex,c=this.scanner.un[n][a];if(!c)return u;var h=this.scanner.sorcerer[n].sourceBuffer,f=null;h&&(f=h.buffered);for(var l=0;l<c.segments.length;l++){var d=c.segments[l];if(!(d.end<r||d.start>s)){var v=r>=d.start&&r<d.end,p=this.fi(d,f,this.scanner.U.duration,this.scanner.un);!t&&p||t&&p&&v||(v||s>=d.start)&&u.push(l)}}return u},i.getSegmentRelativeTimeout=function(t,n,i){var e,r=null==n?void 0:n.bitrate,u=null==(e=t[0])?void 0:e.bitrate;if(!r||!u||!i)return this.DEFAULT_TIMEOUT;if(r===u)return this.DEFAULT_TIMEOUT;var o=i*this.SEGMENT_RELATIVE_TIMEOUT_RATIO;return Math.max(this.MINIMUM_TIMEOUT,Math.min(this.DEFAULT_TIMEOUT,o))},i.li=function(t,n,i){for(var e=0,r=e;r<i.length;r++)t*n>i[r].bitrate+i[r].audioBitrate&&(e=r);return e},n}(Gr),Yr=function(t){function n(n){var i,e,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(r=t.call(this,n,u)||this).di=u.tests.ml_brain.data.mimir_url,r.vi=u.tests.ml_brain.data.geolocation,r.pi={},r.mi=null,r.yi=[],r.wi=[],r.bi=[],r.gi=[],r._i=[],r.Ei=[],r.ki=[],r.Ti=[],r.Si=[],r.Ai=null,r.Ri=0,r.Oi=null,r.Mi=null,r.ji=!1,r.Ci=!1,r.Ii=0,r.xi=[],r.Di=0,r.Ni=[[ge.DOWNLOAD_START,r.Pi.bind(G(r))],[ge.DOWNLOAD_END,r.Li.bind(G(r))],[ge.APPEND_BUFFER_END,r.Fi.bind(G(r))],[ge.DOWNLOAD_TIMEOUT,r.Ui.bind(G(r))]],r.Hi=[r.Bi],r.Vi=[r.qi],r.Ni.forEach((function(t){r.scanner.on(t[0],t[1])})),(i=Ai.hooks.beforeRequest).push.apply(i,Y(r.Hi)),(e=Ai.hooks.afterResponse).push.apply(e,Y(r.Vi)),r}U(n,t),N(n,[{key:"displayName",get:function(){return"ML"}}]);var i=n.prototype;return i.destroy=function(){var t=this;this.Ni.forEach((function(n){t.scanner.off(n[0],n[1])})),this.Hi.forEach((function(t){var n=Ai.hooks.beforeRequest,i=n.indexOf(t);i>=0&&n.splice(i,1)})),this.Vi.forEach((function(t){var n=Ai.hooks.afterResponse,i=n.indexOf(t);i>=0&&n.splice(i,1)}))},i.Pi=function(t){var n=t.identifier;n.type===this.STREAM_TYPE_VIDEO&&(this.Oi={index:n.segment,streamIndex:n.stream,complete:null}),n.type===this.STREAM_TYPE_AUDIO&&(this.Mi={index:n.segment,streamIndex:n.stream,complete:null})},i.Wi=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.STREAM_TYPE_VIDEO;return n===this.STREAM_TYPE_VIDEO?null!==this.Oi&&this.Oi.index===t.segment&&this.Oi.streamIndex===t.stream:n===this.STREAM_TYPE_AUDIO&&null!==this.Mi&&this.Mi.index===t.segment},i.Gi=function(){return null!==this.Oi||null!==this.Mi},i.Li=function(t){var n=t.identifier,i=t.data,e=i.request,r=i.response,u=e.data.duration/1e3,o=r.body.byteLength,s=null;r.perfTimings&&(s=r.perfTimings.responseStart-r.perfTimings.connectStart),n.type===this.STREAM_TYPE_VIDEO&&this.Wi(n,this.STREAM_TYPE_VIDEO)&&(this.Oi.complete={downloadTime:u,byteLength:o,ttfb:s,uuid:e.data.uuid},this.Ci||(this.$i({streamIndex:n.stream,segmentIndex:n.segment-1,segmentDLTime:u,segmentLength:o,ttfb:s,didSegmentTimeout:!1}),this.Ci=!0)),n.type===this.STREAM_TYPE_AUDIO&&this.Wi(n,this.STREAM_TYPE_AUDIO)&&(this.Mi.complete={downloadTime:u,byteLength:o,ttfb:s,uuid:e.data.uuid})},i.Ui=function(t){var n=t.identifier,i=(t.data.timeoutMs||8e3)/1e3,e=n.segment,r=this.scanner.un[n.type][n.stream].segments[e].size;delete this.pi[e],this.$i({streamIndex:n.stream,segmentIndex:e,segmentDLTime:i,segmentLength:r,ttfb:.1,didSegmentTimeout:!0})},i.Yi=function(){this.Oi=null,this.Mi=null},i.Fi=function(t){var n=t.identifier;if(n.type===this.STREAM_TYPE_VIDEO&&(this.Di+=1),this.hi(this.scanner.un)){if(this.Wi(n,this.STREAM_TYPE_VIDEO)&&this.Wi(n,this.STREAM_TYPE_AUDIO)&&null!==this.Oi.complete&&null!==this.Mi.complete){var i=this.Oi.complete,e=this.Mi.complete,r=i.downloadTime+e.downloadTime,u=i.byteLength+e.byteLength,o=i.ttfb+e.ttfb;this.$i({streamIndex:n.stream,segmentIndex:n.segment-1,segmentDLTime:r,segmentLength:u,ttfb:o,segmentRequestID:i.uuid,didSegmentTimeout:!1}),this.Yi()}}else if(this.Wi(n,this.STREAM_TYPE_VIDEO)&&null!==this.Oi.complete){var s=this.Oi.complete;this.$i({streamIndex:n.stream,segmentIndex:n.segment-1,segmentDLTime:s.downloadTime,segmentLength:s.byteLength,ttfb:s.ttfb,segmentRequestID:s.uuid,didSegmentTimeout:!1}),this.Yi()}},i.$i=function(t){var n=t.streamIndex,i=t.segmentIndex,e=t.segmentDLTime,r=t.segmentLength,u=t.ttfb,o=t.segmentRequestID,s=t.didSegmentTimeout,a=this.scanner.un.video[n],c=this.scanner.sorcerer.video.sourceBuffer;if(c&&a){this.yi.push(this.getTotalBufferDuration()),this.gi.push(gi(this.scanner.currentTime,c.buffered)),this._i.push(n),this.wi.push(e),this.bi.push(r);var h=u+this.Ri;this.ki.push(h),this.Ei.push(a.segments.length-i),this.Si.push(o),this.Ti.push(Number(s))}},i.handleScrubEnd=function(t){var n=this.wi.length,i=n?this.wi[n-1]:0,e=this.bi.length,r=e?this.bi[e-1]:0,u=this.ki.length,o=u?this.ki[u-1]:0,s=this.scanner.un.video[t],a=this.zi(s),c=a?a.index:this.Ei[this.Ei.length-1],h=this.Si.length?this.Si[this.Si.length-1]:"";this.$i({streamIndex:t,segmentIndex:c,segmentDLTime:i,segmentLength:r,ttfb:o,segmentRequestID:h,didSegmentTimeout:!1})},i.shouldPowerUp=function(t,n,i){var e=t.indexOf(n);if(-1===e&&(e=0),1===this.whitelisted.length)return this.whitelisted[0]>e?vi.resolve(0):vi.resolve(!1);if(1===this.scanner.un.video.length)return vi.resolve(!1);if(!this.canPowerUp(t,e))return vi.resolve(!1);if(this.scrubInProgress)return vi.resolve(!1);var r=this.zi(n);if(null===r)return vi.resolve(!1);var u={index:r.index,streamIndex:r.streamIndex},o=r.index;if(null!==this.mi&&this.mi.index===u.index&&this.mi.streamIndex===u.streamIndex)return vi.resolve(!1);if(!(o in this.pi))return this.Ki(u,t,n).then((function(t){return t>e&&t})).catch(console.error);var s=this.pi[o];return s>e?vi.resolve(s):vi.resolve(!1)},i.shouldPowerDown=function(t,n){var i=t.indexOf(n);if(-1===i){var e=this.isTimeInBuffer(this.scanner.U.duration,this.scanner.U.buffered,this.scanner.U.duration);return this.whitelisted.length||this.blacklisted.length||!e?vi.resolve(t.length-1):vi.resolve(!1)}if(1===this.whitelisted.length)return this.whitelisted[0]<i?vi.resolve(0):vi.resolve(!1);if(1===this.scanner.un.video.length)return vi.resolve(!1);if(!this.canPowerDown(t,i))return vi.resolve(!1);if(this.scrubInProgress)return vi.resolve(!1);var r=this.zi(n);if(null===r)return vi.resolve(!1);var u={index:r.index,streamIndex:r.streamIndex},o=r.index;if(null!==this.mi&&this.mi.index===u.index&&this.mi.streamIndex===u.streamIndex)return vi.resolve(!1);if(!(o in this.pi))return this.Ki(u,t,n).then((function(t){return t<i&&t})).catch(console.error);var s=this.pi[o];return s<i?vi.resolve(s):vi.resolve(!1)},i.getTotalBufferDuration=function(){var t=this.scanner.sorcerer.video.sourceBuffer,n=0;if(!t)return n;for(var i=0;i<t.buffered.length;i++){var e=t.buffered.start(i);n+=t.buffered.end(i)-e}return n},i.canPlayFromTimeInStream=function(t,n){return!!this.isTimeInBuffer(t,this.scanner.U.buffered,this.scanner.U.duration)&&!!n},i.Xi=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.slice(0);if(i.length<8){for(var e=8-i.length,r=0;r<e;r++)i.unshift(n);return i}return i.slice(i.length-8,i.length)},i.Ji=function(t,n){var i=this,e={240:1,360:2,480:3,540:3,720:4,1080:5,1440:6,2160:7},r={240:0,360:1,480:2,540:2,720:3,1080:4,1440:5,2160:6},u=[0,0,0,0,0,0,0,0],o=[0,0,0,0,0,0,0,0],s=[0,0,0,0,0,0,0,0];this.Di<3&&(s[s.length-1]=1);for(var a=0;a<n.length;a++){var c=n[a],h=parseInt(c.quality,10);h in e&&(u[e[h]]=1);var f=this.getAudioIndexFromVideo(n,this.xi,a),l=null;"number"==typeof f&&(l=this.xi[f]);for(var d=0;d<c.segments.length;d++)if(d===t&&h in r){var v=c.segments[d].size,p=0;l&&l.segments[d]&&(p=l.segments[d].size),o[r[h]]=v+p}}var m=this._i.map((function(t){return parseInt(i.scanner.un.video[t].quality,10)}));return{availableQualities:u,nextChunkSizes:o,lastBufferSizes:this.Xi(this.yi),lastChunkDownloadTimes:this.Xi(this.wi),lastTtfb:this.Xi(this.ki,.1),lastChunkSizes:this.Xi(this.bi),lastChunkQualities:this.Xi(m),numRemainingChunks:this.Xi(this.Ei),lastPlaybackHeads:this.Xi(this.gi),geolocation:[[this.vi]],downloadTimeout:this.Xi(this.Ti),videoStart:s}},i.Qi=function(t,n){for(var i=-1,e=-1,r=0;r<t.length;r++)t[r]>e&&(e=t[r],i=r);for(var u=[],o=0;o<n.length;o++)1===n[o]&&u.push(o);return{1:240,2:360,3:540,4:720,5:1080,6:1440,7:2160}[u[i]]},i.Zi=function(t,n){for(var i=0;i<n.length;i++){var e=parseInt(n[i].quality,10);if(e===t)return i;if(480===e&&540===t)return i}return 0},i.Bi=function(t){t.startTime=nr()},i.qi=function(t,n){return n.duration=ir(t.startTime),n},i.Ki=function(t,n,i){var e=this,r=this.Ji(t.index,n);return this.mi=t,$i.post(this.di,{json:{inputs:r},timeout:2e3}).then((function(i){e.Ri=i.perfTimings.duration;var u=JSON.parse(i.body),o=e.Qi(u.outputs[0],r.availableQualities),s=e.Zi(o,n);if(e.pi[t.index]=s,e.Si.length&&e.Ai){var a=e.Si[e.Si.length-1];e.scanner.fire(Te.BRAIN_ML_MODEL_INPUTS,F({chunkRequestID:a,duration:i.duration,geolocation:e.vi},e.Ai))}return e.Ai=r,e.mi=null,s})).catch((function(n){if(n instanceof Mi){var i={status:n.response.status,resp:n.response.body,url:e.di};e.scanner.fire(Te.BRAIN_ML_MODEL_ERR,i),e.Ii++}if(n instanceof Ci){var r={url:e.di};e.scanner.fire(Te.BRAIN_ML_MODEL_TIMEOUT,r),e.Ii++}if(n instanceof ji){var u={url:e.di};e.scanner.fire(Te.BRAIN_ML_MODEL_NET_ERR,u),e.Ii++}e.Ii>=2&&e.scanner.resetBrain(!0);var o=t.streamIndex;return e.pi[t.index]=o,e.mi=null,o}))},i.zi=function(t){var n=this.scanner.sorcerer.video.sourceBuffer,i=null;if(n&&(i=n.buffered),null===i)return null;for(var e=this.te(t),r=0;r<e.length;r++){var u=e[r].segment;if(!this.fi(u,i,this.scanner.U.duration,this.scanner.un))return e[r]}return null},i.te=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.STREAM_TYPE_VIDEO,i=this.scanner.U,e=this.scanner.currentTime,r=this.ci(e,i.duration,t),u=e+r,o=[],s=this.scanner.sorcerer[n].activeStreamIndex,a=this.scanner.un[n][s];if(!a)return o;for(var c=0;c<a.segments.length;c++){var h=a.segments[c];if(!(h.end<e||h.start>u)){var f=e>=h.start&&e<h.end;(f||u>=h.start)&&o.push({segment:h,index:c,streamIndex:s})}}return o},i.ne=function(t,n){var i=this;Object.keys(this.pi).filter((function(n){return-1===t.indexOf(parseInt(n,10))})).forEach((function(t){var e=i.pi[t],r=i.scanner.un.video[e].segments[t];i.fi(r,n,i.scanner.U.duration,i.scanner.un)||delete i.pi[t]}))},i.getSegmentsToLoad=function(t,n,i){var e=this.te(i,n),r=this.scanner.sorcerer[n].sourceBuffer,u=null;r&&(u=r.buffered),this.ne(e.map((function(t){return t.index})),u);for(var o=[],s=0;s<e.length;s++){var a=e[s].segment,c=e[s].index,h=this.fi(a,u,this.scanner.U.duration,this.scanner.un),f=c in this.pi;h||!f&&1!==this.whitelisted.length&&1!==this.scanner.un.video.length||o.push(c)}return o},N(n,[{key:"audioStreams",get:function(){return this.xi},set:function(t){this.xi=t}},{key:"scrubInProgress",set:function(t){this.ji=t},get:function(){return this.ji}}]),n}(Gr),zr=function(){function t(t,n){this.U=t,this.ee=n}var n=t.prototype;return n.start=function(){return clearInterval(this.re),this.re=setInterval(this.ue.bind(this),200),this.ue()},n.stop=function(){clearInterval(this.re)},n.onSegmentAppended=function(){this.ue()},n.ue=function(){var t=this.U.buffered,n=this.U.currentTime,i=this.oe(t,n);if(0===this.U.readyState)return!1;if(this.U.paused)return!1;var e=this.U.duration;if(n>=e)return this.U.currentTime=e-.1,!0;if(t.length<=i)return!1;var r=t.start(i);return!(r>=e||r-n>.5||0!==i||(this.stop(),this.se("audio",r),this.se("video",r),this.U.currentTime=r,0))},n.oe=function(t,n){if(!t||!t.length)return null;for(var i=0;i<t.length;i++){var e=t.start(i),r=t.end(i);if(e>n&&(0===i||r-n<=.1))break}return i>=0?i:null},n.se=function(t,n){var i=this.ee(0,t);i&&i.segments&&i.segments[0]&&(i.segments[0].start=n)},t}(),Kr=(P(Br={},"br","CMCD-Object"),P(Br,"bl","CMCD-Request"),P(Br,"bs","CMCD-Status"),P(Br,"pr","CMCD-Session"),P(Br,"sid","CMCD-Session"),P(Br,"cid","CMCD-Session"),P(Br,"sf","CMCD-Session"),P(Br,"st","CMCD-Session"),P(Br,"tb","CMCD-Object"),P(Br,"d","CMCD-Object"),P(Br,"dl","CMCD-Request"),P(Br,"mtp","CMCD-Request"),P(Br,"rmt","CMCD-Status"),P(Br,"nor","CMCD-Request"),P(Br,"nrr","CMCD-Request"),P(Br,"ot","CMCD-Object"),P(Br,"su","CMCD-Request"),P(Br,"v","CMCD-Session"),function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ae=t,this.sessionId=n.sessionId,this.clipId=n.clipId}var n=t.prototype;return n.getLogAsQueryParam=function(t,n){return this.ce(this.he(t,n))},n.he=function(t,n){var i={};return Object.assign(i,this.fe()),Object.assign(i,this.le(t,n)),i},n.ce=function(t){return ki({CMCD:this.de(t)})},n.fe=function(){var t;return P(t={},"sid",'"'.concat(this.sessionId,'"')),P(t,"cid",'"'.concat(this.clipId,'"')),P(t,"st",this.ve()),P(t,"sf",this.pe()),t},n.le=function(t,n){var i;return P(i={},"pr",this.ae.playbackRate),P(i,"br",this.ae.getBitrateAtTime(this.ae.currentTime,n)/1e3),P(i,"ot",this.me(n)),P(i,"bl",this.ye(t)),i},n.me=function(t){switch(t){case"audio":return"a";case"video":return"v";default:return"av"}},n.ye=function(t){return Math.round(1e3*(parseFloat(t.end)-parseFloat(t.start)))},n.ve=function(){switch(this.ae.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return"l";case"MediaSourceScanner":default:return"v"}},n.pe=function(){switch(this.ae.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return'"hls"';case"MediaSourceScanner":default:return'"dash"'}},n.de=function(t){for(var n=[],i="",e=0,r=Object.entries(t);e<r.length;e++){var u=$(r[e],2),o=u[0],s=u[1];n.push({key:o,value:s})}return n.sort((function(t,n){return t.key.localeCompare(n.key)})).forEach((function(t){var n=t.key,e=t.value;i+="".concat(n,"=").concat(e,",")})),i.replace(/,\s*$/,"")},t}());function Xr(t,n,i){return i?n?n(t):t:(t&&t.then||(t=vi.resolve(t)),n?t.then(n):t)}var Jr=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).reset(),i.manifestLoadDurations=[],e.mediaSourceScanner&&(i.we=e.mediaSourceScanner.maxPreloadStreamIndex),i}U(n,t),N(n,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json","video/vnd.mpeg.dash.mpd"]}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()},i.reset=function(){this.be=new Sr,this.ge={},Ge.browser.safari&&(this._e=new zr(this.U,this.ee.bind(this))),this.resetBrain(),this.Ee(),this.ke=!1,this.Te=!1,this.gt=null,this.un={},this.un.audio=[],this.un.video=[],this.xi=[],this.Se=null,this.Ae=null,this.Re=null,this.Oe=null,this.Me=null,this.je=null,this.Ce=!1,this.Ie=null,this.xe=!1,this.De=!1,this.Ne=null,this.Pe=null,this.Le=!1,this.Fe=[],this.Ue={},this.He=0,this.Be=null,clearInterval(this.Ve),clearTimeout(this.qe)},i.resetBrain=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.V.mediaSourceScanner||{};n.tests=this.V.tests;var i=Ge.ie;if(this.We&&this.We.destroy(),t||i){var e=fr(this.We);return this.We=new $r(this,n),void((e||i)&&this.fire(Te.BRAIN_ML_SWITCH_TO_SKYFIRE))}this.We=new $r(this,n);var r=hr(n,"ml_brain");r&&r.group&&r.data.use_model&&(this.We=new Yr(this,n))},i.preloadStream=function(){var t=this;if(this.Ne)return this.Ne;var n=0,i=1;this.un.audio.length&&(i=2);var e=this.sorcerer.video.activeStreamIndex;this.Fe.length&&(e=this.Fe[0]);var r=0,u=this.We.getSegmentsToLoad(!1,"video",e);u.length>0&&(r=u[0]);var o=function(){},s=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n&&(e=t.sorcerer.video.activeStreamIndex),t.Be=e,t.Ge(!0)},a=function(e){(n+=1)<i||(e.segment===r&&0===t.Fe.length?t.$e(!0).then((function(i){var r=i.index,u={reasonForSwitch:i.reasonForSwitch};if(!1!==r&&r>e.stream){if(t.sorcerer.video.switchTo(r,!1,u),t.un.audio.length){var a=t.We.getAudioIndexFromVideo(t.un.video,t.un.audio,r);t.sorcerer.audio.switchTo(a,!1)}return n=0,void s(!0)}o()})).catch(console.error):o())};return this.Ne=new vi((function(n,i){o=function(){var i=t.ee(e).segments[0].end,r=t.Ye(!0);if(t.currentTime>=r&&(t.currentTime=r),t.currentTime>i&&(t.sorcerer.clear(),t.be=new Sr),t.sorcerer.video.switchTo(e,!1),t.un.audio.length){var u=t.We.getAudioIndexFromVideo(t.un.video,t.un.audio,e);t.sorcerer.audio.switchTo(u,!1)}t.sorcerer.off("bufferqueueadd",a),t.Be=null,t.ke=!0,n()},t.sorcerer.on("bufferqueueadd",a),s()})),this.Ne},i.loadManifest=function(t){try{var n=this;return Xr(n.video.metadata.p2pReady,(function(){var i=Date.now();return Ge.browser.ie&&t&&-1!==t.indexOf("archive_playlist")?(setTimeout((function(){n.dt("MediaUnknownError","An unknown error occurred.")}),250),new vi((function(){}))):$i({url:t,timeout:1e4,type:"manifest"}).then((function(e){return e.url&&e.url!==t&&-1!==e.url.indexOf("live-archive")&&(n.Ae=e.url.split("/").slice(0,-2).join("/")),n.manifestLoadDurations.push({url:t,status:e.status,duration:Date.now()-i}),n.fire(ge.MANIFEST_LOADED),e.text()})).then(function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}((function(i){var e;return function(r,u){var o=function(){if(-1!==t.indexOf(".mpd"))return Xr(n.ze(),(function(n){var r=n.parseMPD;e=r(i,t)}));e=JSON.parse(i)}();return o&&o.then?o.then(u):u()}(0,(function(){return e}))}))).catch((function(e){if(n.manifestLoadDurations.push({url:t,status:e.response&&e.response.status,duration:Date.now()-i}),n.reset(),e instanceof Mi&&410===e.response.status)return n.fire(ge.MEDIA_URL_EXPIRED),new vi((function(){}));throw e instanceof Mi&&400===e.response.status?n.fire(ge.MEDIA_URL_BAD_REQUEST,e.response.url):e instanceof Ci&&n.fire(ge.MANIFEST_TIMEOUT),e}))}))}catch(t){return vi.reject(t)}},i.setVideoSrc=function(t,n){var i=this,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&!n&&this.Se){var r;if(("metadata"===this.J||"none"===this.J&&!this.paused)&&!this.ke)return void this.Se.then((function(){var n=i.paused;i.setVideoSrc(t,n,!1)})).catch(console.error);if("sd-fallback"===(null==(r=this.q.drmHandler)?void 0:r.state))return void this.Se.then((function(){i.setVideoSrc(t,!0,!1)})).catch(console.error);if("auto"===this.J)return void this.Se.then((function(){i.setVideoSrc(t,!1,!1)})).catch(console.error)}n&&this.reset(),n||!this.paused||this.sorcerer||(n=!0);var u=this.Ke;n&&(u=this.It);var o=t.split("/");o.pop();var s="".concat(o.join("/"),"/");this.Ce=!n,this.Se=this.Xe(t,this.J).then(this.loadManifest.bind(this)).then((function(t){return"string"==typeof i.Ae&&-1!==i.Ae.indexOf("live-archive")||(i.Ae=s),t})).then(u.bind(this)),n&&"auto"===this.J&&(this.Se=this.Je(this.Se,this.preloadStream.bind(this),!1)),this.Se=this.Qe(this.Se)},i.getBitrateAtTime=function(t,n){if(!this.sorcerer)return 0;var i=this.sorcerer.streamIndexAtTime(t,n);return this.un[n][i]?this.un[n][i].bitrate:0},i.lockStreamIndexes=function(){var t=this,n=this.Fe.map((function(n){return t.un.video.indexOf(t.un.video[n])})),i=!this.paused;if(i&&(this.Ze=!0,this.U.pause()),this.Ue.video=!1,this.We.lock(n),this.Te||"auto"===this.J){var e=Math.max(this.currentTime-7,0),r=Math.min(this.currentTime+7,this.U.duration);this.sorcerer.removeBuffer(e,r).then((function(){!t.Te&&"auto"===t.J||t.ended?t.tr():(t.seekToTime(t.currentTime),i&&t.paused&&(t.nr=!0,t.U.play()))})).catch(console.error)}},i.seekToTime=function(t){var n=this;if(t===this.currentTime)return vi.resolve();var i=null===this.Oe;if(i||(this.ir&&(this.ir(),this.ir=null),this.er=null,this.Oe=null,this.Me=null),this.Oe=t,this.rr(),this.ke)for(var e in this.un)if(this.un[e].length>0){var r=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[r].abort()}return this.er=this.ur(t),vi.all([this.Se,this.Pe]).then((function(){n.tr()})).catch(console.error),this.or&&0===t&&this.fire(ye.SEEKING),!i&&this.wasPlaying&&this.play().catch(this.et.bind(this)),this.Se.then((function(){return n.er})).catch((function(t){}))},i.takeSnapshot=function(){this.it&&t.prototype.takeSnapshot.call(this)},i.initDrm=function(){},i.onstalled=function(){return!1},i.onseeked=function(t){this.Te&&this.Ge()},i.onended=function(n){return t.prototype.onended.call(this,n),!0},i.onseeking=function(t){this.Te},i.rr=function(){var t=this;this.sr(),clearTimeout(this.ar),this.ar=setTimeout((function(){t.cr()}),200)},i.sr=function(){this.hr||(this.hr=!0,fr(this.We)&&(this.We.scrubInProgress=!0))},i.cr=function(){if(this.hr=!1,fr(this.We)){this.We.scrubInProgress=!1;var t=this.sorcerer.video.activeStreamIndex;this.We.handleScrubEnd(t),this.tr()}},i.ontimeupdate=function(n){if(!this.sorcerer)return!1;if(t.prototype.ontimeupdate.call(this),this._e&&this._e.stop(),0===this.currentTime)return this.Te;if(this.Oe)return!1;this.Te||(this.Te=!0),this.De&&this.currentTime>=this.De&&(this.sorcerer.removeBuffer(0,this.De-2),this.De=!1);var i=this.sorcerer.getDroppedFrameTotal();this.fire(ge.DROPPED_FRAMES,i);var e=this.sorcerer.getResponseSpeeds(),r=this.un.video[this.sorcerer.video.activeStreamIndex],u=this.V.tests&&this.V.tests.download_bitrate;if((!u||!u.group)&&r&&this.We.getCurrentSpeed){var o={speed:this.We.getCurrentSpeed(),bitrate:r.bitrate,speeds:e};this.fire(ge.BANDWIDTH,o)}var s=this.U.buffered.length;if(!s)return!0;var a=this.U.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this.U.duration)||(Math.abs(this.currentTime-a)<.2?(this.Le||(this.fire(ge.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer.video.activeStreamIndex>0}),this.Le=!0),!1):void 0)},i.lr=function(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this.U.duration)},i.dr=function(){return!!this.sorcerer&&!this.lr()&&(null!==this.Be?(this.pr(),!0):0!==this.currentTime||this.ke?(this.tr(),!0):this.Te)},i.onprogress=function(){this.We.canPlayFromTimeInStream(this.currentTime,this.ee())&&this.Le&&(this.fire(ge.STREAM_BUFFER_END),this.Le=!1)},i.onwaiting=function(){return!this._e||!this._e.start()},i.onerror=function(){return!!this.U.error&&(this.U.error.code===this.U.error.MEDIA_ERR_DECODE?(this.fire(ge.SCANNER_ERROR,{reason:"encountered media decode error"}),!1):t.prototype.onerror.call(this))},i.pause=function(){t.prototype.pause.call(this)},i.play=function(){var n=this;return this.Ge(),t.prototype.play.call(this,(function(){return n.je&&n.je(),n.Ce||n.ke||"auto"===n.J||(n.Se=n.Je(n.Se,n.preloadStream.bind(n))),n.Se.then((function(){return vi.resolve(n.er)}))}))},i.onpause=function(){return this.Ze?(this.Ze=!1,!1):(t.prototype.onpause.call(this),!0)},i.onplay=function(){return!this.nr||(this.nr=!1,!1)},i.Je=function(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=t.then(n);return i&&(e=this.Qe(e)),e},i.Qe=function(t){var n=this;return t.catch((function(t){return n.fire(ge.FILE_ERROR,{reason:t}),new vi((function(t,n){}))}))},i.mr=function(){this.ke&&this.un.video[this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this.Pe=this.sorcerer.removeBuffer())},i.Xe=function(t,n){var i=this;return new vi((function(e,r){"none"!==n||i.Ce&&!i.paused?e(t):i.je=function(){e(t),i.je=null}}))},i.ur=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.Oe;return new vi((function(i,e){var r=t.Te&&0===n,u=t.We.canPlayFromTimeInStream(n,t.ee());r||u?i(n):(t.mr(),t.Me=i)})).then((function(n){t.Oe=null,t.er=null;var i=new vi((function(n,i){t.ir=i,t.U.addEventListener("seeked",(function i(){n(t.U.currentTime),t.U.removeEventListener("seeked",i)}))}));return t.U.currentTime=n,i}))},i.yr=function(t,n){"auto"!==t&&"auto"===n&&(this.Se=this.Je(this.Se,this.preloadStream.bind(this))),t!==n&&"none"!==n&&this.je&&this.je()},i.wr=function(t){var n=t.audio.reduce((function(t,n){return t+n.duration}),0),i=t.video.reduce((function(t,n){return t+n.duration}),0),e=n/t.audio.length,r=i/t.video.length;return e+4<r?r-e:0},i.br=function(t){return t.video.every((function(t){return t.segments.every((function(t){return"size"in t}))}))},i.Ke=function(t){var n=this;return new vi((function(i,e){if(n.gt=t,n.un.video=n.gr(t.video),t.audio){var r=n.wr(t);if(r>0)return n.fire(ge.AV_DURATION_MISMATCH,r),n.fire(ge.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void e();var u=t.audio.filter((function(t){return"opus"===t.codecs})),o=t.audio.filter((function(t){return"opus"!==t.codecs})),s=Ge.browser.safari||Ge.iOS||Ge.iPadOS||!MediaSource.isTypeSupported('audio/mp4; codecs="opus"')||!u.length?o:u;n.un.audio=n._r(s)}for(var a=0;a<n.un.video.length;a++){var c=0;if(t.audio){var h=n.We.getAudioIndexFromVideo(n.un.video,n.un.audio,a),f=n.un.audio[h];f&&(c=f.bitrate)}n.un.video[a].audioBitrate=c}fr(n.We)&&n.un.audio.length>0&&(n.We.audioStreams=n.un.audio),n.Er(n.un.video,n.un.audio,n.gt.key_info),n.br(t)||n.resetBrain(!0),n.fire(ge.STREAMS_LOADED,n.un),i()}))},i.kr=function(t,n){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new Wr(t,n),this.U.src=URL.createObjectURL(this.sorcerer.mediaSource),this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this.Ge()},i.Ge=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.Tr(500),clearTimeout(this.qe),this.qe=setTimeout((function(){t.Tr(5e3)}),6e4),n&&this.dr()},i.Tr=function(t){var n=this;clearInterval(this.Ve),this.Ve=setInterval((function(){n.dr()}),t)},i.Ye=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t?1/0:0;for(var i in this.un)this.un[i].length&&(n=Math[t?"min":"max"](n,this.un[i][0].duration));return n},i.It=function(t){var n=this;return this.Ke(t).then((function(){var i=n.video&&n.video.metadata.percentShown?n.video.metadata.percentShown:null,e=n.We.filterStreams(n.un.video,n.U.clientWidth,n.U.clientHeight,i).length-1,r=n.un.video[0];n.Fe.length&&(r=n.un.video[n.Fe[0]]),void 0!==n.we&&e<=n.un.video.indexOf(t.video[n.we])&&(r=n.un.video[e]),n.kr(n.U,{duration:n.Ye(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1}),n.sorcerer.on("srcnotsupported",(function(){n.fire(ge.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}));var u=n.un.video.indexOf(r),o=function(t){n.un[t].forEach((function(i,e){var r=n.Sr(e,"init",t);n.Ar(e,t)&&n.un[t][e].init_segment_range&&(r={url:r,byteRange:n.Rr(e,"init",t)}),n.sorcerer.addStream("".concat(i.mime_type,'; codecs="').concat(n.un[t][e].codecs,'"'),r)}))};for(var s in n.un)o(s);n.sorcerer.video.switchTo(u,!0,{reasonForSwitch:7}),n.sorcerer.on("queued",n.Or.bind(n)),n.sorcerer.on("downloadabort",n.Mr.bind(n)),n.sorcerer.on("appendbufferend",n.Fi.bind(n)),n.sorcerer.on("downloadstart",n.Pi.bind(n)),n.sorcerer.on("downloadend",n.Li.bind(n)),n.sorcerer.on("downloaderror",n.jr.bind(n)),n.sorcerer.on("downloadtimeout",n.Ui.bind(n)),n.sorcerer.on("quotaexceedederror",n.Cr.bind(n)),n.sorcerer.video.on("streamchange",n.Ir.bind(n)),n.sorcerer.video.on("streamchangestart",n.xr.bind(n)),n.sorcerer.mediaSource.addEventListener("sourceended",(function(){n.fire(ye.PROGRESS)}))}))},i.gr=function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n},i._r=function(t){var n=t.slice(0);return n.sort((function(t,n){return t.bitrate*t.channels-n.bitrate*n.channels})),n},i.Ar=function(t,n){return!!this.un[n][t].segments[0].range},i.Rr=function(t,n,i){return"init"===n?this.un[i][t].init_segment_range:this.un[i][t].segments[n].range},i.Dr=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e="init"===n;if(e)return 0;var r=this.un[i][t].segments[n].start;return r},i.Sr=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"video",e=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r="init"===n;if(r&&!this.un[i][t].init_segment_range&&-1===this.un[i][t].init_segment.indexOf(".")){var u=this.un[i][t].init_segment;return ur(u)}var o=this.Ae,s=this.gt.base_url&&-1!==this.gt.base_url.indexOf("//");if(s&&(o=this.gt.base_url),this.gt.base_url&&!s&&(o+=this.gt.base_url),this.un[i][t].base_url&&(o+=this.un[i][t].base_url),this.Ar(t,i))return o;if("init"===n)return o+this.un[i][t].init_segment;var a=this.un[i][t].segments[n];a.url&&(o+=a.url);var c=-1!==o.indexOf("akamaized"),h=-1===o.indexOf("?")?"?":"&";return e&&this.CMCDLogger&&c&&(o+="".concat(h).concat(this.CMCDLogger.getLogAsQueryParam(a,i))),o},i.Nr=function(t,n,i){return"".concat(t,":").concat(n,":").concat(i)},i.Pr=function(t,n,i){return n===this.un[i][t].segments.length-1},i.Lr=function(t,n){var i=[],e=this.ge[t];if(!e)return i;for(var r=0;r<e.length;r++)this.be.has(this.Nr(e[r],t,n))&&i.push(e[r]);return i},i.getCurrentStream=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return this.ee(0,t)},i.ee=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return void 0!==this.sorcerer&&(t=this.sorcerer[n].activeStreamIndex),this.un[n][t]},i.$e=function(t){var n=this,i=this.un.video,e=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(0===(i=this.We.filterStreams(i,this.U.clientWidth,this.U.clientHeight,e)).length)return vi.resolve({index:!1,reasonForSwitch:null});if(this.Ue.video&&!fr(this.We))return vi.resolve({index:!1,reasonForSwitch:null});var r=i[i.length-1];if(r.id!==this.Re){this.Re=r.id;var u={index:this.un.video.indexOf(r),streams:this.un.video};this.fire(ge.STREAM_TARGET_CHANGE,u)}var o=this.ee();return this.We.shouldPowerUp(i,o,t).then((function(t){return!1===t.index?n.We.shouldPowerDown(i,o).then((function(t){return!1===t.index?{index:t.index,reasonForSwitch:t.reasonForSwitch}:{index:n.un.video.indexOf(i[t.index]),reasonForSwitch:t.reasonForSwitch}})):{index:n.un.video.indexOf(i[t.index]),reasonForSwitch:t.reasonForSwitch}}))},i.Fr=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";this.$e(!1).then((function(i){var e=i.index,r={reasonForSwitch:i.reasonForSwitch};"audio"===n&&(!1===e&&(e=t.sorcerer.video.activeStreamIndex),e=t.We.getAudioIndexFromVideo(t.un.video,t.un.audio,e),t.sorcerer.audio.activeStreamIndex===e&&(e=!1));var u=!1;!1!==e&&(u=e>t.sorcerer[n].activeStreamIndex,t.Ue[n]=!0,t.sorcerer[n].switchTo(e,!0,r).then((function(){t.Ue[n]=!1})).catch(console.error));for(var o=u,s=t.We.getSegmentsToLoad(o,n,t.ee()),a=t.sorcerer[n].activeStreamIndex,c=function(i){var e=t.Sr(a,s[i],n,!0),r=t.Lr(s[i],n);if(r.length>1)return"continue";if(1===r.length&&a<=r[0])return"continue";var u=t.Pr(a,s[i],n),o={stream:a,segment:s[i],type:n},c=t.sorcerer[n].streams[a],h=e;t.Ar(a,n)&&(h={url:h,byteRange:t.Rr(a,s[i],n)});var f=t.Dr(a,s[i],n),l="video"===n,d=null;0===a&&"video"===n&&(d=16e3);var v=null;try{v=t.un[n][a].segments[s[i]].size}catch(t){}c.addSegment(h,{identifier:o,isFinalSegment:u,priority:f,includeWithBandwidthChecks:l,timeout:d,size:v}).catch((function(t){}))},h=0;h<s.length;h++)c(h)})).catch(console.error)},i.pr=function(){var t=this,n=function(n){if(0===t.un[n].length)return"continue";var i=0,e=t.We.getSegmentsToLoad(!1,n,t.ee());e.length>0&&(i=e[0]);var r=t.Be;"audio"===n&&(r=t.We.getAudioIndexFromVideo(t.un.video,t.un.audio,t.Be));var u=t.Nr(r,i,n);if(t.be.has(u))return"continue";var o=t.Sr(r,i,n),s=t.Pr(r,i,n),a=t.sorcerer[n].streams[r],c={stream:r,segment:i,type:n},h=o;t.Ar(r,n)&&(h={url:h,byteRange:t.Rr(r,i,n)}),a.addSegment(h,{identifier:c,isFinalSegment:s,loadOnly:!0,priority:0}).catch((function(t){}))};for(var i in this.un)n(i)},i.tr=function(){var t=this;return this.Se&&this.Se.then((function(){for(var n in t.un)t.un[n].length>0&&t.Fr(n)}))},i.Or=function(t){this.be.add(this.Nr(t.stream,t.segment,t.type)),this.ge[t.segment]||(this.ge[t.segment]=[]),-1===this.ge[t.segment].indexOf(t.stream)&&this.ge[t.segment].push(t.stream)},i.Ur=function(t){var n=this;(this.ge[t.segment]||[]).forEach((function(i){n.be.delete(n.Nr(i,t.segment,t.type))}))},i.Mr=function(t){this.ge[t.segment]&&this.Ur(t)},i.Fi=function(t){this.fire(ge.APPEND_BUFFER_END,{identifier:t}),this.Ge(),this.xe&&t.stream===this.Ie&&(this.xe=!1,this.De=this.un.video[t.stream].segments[t.segment].start),this.ge[t.segment]&&this.Ur(t);var n=this.We.canPlayFromTimeInStream(this.Oe,this.ee());null!==this.Oe&&this.Me&&n&&(this.Me(this.Oe),this.Me=null),this._e&&this._e.onSegmentAppended()},i.Pi=function(t){this.fire(ge.DOWNLOAD_START,{identifier:t})},i.Li=function(t,n){this.fire(ge.DOWNLOAD_END,{identifier:t,data:n})},i.jr=function(t,n){this.Ur(t);var i=ge.DOWNLOAD_ERROR;410===n&&(i=ge.MEDIA_URL_EXPIRED),this.fire(i,{identifier:t,status:n})},i.Ui=function(t,n){this.fire(ge.DOWNLOAD_TIMEOUT,{identifier:t,data:n}),this.ge[t.segment]&&this.Ur(t),"video"===t.type?this.Ue.video=!1:"audio"===t.type&&(this.Ue.audio=!1)},i.Cr=function(t){this.fire(ge.QUOTA_EXCEEDED_ERROR,{buffered:t})},i.xr=function(t,n){var i={previousStreamIndex:this.gt.video.indexOf(this.un.video[t]),index:this.gt.video.indexOf(this.un.video[n]),streams:this.gt.video};this.fire(ge.STREAM_CHANGE_START,i)},i.Ir=function(t,n){t>this.Ie&&this.currentTime>0&&(this.xe=!0),this.Ie=t;var i={index:this.gt.video.indexOf(this.un.video[t]),streams:this.gt.video,metadata:n};this.fire(ge.STREAM_CHANGE,i)},i.Er=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.q.drmHandler;if(r){var u={audio:i.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')})),video:n.map((function(t){return"".concat(t.mime_type,';codecs="').concat(t.codecs,'"')}))};r.init(this,u,e),r.setFallbackCallback((function(){return t.pause()}))}},i.Ee=function(){var t,n;(null==(t=this.V.tests)||null==(n=t.cmcd)?void 0:n.group)&&(this.CMCDLogger=new Kr(this,this.V.sessionMetadata))},i.ze=function(){return yi("module/media-manifest.js")},N(n,[{key:"preload",get:function(){return this.J},set:function(t){this.yr(this.J,t),this.J=t}},{key:"videoElement",get:function(){return this.U}},{key:"videoWidth",get:function(){var t=this.ee();return t?t.width:this.U.videoWidth}},{key:"videoHeight",get:function(){var t=this.ee();return t?t.height:this.U.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this.Fe},set:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.Fe.join(",")!==n.join(",")&&(this.Fe=n,this.Se.then((function(){return t.lockStreamIndexes()})).catch(console.error))}},{key:"currentTime",get:function(){return null!==this.Oe?this.Oe:this.U.currentTime},set:function(t){(this.Te||0!==t)&&this.seekToTime(t)}},{key:"downloadSpeed",get:function(){return this.He}},{key:"brainDebug",get:function(){var t=this.sorcerer&&this.We&&this.We.getCurrentSpeed?this.We.getCurrentSpeed():null,n=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return{currentSpeed:t,responseSpeeds:n=n?n.slice(-20):[]}}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer.video.activeStreamIndex>0:null}}]),n}(kr),Qr=function(){function t(t){this.ae=t,this.Hr=0,this.Br=setInterval(this.Vr.bind(this),500)}var n=t.prototype;return n.destroy=function(){clearInterval(this.Br)},n.Vr=function(){var t=this.ae.videoElement,n=this.ae.getCurrentStream();if(t&&n){this.Hr=t.currentTime;var i=this.qr();null!==i&&(this.Wr=i,this.ae.lowLatencyMode?Ge.browser.ie||Ge.browser.safari||null!==this.ae.presentationDelay&&(t.playbackRate=1):t.playbackRate=1)}},n.Gr=function(){var t=this.ae.getCurrentStream();if(!t)return null;var n=t.segments[0],i=this.ae.videoElement.buffered.length&&(null==n?void 0:n.start);return n&&t.hasProgramDateTime&&i?i+(Date.now()-n.programDateTime)/1e3:t.edge},n.qr=function(){var t=this.Gr();return null===t||0===this.Hr?null:t-this.Hr},n.$r=function(){var t=this.ae.videoElement,n=this.ae.getCurrentStream();if(!t||!n)return 0;var i=t.buffered.length;return i?t.buffered.end(i-1):n.edge-this.Hr},N(t,[{key:"latency",get:function(){return this.Wr}},{key:"liveSyncPosition",get:function(){var t=this.Gr(),n=this.ae.presentationDelay,i=this.ae.getCurrentStream();return null===t||null===n||null===i?0:Math.min(i.edge,t-n-this.edgeStalled)}},{key:"edgeStalled",get:function(){var t=this.ae.getCurrentStream();if(!t)return 0;var n=3*(this.ae.lowLatencyMode&&t.partTargetDuration||t.targetDuration);return Math.max(t.age-n,0)}}]),t}(),Zr=[1,2,5],tu=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).Yr=.4,i.zr=.6,i.consecutiveStreamIndex={},i.isNewPlayback=!0,i}U(n,t),N(n,[{key:"displayName",get:function(){return"Live"}}]);var i=n.prototype;return i.optimalStream=function(t,n){var i,e;if(this.isNewPlayback&&(null==(e=this.scanner.sorcerer)?void 0:e.getResponseSpeeds().length)>=2&&(this.isNewPlayback=!1),1===t.length)return{index:0,reasonForSwitch:6};if(this.isNewPlayback){for(var r=0,u=0,o=this.scanner.videoElement.clientHeight,s=[],a=0;a<t.length;a++){var c=t[a].height;s.push(c),c<o&&c>u&&(r=a,u=t[a].height)}return{index:r=Math.max(0,r-1),reasonForSwitch:4}}for(var h=this.getCurrentSpeed(),f=n,l=n,d=0;d<t.length;d++)h*this.Yr>t[d].bandwidth&&(f=d),h*this.zr>t[d].bandwidth&&(l=d);var v=n<f?f:l;this.Kr(v),this.consecutiveStreamIndex[v]++;var p=this.scanner.lowLatencyMode?.5:1.5,m=this.scanner.segmentLength*p,y=this.scanner.videoElement,w=y.buffered,b=null==(i=this.V.mediaSourceScanner)?void 0:i.droppedFrameSwitchPercent;return w&&0!==w.length?w.end(w.length-1)-y.currentTime<m?{index:0!==n?n-1:0,reasonForSwitch:1}:n>0&&!isNaN(b)&&this.hasTooManyDroppedFrames(n,this.scanner.getCurrentStream(),b)?(this.blacklist(n),this.scanner.fire(ge.DROPPED_FRAME_PERCENT_EXCEEDED),{index:n-1,reasonForSwitch:2}):this.consecutiveStreamIndex[v]>2&&v!==n?{index:v,reasonForSwitch:3}:{index:n,reasonForSwitch:null}:{index:0,reasonForSwitch:5}},i.getCurrentSpeed=function(){var t;return null==(t=this.scanner.sorcerer)?void 0:t.getCurrentSpeed({type:"average",howMany:5,weights:Zr})},i.Kr=function(t){for(var n in this.consecutiveStreamIndex[t]||(this.consecutiveStreamIndex[t]=0),this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(n)&&parseInt(n,10)!==t&&(this.consecutiveStreamIndex[n]=0)},i.getAvailabilityStart=function(t){return this.Xr(t.edge)},i.getAvailabilityEnd=function(t){return this.Jr(t.edge)},i.getSegmentsToLoad=function(t,n,i){var e,r,u,o=this,s=this.scanner,a=s.currentTime,c=s.sorcerer,h=s.bufferTarget,f=null==(e=c[n])||null==(r=e.sourceBuffer)?void 0:r.buffered,l=(null==f?void 0:f.length)?f.start(f.length-1):0,d=function(t,n){if(!n||!n.length)return 0;if(1===n.length&&n.end(0)-n.start(0)<1e-6)return 0;for(var i=0,e=n.length-1;e>=0&&n.end(e)>t;--e)i+=n.end(e)-Math.max(n.start(e),t);return i}(Math.max(a,l),f);if(!t&&d>=h)return[];var v=this.Xr(i.edge),p=this.Jr(i.edge),m=this.scanner.lowLatencyMode&&(null==(u=i.parts)?void 0:u.length),y=(m?i.parts:i.segments).filter((function(n){return!!n.uri&&(t||!o.scanner.isSegmentAdded(n))&&!(n.end<v||n.start>p)}));return m&&y.forEach((function(t,n){for(;t=t.dependentOn;)y.includes(t)||o.scanner.isStreamSegmentAdded(t)||y.splice(n,0,t)})),c[n].activeStreamIndex,y},i.Xr=function(t){var n=t-this.Qr();return Math.max(0,n)},i.Jr=function(t){var n=this.Qr(),i=this.scanner.bufferTarget,e=t-Math.max(0,n-i);return Math.max(0,e)},i.Qr=function(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay},n}($r),nu=["disabled","hidden","showing"],iu=["subtitles","captions","descriptions","chapters","metadata"],eu=["ar","fa","he","iw","ku","ps","sd","ur","yi"],ru=new Ae,uu=new Ae,TelecineTextTrack=function(){function TelecineTextTrack(t,n){var i=t.kind,e=t.src,r=void 0===e?null:e,u=t.label,o=void 0===u?"":u,s=t.language,a=void 0===s?"":s,c=t.id,h=void 0===c?er():c;if(-1===iu.indexOf(i))throw vr(12,"SYNTAX_ERR","Syntax Error");ai(this),Object.defineProperties(this,{kind:{value:i,enumerable:!0},label:{value:o,enumerable:!0},language:{value:a,enumerable:!0},id:{value:"".concat(h),enumerable:!0},rtl:{value:-1!==eu.indexOf(a.substr(0,2)),enumerable:!0}}),this.video=n,this.src=r,this.ut=!1,ru.set(this,"disabled")}return TelecineTextTrack.prototype.dispatchEvent=function(t){this.fire(t,{target:this})},N(TelecineTextTrack,[{key:"mode",get:function(){return ru.get(this)},set:function(t){if(nu.indexOf(t)>-1){if(this.ut=!0,ru.get(this)===t)return;ru.set(this,t),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,t),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return uu.get(this)},set:function(t){uu.set(this,t),this.video.fire(ge.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}},{key:"trackElement",get:function(){return document.getElementById("telecine-track-".concat(this.id))}}]),TelecineTextTrack}();function ou(t){var n=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(t);if(!n)return-1;var i=parseInt(n[4],10)/1e3;return i+=parseInt(n[3],10),n[2]&&(i+=60*parseInt(n[2],10)),n[1]&&(i+=60*parseInt(n[1],10)*60),i}function su(t,n,i){return i?n?n(t):t:(t&&t.then||(t=vi.resolve(t)),n?t.then(n):t)}function au(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}function cu(t,n){return t&&t.then?t.then(n):n(t)}var hu=Ge.browser.ie||Ge.browser.edge?.5:.2;function fu(){}function lu(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}function du(t,n){var i=t();return i&&i.then?i.then(n):n(i)}function vu(t,n){if(!n)return t&&t.then?t.then(fu):vi.resolve()}var pu=function(t){function n(n){var i,e,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(r=t.call(this,n,u)||this).Zr=!1,r.tu=!1,r.nu=2e3,r.iu=1e4,r.reset();var o=u.lowLatencyMode?5:12;return r.bufferTarget=u.bufferTarget||o,r.presentationDelay=u.presentationDelay||o,r.lowLatencyMode=u.lowLatencyMode,r.eu=null==(i=r.V.tests)||null==(e=i.llhls_timeout)?void 0:e.group,window.addEventListener("online",(function(){r.play()})),r}U(n,t),N(n,null,[{key:"displayName",get:function(){return"HLSLiveScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported}},{key:"supportedVideoTypes",get:function(){return["application/x-mpegURL"]}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){var t,n,i;null==(t=this.Xt)||t.destroy(),null==(n=this.ru)||n.stop(),null==(i=this.uu)||i.destroy(),this.ou=new bi,this.Xt=null,this.un={},this.un.video=[],this.un.audio=[],this.Ie=0,this.su=!1,this.au=!1,this.cu=0,this.hu=Number.NEGATIVE_INFINITY,this.fu=-1,this.lu=new tu(this,this.V),this.uu=new Qr(this),this.Fe=[],this.Ue={},this.du={},this.vu={}},i.endLive=function(){var n;this.su=!1,null==(n=this.ru)||n.stop(),this.Xt&&(this.Xt.abortFetches(),this.Xt.endOfStream()),this.au=!0,t.prototype.deactivate.call(this),this.fire(ye.ENDED)},i.pu=function(){this.su||(this.su=!0,this.fire(_e.STREAM_ONLINE))},i.mu=function(){this.su&&(this.su=!1,this.fire(_e.STREAM_OFFLINE))},i.yu=function(t){t?this.pu():this.mu()},i.wu=function(t){try{var n=this;if(n.au)return;n.ru&&(n.ru.stop(),n.ru.off());var i=[n.ze()];return n.video.metadata.p2pReady&&i.push(n.video.metadata.p2pReady),su(vi.allSettled(i),(function(i){var e=$(i,1)[0].value,r=e.M3U8Loader,u=e.PLAYLIST_UPDATE,o=e.PLAYLIST_ERROR,s=e.convertTsCodecs;return n.ru=new r,n.ru.lowLatencyMode=n.lowLatencyMode,n.ru.on(u,n.bu.bind(n)),n.ru.on(o,(function(t){n.mu()})),cu(au((function(){var i=n.video.metadata.playlistRefreshUrl;return su(n.ru.start(t,i),(function(t){n.gt=t,n.pu()}))}),(function(t){throw n.mu(),n.endLive(),t})),(function(t){n.un.video=mu(function(t){return t.filter((function(n){return n.codecs.split(".")[0]===t[0].codecs.split(".")[0]}))}(function(t){var n=t.slice(0);return n.sort((function(t,n){var i=t.width*t.height*t.bitrate,e=n.width*n.height*n.bitrate;return t.width===n.width&&t.height===n.height?t.framerate-n.framerate:i-e})),n}(n.gt.video))),n.un.audio=mu(function(t){return t.filter((function(t,n,i){return i.indexOf(t)===n}))}(function(t,n){return t.reduce((function(t,n,i,e){return t.concat(function(t){return t.audio}(n))}),[])}(n.un.video)));var i=n.gu("video",!0),e=i.index,r={reasonForSwitch:i.reasonForSwitch};return su(n.ru.switchTo("video",e),(function(){var t,i=[];if(n.un.audio.length){var u=n.gu("audio",!0).index;t=u,i.push(n.ru.switchTo("audio",t))}if(n.manifest.captions&&n.manifest.captions.length>0){var o=n.gu("subtitles",!0).index;i.push(n.ru.switchTo("subtitles",o))}return su(vi.all(i),(function(){var i,u;null==(i=n.Xt)||i.destroy(),n.Xt=new Wr(n.U,{fetcherRetryAbortErrors:!1,fetcherTimeout:8e3}),n.Xt.initFrameDropper(),n.un.video.forEach((function(t){n.Xt.addStream(s(ar(n.ru.activeStream("video").mimeType,t.codecs)),t.initSegment)})),n.un.audio.forEach((function(t){n.Xt.addStream(s(ar(n.ru.activeStream("audio").mimeType,t.codecs)),t.initSegment)})),n.fire(ge.STREAMS_LOADED,n.un),n.manifest.captions&&n.manifest.captions.length>0&&(n.manifest.captions.forEach(n._u.bind(n)),n.fire(ge.TEXT_TRACKS_AVAILABLE)),n.Eu(),n.Xt.video.switchTo(e,!1,r),n.un.audio.length&&(null==(u=n.Xt.audio)||u.switchTo(t,!1))}))}))}))}))}catch(t){return vi.reject(t)}},i.ku=function(){try{var t=this;return function(t){if(t&&t.then)return t.then(fu)}(au((function(){return su(t.ru.update(),(function(){t.pu()}))}),(function(){t.mu()})))}catch(t){return vi.reject(t)}},i.Eu=function(){this.Xt.video.on("streamchange",this.Ir.bind(this)),this.Xt.video.on("streamchangestart",this.xr.bind(this)),this.Xt.on("downloadend",this.Li.bind(this)),this.Xt.on("downloadtimeout",this.Ui.bind(this)),this.Xt.on("downloadabort",this.Tu.bind(this)),this.Xt.on("appendbufferend",this.Su.bind(this))},i.Li=function(t,n){if(!t||!t.isInitSegmentRequest){var i=this.ee();n.extraContext={liveAvail:{start:this.lu.getAvailabilityStart(i),end:this.lu.getAvailabilityEnd(i)}},this.fire(ge.DOWNLOAD_END,{identifier:t,data:n})}},i.Ui=function(t,n){t&&t.isInitSegmentRequest||(this.Nr(t),this.Au(t),this.Ue[t.type]=!1,this.fire(ge.DOWNLOAD_TIMEOUT,{identifier:t,data:n}))},i.Tu=function(t){t&&t.isInitSegmentRequest||(this.Nr(t),this.Au(t))},i.xr=function(t,n){var i={previousStreamIndex:this.un.video.indexOf(this.un.video[t]),index:this.un.video.indexOf(this.un.video[n]),streams:this.un.video};this.fire(ge.STREAM_CHANGE_START,i)},i.Ir=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(ge.STREAM_CHANGE,{index:t,streams:this.un.video,metadata:n})},i.Su=function(t){var n=t.type,i=t.stream,e=this.sorcerer[n].sourceBuffer.buffered,r=this.Ru(t);r&&e.length&&(this.un[n][i].playlist.timeOffset=e.end(e.length-1)-(r.end-r.timeOffset))},i.Nr=function(t){var n=t.type,i=t.segment,e=t.part;return"".concat(n,"_").concat(i,"_").concat(e)},i.Ru=function(t){var n=t.type,i=t.stream,e=t.segment,r=t.part,u=this.un[n][i].getSegmentBySN(e);return(null==u?void 0:u.getPart(r))||u},i.Au=function(t){if(t.part>0){var n=F(F({},t),{},{part:t.part-1});this.Au(n)}var i=this.Nr(t);delete this.du[i]},i.isSegmentAdded=function(t){return!!this.du[this.Nr(t)]},i.isStreamSegmentAdded=function(t){var n=this.Nr(t),i=this.Xt[t.type].activeStreamIndex;return!!this.du[n]&&this.du[n].stream===i},i.bu=function(t,n){try{var i,e=t.type;return this.fire(ge.STREAM_UPDATED,t),"subtitles"===e?void(this.tu&&(null==(i=this.manifest.captions)?void 0:i.length)>0&&this.Ou()):(n||this.Fr(e),this.yu(this.Mu(e)||!this.ju()),this.Cu(),(this.lowLatencyMode||this.video.metadata.p2pReady)&&this.Iu(),su())}catch(t){return vi.reject(t)}},i._u=function(t,n){var i=t.label,e=t.language;if(!this.xu){var r=new TelecineTextTrack({label:i,id:n,kind:"captions",language:e},this.q);this.q.textTracks=tr([r]),this.xu=this.addTextTrack(r)}},i.Ou=function(){try{var t=this;return su(t.ou,(function(){t.manifest.captions&&t.manifest.captions[0].segments.forEach(lu((function(n){var i="".concat(n.type,"_").concat(n.mediaSequenceNumber);if(!t.vu[i])return t.vu[i]=!0,su($i(n.url).text(),(function(n){var i=function(t){var n=0,i=t.split(/(?:(?:\r\n|\n){2,})/),e=[],r=null;do{0===n&&/^\uFEFF?WEBVTT(?: .*)?/.test(i[n])&&n++,(r=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(i[n]))&&e.push({startTime:ou(r[2]),endTime:ou(r[3]),text:r[5]}),n++}while(n<i.length);return e}(n),e=function(t){var n=t.match(/=MPEGTS:(\d+),/);return(n&&n[1]||0)/9e4}(n);i.forEach((function(n){n.startTime=e+n.startTime,n.endTime=e+n.endTime;var i=new(window.VTTCue||window.TextTrackCue)(n.startTime,n.endTime,n.text);t.xu.addCue(i)}))}))})))}))}catch(t){return vi.reject(t)}},i.Mu=function(t){var n,i=this.ee(t),e=3*(this.lowLatencyMode?3:1);return(null==(n=i.playlist)?void 0:n.misses)<e},i.Du=function(){try{var t,n,i,e=this;if(!(null==(t=e.V)||null==(n=t.tests)||null==(i=n.live_verify_duration)?void 0:i.group))return vi.resolve();var r=1e3*e.bufferTarget,u=e.bufferTarget/2,o=Date.now();return su(e.ou,(function(){var t=lu((function(){return e.availableDuration>=u?vi.resolve(!0):Date.now()-o>=r?vi.resolve(!1):su(pi(100),(function(){return su(e.ku(),(function(){return t()}))}))}));return t()}))}catch(t){return vi.reject(t)}},i.tr=function(){try{var t=this;return su(t.ou,(function(){for(var n in t.un)t.un[n].length>0&&t.Fr(n)}))}catch(t){return vi.reject(t)}},i.Fr=function(t){try{var n=this;return su(n.ou,(function(){var i,e=n.gu(t),r=e.index,u=e.reasonForSwitch;return du((function(){if(r>=0&&r!==n.sorcerer[t].activeStreamIndex)return i=r>n.sorcerer[t].activeStreamIndex,n.Ue[t]=!0,su(n.ru.switchTo(t,r),(function(){var i={reasonForSwitch:u};n.sorcerer[t].switchTo(r,!0,i).then((function(){n.Ue[t]=!1})).catch(console.error)}))}),(function(){return su(pi(0),(function(){var e=n.lowLatencyMode&&void 0!==i,r=n.Xt[t].activeStreamIndex,u=n.ee(t,r),o=n.lu.getSegmentsToLoad(e,t,u),s=n.Nu();o.forEach((function(i){var e=n.Nr(i),o={type:t,stream:r,segment:i.segment,part:i.part},a="video"===t&&!i.hint,c=s;if(i.hint&&n.Zr&&i.start>n.currentTime){var h=1e3*(i.start-n.currentTime);c=Math.min(8e3,h+s)}var f=u.bitrate/8*i.duration,l=n.sorcerer[t].streams[r],d=n.Pu(i);l.addSegment(d,{identifier:o,includeWithBandwidthChecks:a,priority:i.programDateTime,excludeConnectTime:n.lowLatencyMode,timeout:n.eu||n.lowLatencyMode?c:8e3,size:n.eu||n.lowLatencyMode?f:void 0}).catch((function(t){t instanceof Cr||t instanceof Oi||n.Au(o)})),n.du[e]=o}))}))}))}))}catch(t){return vi.reject(t)}},i.Pu=function(t){var n,i=null==t?void 0:t.url,e=null==(n=this.ru)?void 0:n.baseUrl;return e&&i&&!i.startsWith(e)&&(i="".concat(e).concat(t.uri)),i},i.gu=function(t){var n,i,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.Ue[t])return{index:-1,reasonForSwitch:null};if("subtitles"===t){var r=this.ru.activeStream("video");return{index:r.subtitles[r.currentRenditions.subtitles].index,reasonForSwitch:null}}if("audio"===t){var u=this.ru.activeStream("video");return{index:u.audio[u.currentRenditions.audio].index,reasonForSwitch:null}}if(!e&&ir(this.cu)<this.nu)return{index:this.Ie,reasonForSwitch:null};this.cu=nr();var o=null==(n=this.video)||null==(i=n.metadata)?void 0:i.percentShown,s=this.lu.filterStreams(this.un.video,this.U.clientWidth,this.U.clientHeight,o);if(0===s.length)return{index:this.Ie,reasonForSwitch:null};var a=this.lu.optimalStream(s,this.Ie),c=a.index,h=a.reasonForSwitch,f=s[c],l=this.un.video.indexOf(f);if(l>=0&&(e||l!==this.Ie)){var d=l>this.Ie;if(d&&ir(this.hu)<this.iu)return{index:this.Ie,reasonForSwitch:h};var v=l<this.Ie;v&&(this.hu=nr());var p={index:l,streams:this.un.video};return this.fire(ge.STREAM_TARGET_CHANGE,p),this.Ie=l,{index:l,reasonForSwitch:h}}return{index:this.Ie,reasonForSwitch:h}},i.getCurrentStream=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return this.ee(t)},i.ee=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return void 0!==this.Xt&&null!==this.Xt&&(n=this.Xt[t].activeStreamIndex),this.un[t][n]},i.Iu=function(){if(this.U.currentTime===this.fu&&nr()-this.Lu>=1e3&&this.Fu()){var t="Jumping forward ".concat(.1,"s")+" because of stall at time of ".concat(this.U.currentTime);this.fire(_e.STALL_JUMP,{msg:t}),this.U.currentTime+=.1}this.fu=this.U.currentTime,this.Lu=nr()},i.Fu=function(){return 0!==this.U.readyState&&!!this.U.buffered.length&&!this.U.paused&&this.Uu(this.U.buffered,this.U.currentTime)},i.Uu=function(t,n){for(var i=0;i<t.length;i++)if(!(n<t.start(i)-.1||n>t.end(i)-.5))return!0;return!1},i.Cu=function(){var t=this.buffered;if(t.length){var n,i=t.length,e=this.U.currentTime;try{n=function(t,n){if(!t||!t.length)return null;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return null;for(var i,e=0;e<t.length;e++)if(t.start(e)>n&&(0===e||t.end(e-1)-n<=.5)){i=e;break}return i>=0?i:null}(t,e)}catch(t){throw DOMException,t}if(null!==n&&0!==this.U.readyState&&!(this.U.paused||i<=n)){var r,u;try{r=t.start(n),u=t.end(i-1)}catch(t){throw DOMException,t}var o=r-e,s=u-r,a=this.lowLatencyMode?1:2;if(s>0&&s<=this.segmentLength*a){var c="Preventing jump too close to buffered end time."+" Would have jumped to: ".concat(r,".")+" Last buffered end time ".concat(u,".");this.fire(_e.BUFFER_GAP_JUMP_PREVENT,{msg:c})}else{if(0===n){var h="Jumping forward ".concat(o)+" seconds because of gap before start time of ".concat(r);this.fire(_e.BUFFER_GAP_JUMP,{msg:h})}else{var f="Jumping forward ".concat(o," seconds because of gap starting at")+" ".concat(t.end(n-1)," and ending at ").concat(r);this.fire(_e.BUFFER_GAP_JUMP,{msg:f})}this.U.currentTime=r+.1}}}},i.ju=function(){var t=this.buffered;return!!(t&&t.length&&this.U.currentTime+hu>t.end(t.length-1))},i.setVideoSrc=function(t){try{var n=this;return su(n.Xe(n.J),(function(){return su(n.wu(t),(function(){n.U.src=URL.createObjectURL(n.Xt.mediaSource),n.ou.resolve()}))}))}catch(t){return vi.reject(t)}},i.Xe=function(t){try{return this.Hu=new bi,"none"===t&&this.paused||this.Hu.resolve(),this.Hu}catch(t){return vi.reject(t)}},i.getBitrateAtTime=function(t,n){if(!this.Xt)return 0;var i=this.Xt.streamIndexAtTime(t,n);return this.un[n][i]?this.un[n][i].bandwidth:0},i.onprogress=function(){this.Cu()},i.ondurationchange=function(){this.Cu()},i.ontimeupdate=function(){if(this.Xt){t.prototype.ontimeupdate.call(this),this.fire(ge.DROPPED_FRAMES,this.Xt.getDroppedFrameTotal());var n=this.ee();if(n){var i={speed:this.lu.getCurrentSpeed(),bitrate:n.bitrate,speeds:this.Xt.getResponseSpeeds()};this.fire(ge.BANDWIDTH,i)}!this.su&&this.ju()&&this.fire(_e.STREAM_OFFLINE),!this.lowLatencyMode&&ir(this.cu)>this.nu&&this.tr()}},i.seekToTime=function(){},i.onpause=function(){var t;null==(t=this.ru)||t.stop(),this.Xt&&(this.Xt.abortFetches(),this.du={},this.Xt.removeBuffer().catch((function(){})))},i.onplay=function(){this.Zr&&this.ku()},i.pause=function(){t.prototype.pause.call(this)},i.play=function(){var n=this;return t.prototype.play.call(this,lu((function(){return n.Hu.resolve(),du((function(){if(n.Zr)return n.du={},cu(au((function(){return vu(n.Xt.removeBuffer())}),(function(t){})),(function(){return vu(n.ku())}))}),(function(){return su(n.ou,(function(){return su(n.Du(),(function(){return n.tr(),su(n.Bu(),(function(){var t=Math.max(n.uu.liveSyncPosition,n.U.buffered.start(0));n.currentTime=t,n.Zr=!0}))}))}))}))})))},i.Bu=function(){var t=this;return new vi((function(n){var i=function i(){t.buffered.length&&(t.Xt.off("appendbufferend",i),n())};t.Xt.on("appendbufferend",i),i()}))},i.Nu=function(){return this.lu.getSegmentRelativeTimeout(this.un.video,this.ee("video"),1e3*this.segmentLength)},i.ze=function(){return yi("module/media-manifest.js")},i.setCaptionsState=function(t){this.tu=t},N(n,[{key:"preload",get:function(){return this.J},set:function(t){this.J!==t&&"none"!==t&&this.Hu.resolve(),this.J=t}},{key:"latency",get:function(){var t;return null==(t=this.uu)?void 0:t.latency}},{key:"lowLatencyMode",get:function(){return this._lowLatencyMode},set:function(t){this._lowLatencyMode=t,this.ru&&(this.ru.lowLatencyMode=t)}},{key:"downloadSpeed",get:function(){return this.lu.getCurrentSpeed()}},{key:"restrictedStreamIndexes",get:function(){return this.Fe},set:function(t){this.Fe.join(",")!==t.join(",")&&(this.Fe=t,this.lu.lock(this.Fe))}},{key:"videoWidth",get:function(){return this.Vu?this.Vu.width:this.U.videoWidth}},{key:"videoHeight",get:function(){return this.Vu?this.Vu.height:this.U.videoHeight}},{key:"currentTime",get:function(){return this.U.currentTime},set:function(t){this.U.readyState>0&&(this.U.currentTime=t)}},{key:"isLowerProfileAvailable",get:function(){return this.Xt?this.Xt.video.activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this.Xt}},{key:"segmentLength",get:function(){var t,n,i,e;return this.lowLatencyMode&&(null==(t=this.ru)||null==(n=t.activeStream("video"))?void 0:n.partTargetDuration)||(null==(i=this.ru)||null==(e=i.activeStream("video"))?void 0:e.targetDuration)}},{key:"segmentCount",get:function(){var t,n,i;return(null==(t=this.ru)||null==(n=t.activeStream("video"))||null==(i=n.segments)?void 0:i.length)||0}},{key:"availableDuration",get:function(){var t=this.segmentCount*this.segmentLength;return isNaN(t)?0:t}}]),n}(kr);function mu(t){return t.forEach((function(t,n){t.index=n})),t}var yu=document.createElement("video"),wu={"application/x-mpegURL":"application/x-mpegURL"},bu=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).qu=null,i.reset(),window.addEventListener("online",(function(){i.play()})),i}U(n,t),N(n,null,[{key:"displayName",get:function(){return"NativeHLSLiveScanner"}},{key:"supported",get:function(){return n.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var t=[];if("function"!=typeof yu.canPlayType)return t;for(var n in wu){var i=wu[n];yu.canPlayType(i).replace(/^no$/,"")&&t.push(n)}return t}},{key:"supportsPlaybackRate",get:function(){return!1}}]);var i=n.prototype;return i.deactivate=function(){t.prototype.deactivate.call(this),this.reset()},i.reset=function(){this.Wu&&clearTimeout(this.Wu),this.Se=null,this.Wu=null,this.su=!1,this.au=!1,this.Gu=null,this.$u=0,this.Wu=null,this.lu=new tu(this,this.V),this.Fe=[]},i.endLive=function(){var n=this;this.su=!1,this.au=!0,clearTimeout(this.Wu),this.U.pause(),setTimeout((function(){t.prototype.deactivate.call(n),n.fire(ye.ENDED)}),0)},i.Yu=function(){var t=this,n=Ti(this.video.metadata.playlistRefreshUrl.split("?")[1]);n.expires&&(this.Wu=setTimeout((function(){t.zu()}),1e3*(n.expires-10)))},i.zu=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.video.metadata.playlistRefreshUrl;return $i(i).json().then((function(e){if(!("url"in e))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(e));return t.Ku(e.url.hls).then((function(){return t.play(),t.Xu(5e3),null})).catch((function(){return t.zu(++n)}))})).catch((function(){if(n>=3)throw new Error("Manifest failed to load after ".concat(n," attempts."));return++n,t.zu(n)}))},i.Ju=function(){var t=this;this.on(_e.STREAM_OFFLINE,(function(){t.su=!1}))},i.Qu=function(t){return this.Ju(),this.su=!0,this.fire(_e.STREAM_ONLINE),this.Xu(5e3),vi.resolve(t)},i.Ku=function(t){var n=this;return this.qu=t,/json=1/.test(t)?$i(t).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from Live API manifest endpoint: ".concat(n.qu," ").concat(t));n.U.src=t.url,n.Yu()})).catch((function(t){var i=n.video.metadata.playlistRefreshUrl;return $i(i).json().then((function(t){if(!("url"in t))throw new Error("Error parsing 'url' key from player live API refresh endpoint: ".concat(i," ").concat(t));n.qu=t.url.ios,n.U.src=t.url.ios,n.Yu()}))})):(this.U.src=t,this.Yu(),vi.resolve())},i.Xu=function(t){var n=this;"number"==typeof Ge.iOS&&Ge.iOS<9||this.Gu||(this.Gu=setTimeout((function(){if(n.su){var t=new XMLHttpRequest;t.onload=function(){410!==t.status?(200!==t.status&&n.fire(_e.STREAM_OFFLINE),t.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&n.fire(_e.STREAM_OFFLINE)):n.zu()},t.onerror=function(){n.fire(_e.STREAM_OFFLINE)},/json=1/.test(n.qu)?$i(n.qu).json().then((function(i){"url"in i||n.fire(_e.STREAM_OFFLINE),t.open("GET",i.url),t.send()})).catch((function(){t.open("GET",n.qu),t.send()})):(t.open("GET",n.qu),t.send())}}),t))},i.setVideoSrc=function(t){var n=this;this.Se=this.Qu(t).then((function(){return n.qu=t,n.Ku(t)}))},i.onprogress=function(){this.Gu&&(clearTimeout(this.Gu),this.Gu=null)},i.onstalled=function(){this.Xu(1e4)},i.onerror=function(){var n=this;return this.U.error.code===this.U.error.MEDIA_ERR_SRC_NOT_SUPPORTED?($i(this.qu).then((function(){t.prototype.onerror.call(n)})).catch((function(i){i instanceof ji?n.fire(ye.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")):t.prototype.onerror.call(n)})),!1):t.prototype.onerror.call(this)},i.onwaiting=function(){this.Xu(1e4)},i.seekToTime=function(){},i.play=function(){var n=this;return t.prototype.play.call(this,(function(){return n.Se}))},N(n,[{key:"currentTime",get:function(){return this.U.currentTime},set:function(t){this.U.currentTime=t}}]),n}(kr),gu=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.Zu=t,this.B=t.B,this.V=n}N(t,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]);var n=t.prototype;return n.activate=function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")},n.deactivate=function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")},t}(),_u=new Ae,Eu=new Ae,TelecineFile=function(){function TelecineFile(t,n){var i=t.src,e=t.mime,r=t.id,u=void 0===r?er():r,o=t.priority,s=void 0===o?0:o,a=t.metadata,c=void 0===a?{}:a;if(!i)throw new TypeError("Must provide a src for the file.");if(!e)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:e,enumerable:!0},id:{value:"".concat(u),enumerable:!0},metadata:{value:c,enumerable:!0}}),this.video=n,this.priority=s,this.src=i}return N(TelecineFile,[{key:"priority",get:function(){return _u.get(this)},set:function(t){if(!("number"==typeof(t=parseInt(t,10))&&isFinite(t)&&Math.floor(t)===t&&t>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");_u.set(this,t)}},{key:"src",get:function(){return Eu.get(this)},set:function(t){Eu.set(this,t),this.video.fire(ge.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(t))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=t}}]),TelecineFile}(),ku=function(){function t(t,n){var i=t.enabled,e=void 0!==i&&i,r=t.id,u=void 0===r?er():r,o=t.kind,s=void 0===o?"":o,a=t.label,c=void 0===a?"":a,h=t.language,f=void 0===h?"":h;this.to=e,ai(this),Object.defineProperties(this,{kind:{value:s,enumerable:!0},label:{value:c,enumerable:!0},language:{value:f,enumerable:!0},id:{value:"".concat(u),enumerable:!0}}),this.video=n}return t.prototype.dispatchEvent=function(t){this.fire(t,{target:this})},N(t,[{key:"enabled",get:function(){return this.to},set:function(t){this.to=t}},{key:"active",get:function(){return this.to}}]),t}();function Tu(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys)}function Su(t,n,i){"string"==typeof n&&(n=function(t){for(var n=new ArrayBuffer(2*t.length),i=new Uint16Array(n),e=0,r=t.length;e<r;e++)i[e]=t.charCodeAt(e);return i}(n));var e=0,r=new ArrayBuffer(t.byteLength+4+n.byteLength+4+i.byteLength),u=new DataView(r);new Uint8Array(r,e,t.byteLength).set(t),e+=t.byteLength,u.setUint32(e,n.byteLength,!0),e+=4;var o=new Uint8Array(r,e,n.byteLength);return o.set(n),e+=o.byteLength,u.setUint32(e,i.byteLength,!0),e+=4,new Uint8Array(r,e,i.byteLength).set(i),new Uint8Array(r,0,r.byteLength)}function Au(t){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n?t.buffer:t,e=String.fromCharCode.apply(null,new Uint16Array(i)),r=(new DOMParser).parseFromString(e,"application/xml"),u={},o=r.getElementsByTagName("HttpHeader"),s=0;s<o.length;++s){var a=o[s].querySelector("name"),c=o[s].querySelector("value");u[a.textContent]=c.textContent}var h=r.querySelector("Challenge");return[u,t=rr(h.textContent)]}function Ru(t,n,i,e){var r=e.audio||[],u=e.video||[],o=[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map((function(t){var n={persistentState:"optional",sessionTypes:["temporary"]};return u.length&&(n.videoCapabilities=u.map((function(n){return{contentType:n,robustness:t.video}}))),r.length&&(n.audioCapabilities=r.map((function(n){return{contentType:n,robustness:t.audio}}))),n})),s=Object.keys(t).map((function(e){var r=t[e].id;if(n||i){var u=null,s=n?window.WebKitMediaKeys:window.MSMediaKeys;try{u=new s(r)}catch(t){}return vi.resolve({name:r,keySystem:u})}return navigator.requestMediaKeySystemAccess(r,o).then((function(t){return t.createMediaKeys()})).catch((function(t){})).then((function(t){return{name:r,keySystem:t}}))}));return vi.all(s)}function Ou(t,n){var i={},e="".concat(window.screen.availWidth,"x").concat(window.screen.availHeight),r=window.devicePixelRatio;return i.merchant="vimeo",i.sessionId=JSON.stringify({ua:navigator.userAgent,token:t,resolution:e,pixelRatio:r}),i.userId=n,i}function Mu(t,n){var i=null;return Object.keys(t).forEach((function(e){n.name===t[e].id&&(i=t[e])})),i}var ju=function(){function t(t,n){this.no=t.cdms,this.io=t.lr_token,this.eo=t.user,this.ro=t.asset,this.uo=n,this.oo=null,this.so=null,this.ao=null,this.co=null,this.ho=this.fo.bind(this)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.U=t.U,this.ae=t,Tu()?(this.lo=Ou(this.io,this.eo),Ru(this.no,this.uo,!1,i).then((function(t){if(t.forEach((function(t){t.keySystem&&(n.ao=t)})),!n.ao)return n.ae.fire(ge.EME_UNSUPPORTED),!1;var i=Mu(n.no,n.ao);return n.co="encrypted",n.oo=i.license_url,n.uo&&(n.do=i.certificate_url,n.co="webkitneedkey"),n.U.addEventListener(n.co,n.ho),n.uo?(n.U.webkitSetMediaKeys(n.ao.keySystem),!0):n.U.mediaKeys?(n.so=n.U.mediaKeys.createSession(),n.so.addEventListener("message",(function(t){return n.vo(t)})),!0):(n.so=n.ao.keySystem.createSession(),n.so.addEventListener("message",(function(t){return n.vo(t)})),n.U.setMediaKeys(n.ao.keySystem),!0)}))):(this.ae.fire(ge.EME_UNSUPPORTED),!1)},n.destroy=function(){this.so&&this.so.sessionId&&this.so.close(),this.U.removeEventListener(this.co,this.ho)},n.fo=function(t){var n=this;return"com.apple.fps.1_0"===this.ao.name?(this.po().then((function(i){n.mo="assetId=".concat(n.ro);var e=Su(t.initData,n.mo,i);return n.so=n.ao.keySystem.createSession("video/mp4",e),n.so.addEventListener("webkitkeymessage",(function(t){return n.vo(t)})),i})).catch((function(t){n.ae.fire(t.error,t.payload)})),!0):!this.so.sessionId&&!this.yo&&(this.yo=this.so.generateRequest(t.initDataType,t.initData).catch((function(){n.ae.fire(ge.DRM_FAILURE)})),!0)},n.vo=function(t){var n=this;return new vi((function(i,e){n.yo=null;var r=new XMLHttpRequest;r.keySession=t.target,r.responseType="arraybuffer",r.open("POST",n.oo),r.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(n.lo)));var u=t.message;if("com.microsoft.playready"===n.ao.name){var o=Au(t.message,!1),s=o[0];Object.keys(s).forEach((function(t){r.setRequestHeader([t],s[t])})),u=o[1]}if("com.apple.fps.1_0"===n.ao.name){var a=btoa(String.fromCharCode.apply(null,u));a=encodeURIComponent(a),u="spc=".concat(a,"&").concat(n.mo),r.setRequestHeader("Content-type","application/x-www-form-urlencoded")}r.onload=function(){if(403!==r.status)if(r.status>=400)e({error:ge.DRM_FAILURE});else try{n.ae.fire(ge.DRM_AUTH_SUCCESS);var t=new Uint8Array(r.response),u=t.buffer;"com.apple.fps.1_0"===n.ao.name&&(u=function(t){var n=window.atob(t.trim());return"<ckc>"===n.substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6)),new Uint8Array(atob(n).split("").map((function(t){return t.charCodeAt(0)})))}(btoa(String.fromCharCode.apply(null,t)))),r.keySession.update(u),i()}catch(t){e("Error updating key session: ".concat(t))}else{var o=JSON.parse(r.getResponseHeader("x-dt-error-message"));e({error:ge.DRM_AUTH_FAILURE,payload:{text:o.error,code:o.error_code}})}},r.onerror=e,r.send(u)})).catch((function(t){n.ae.fire(t.error,t.payload)}))},n.po=function(){var t=this;return new vi((function(n,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.open("GET",t.do),e.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(t.lo))),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:ge.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else{var t=JSON.parse(e.getResponseHeader("x-dt-error-message"));i({error:ge.DRM_AUTH_FAILURE,payload:{text:t.error,code:t.error_code}})}},e.onerror=i,e.send()}))},t}(),Cu=function(){function t(){this.wo={},this.bo={},this._o={},this.Eo={},this.ko={},this.To={},this.So="default",this.Ao={KEYCHAIN_DEFAULT:"default",KEYCHAIN_SD_FALLBACK:"sd-fallback"}}var n=t.prototype;return n.getAllKeySessions=function(){return Object.values(this.To)||[]},n.getCdms=function(t){return this.wo[t]},n.getAllPreferredKeySystems=function(){return this.bo},n.addCdms=function(t,n){this.wo[n]=t},n.addKeySession=function(t,n){this.To[n]=t},n.addLicenseTokenUrl=function(t,n){this._o[n]=t},n.addLicenseUrl=function(t,n){this.Eo[n]=t},n.addPreferedKeySystem=function(t,n){this.bo[n]=t},n.closeAllKeySessions=function(){for(var t in this.To)this.To[t]&&this.To[t].sessionId&&this.To[t].close()},N(t,[{key:"state",get:function(){return this.So},set:function(t){Object.values(this.Ao).indexOf(t)<0||(this.So=t)}},{key:"activeKeySession",get:function(){return this.To[this.So]}},{key:"activeKeySystem",get:function(){return this.bo[this.So]}},{key:"keyTypes",get:function(){return this.Ao}},{key:"activeLicenseTokenUrl",get:function(){return this._o[this.So]}},{key:"activeLicenseUrl",get:function(){return this.Eo[this.So]}}]),t}(),Iu=function(){function t(t,n){this.Ro=!!t.fallback_asset,this.uo=n,this.Oo=function(){return null},this.Hr=0,this.co=null,this.ho=this.fo.bind(this),this.Mo=this.jo.bind(this),this.Co=new Cu,this.Ao=this.Co.keyTypes,this.Co.state=this.Ao.KEYCHAIN_DEFAULT,this.Co.addCdms(t.cdms,this.Ao.KEYCHAIN_DEFAULT),this.Ro&&this.Co.addCdms(t.fallback_cdms,this.Ao.KEYCHAIN_SD_FALLBACK)}var n=t.prototype;return n.init=function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.U=t.U,this.ae=t,this.Io=!!window.MSMediaKeys,Tu()||this.Io?this.Co.state===this.Ao.KEYCHAIN_SD_FALLBACK?this.setUpKeySystem(i,e,this.Ao.KEYCHAIN_SD_FALLBACK).then((function(){n.ae.currentTime=n.Hr,n.ae.play()})):this.setUpKeySystem(i,e).then((function(){return n.setUpKeySystem(i,e,n.Ao.KEYCHAIN_SD_FALLBACK)})):(this.ae.fire(ge.EME_UNSUPPORTED),vi.reject())},n.setUpKeySystem=function(t,n){var i=this,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.Ao.KEYCHAIN_DEFAULT;return new vi((function(r,u){var o=i.Co.getCdms(e);return o||u(),Ru(o,i.uo,i.Io,t).then((function(t){i.Co.addPreferedKeySystem(t.find((function(t){return t.keySystem})),e);var r=i.Co.activeKeySystem&&Mu(o,i.Co.activeKeySystem);if(!r)throw i.ae.fire(ge.EME_UNSUPPORTED),new Error("No valid key system was found.");i.Co.addLicenseTokenUrl(r.license_url,e);var u=n&&n.inits&&n.inits[r.id];return u||i.xo(r,e),i.Do(e).then((function(){var t=i.Co.state===e;return u&&t&&i.fo(u.cenc,e)}))})).then(r)}))},n.destroy=function(){this.Co&&this.Co.closeAllKeySessions(),this.U&&this.U.removeEventListener(this.co,this.ho)},n.No=function(t){var n=this;return new vi((function(i){n.Co.state=t,n.Co.activeKeySession.addEventListener("message",(function(t){return n.vo(t)})),i()}))},n.xo=function(t,n){this.co="encrypted",this.Co.addLicenseUrl(t.license_url,n),this.uo?(this.do=t.certificate_url,this.co="webkitneedkey"):this.Io&&(this.co="msneedkey"),this.U.addEventListener(this.co,this.ho)},n.Do=function(t){var n=this;return new vi((function(i){if(n.Io){var e=function t(){n.U.msSetMediaKeys(n.Co.activeKeySystem.keySystem),n.U.removeEventListener("loadedmetadata",t),i()};n.U.readyState>=1?e():n.U.addEventListener("loadedmetadata",e)}else{if(n.uo)n.U.webkitSetMediaKeys(n.Co.activeKeySystem.keySystem);else{var r=n.U.mediaKeys||n.Co.activeKeySystem.keySystem;n.Co.addKeySession(n.Po(r),t),t===n.Co.state&&n.Co.activeKeySession.addEventListener("message",(function(t){return n.vo(t)})),n.U.mediaKeys||n.U.setMediaKeys(n.Co.activeKeySystem.keySystem)}i()}}))},n.Po=function(t,n,i){var e=t.createSession(n,i);if(!e)throw new Error("Could not create key session");return e},n.fo=function(t,n){var i=this;n=n||this.Co.state;var e=new Error("A decryption key error was encountered");return"com.apple.fps.1_0"===this.Co.activeKeySystem.name?(this.po(this.do).then((function(r){i.mo=function(t){var n=function(t){var n=new Uint16Array(t.buffer);return String.fromCharCode.apply(null,n)}(t),i=document.createElement("a");return i.href=n,i.hostname}(t.initData);var u=Su(t.initData,i.mo,r);return i.Co.addKeySession(i.Po(i.Co.activeKeySystem.keySystem,"video/mp4",u),n),i.Co.activeKeySession.contentId=i.mo,i.Co.activeKeySession.addEventListener("webkitkeymessage",(function(t){return i.vo(t)})),i.Co.activeKeySession.addEventListener("webkitkeyerror",(function(t){throw e})),r})).catch((function(t){i.ae.fire(t.error,t.payload)})),!0):"com.microsoft.playready"===this.Co.activeKeySystem.name?(this.Co.addKeySession(this.Po(this.U.msKeys,"video/mp4",t.initData),n),this.Co.activeKeySession.addEventListener("mskeymessage",(function(t){return i.vo(t)})),this.Co.activeKeySession.addEventListener("mskeyerror",(function(t){throw e})),!0):!this.Co.activeKeySession.sessionId&&!this.yo&&(this.Co.activeKeySession.addEventListener("keystatuseschange",this.Mo),this.yo=this.Co.activeKeySession.generateRequest(t.initDataType,t.initData).catch((function(){i.ae.fire(ge.DRM_FAILURE)})),!0)},n.jo=function(){var t=this,n=!1,i=Me(this.Co.activeKeySession.keyStatuses.values());if(i.forEach((function(t,i){switch(t){case"expired":n=!0}})),i.every((function(t){return"output-restricted"===t}))){if(this.Ro)return this.Hr=this.ae.currentTime,void this.No(this.Ao.KEYCHAIN_SD_FALLBACK).then((function(){t.Oo(),t.ae.fire(ge.DRM_KEY_SWITCH,t.Ao.KEYCHAIN_SD_FALLBACK)})).catch((function(n){t.ae.fire(ge.DRM_OUTPUT_RESTRICTED)}));this.ae.fire(ge.DRM_OUTPUT_RESTRICTED)}n&&this.Co.activeKeySession.close()},n.vo=function(t){var n=this;return this.Lo(this.Co.activeLicenseTokenUrl).then((function(i){return new vi((function(e,r){n.Co.addLicenseUrl(i,n.Co.state),n.yo=null;var u=new XMLHttpRequest;u.keySession=t.target,u.open("POST",n.Co.activeLicenseUrl),u.responseType="arraybuffer";var o=t.message;if("com.microsoft.playready"===n.Co.activeKeySystem.name){var s=Au(t.message),a=s[0];Object.keys(a).forEach((function(t){u.setRequestHeader(t,a[t])})),o=s[1]}"com.apple.fps.1_0"===n.Co.activeKeySystem.name&&(o=new Uint8Array(o),u.setRequestHeader("Content-type","application/octet-stream")),u.onload=function(){if(403!==u.status)if(u.status>=400)r(new TelecineError(ge.DRM_FAILURE));else try{n.ae.fire(ge.DRM_AUTH_SUCCESS);var t=new Uint8Array(u.response);u.keySession.update(t),e()}catch(t){r(new TelecineError(ge.DRM_FAILURE,"Error updating key session: ".concat(t)))}else r(new TelecineError(ge.DRM_AUTH_FAILURE))},u.onerror=r,u.send(o)})).catch((function(t){n.ae.fire(t.name,{text:t.message||"License request failed."})}))}))},n.Lo=function(t){return new vi((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.onload=function(){if(e.status>=400)i(new TelecineError(ge.DRM_FAILURE));else try{try{var t=JSON.parse(e.response),r=t.licenseAcquisitionUrl,u=t.token;if(!r&&!u)throw new Error;n("".concat(r,"?ExpressPlayToken=").concat(u))}catch(t){n(e.response)}}catch(t){i(new TelecineError(ge.DRM_FAILURE,"Error retrieving License Acquisition URL (LA_URL): ".concat(t)))}},e.onerror=i,e.send()}))},n.po=function(t){return new vi((function(n,i){var e=new XMLHttpRequest;e.open("GET",t),e.responseType="arraybuffer",e.setRequestHeader("Pragma","Cache-Control: no-cache"),e.setRequestHeader("Cache-Control","max-age=0"),e.onload=function(){if(403!==e.status)if(e.status>=400)i({error:ge.DRM_FAILURE});else try{n(new Uint8Array(e.response))}catch(t){i(t)}else i({error:ge.DRM_AUTH_FAILURE})},e.onerror=i,e.send()}))},n.setFallbackCallback=function(t){this.Oo=function(){return t()}},N(t,[{key:"state",get:function(){return this.Co.state}},{key:"hasFallbackAssets",get:function(){return this.Ro}}]),t}(),xu=new Ae,TelecineVideo=function(){function TelecineVideo(t){var n=this,i=t.files,e=t.id,r=void 0===e?er():e,u=t.title,o=void 0===u?null:u,s=t.subtitle,a=void 0===s?null:s,c=t.metadata,h=void 0===c?{}:c,f=t.textTracks,l=void 0===f?tr():f,d=t.audioTracks,v=void 0===d?tr():d,p=t.externalDisplayFiles,m=void 0===p?{}:p,y=t.chapters,w=void 0===y?[]:y,b=t.duration;if(!i||!Array.isArray(i))throw new TypeError("Must provide files for the video.");ai(this);var g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.getFileById=Ze,t}(i.map((function(t){return t instanceof TelecineFile?(t.video=n,t):new TelecineFile(t,n)}))),_=tr(l.map((function(t){return t instanceof TelecineTextTrack?(t.video=n,t):new TelecineTextTrack(t,n)}))),E=tr(v.map((function(t){return t instanceof ku?(t.video=n,t):new ku(t,n)})));Object.keys(m).forEach((function(t){!m[t]||m[t]instanceof TelecineFile||(m[t]=new TelecineFile(m[t],n))})),Object.defineProperties(this,{id:{value:"".concat(r),enumerable:!0},title:{value:o,enumerable:!0},subtitle:{value:a,enumerable:!0},metadata:{value:h,enumerable:!0},files:{value:g,enumerable:!0},textTracks:{value:_,enumerable:!0,writable:!0},audioTracks:{value:E,enumerable:!0,writable:!0},chapters:{value:w,enumerable:!0},duration:{value:b,enumerable:!0},externalDisplayFiles:{value:m,enumerable:!0}}),h.drm&&(h.drm.fastly?this.Fo=new Iu(h.drm,h.useHls):this.Fo=new ju(h.drm,h.useHls))}return TelecineVideo.prototype.deactivate=function(){var t=this;this.Fo&&this.Fo.destroy(),this.textTracks.forEach((function(n){return t.currentScanner.removeTextTrack(n)}))},N(TelecineVideo,[{key:"drmHandler",get:function(){return this.Fo||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(t){this.currentScanner.currentFile=t}},{key:"currentScanner",get:function(){return xu.get(this)},set:function(t){var n=this;this.currentScanner&&this.currentScanner.constructor.supportsTextTracks&&this.textTracks.forEach((function(t){return n.currentScanner.removeTextTrack(t)})),t.constructor.supportsTextTracks&&this.textTracks.forEach((function(n){return t.addTextTrack(n)})),xu.set(this,t)}},{key:"chapters",get:function(){return this.chapters}}]),TelecineVideo}(),Du=function(){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.Zu=t,this.V=n,this.Uo=null,this.Ho=this.V.embedTime?this.V.embedTime:0,this.Bo=!1,this.Vo=!1,this.qo=!1,this.playInitiated=!1,this.Wo=!1,this.Go=250,ai(this),this.$o=this.Yo.bind(this),this.zo=this.Ko.bind(this),this.Xo=this.Jo.bind(this),this.Qo=this.Zo.bind(this),this.ts=this.ns.bind(this),this.es=this.rs.bind(this),this.us(this.Zu.on),this.V.noInterval||this.os()}var n=t.prototype;return n.destroy=function(){clearInterval(this.Uo),this.us(this.Zu.off),this.Yo()},n.us=function(t){t(ye.PAUSE,this.zo),t(ye.PLAYING,this.$o),t(ye.SEEKING,this.Xo),t(ye.SEEKED,this.Qo),t(_e.STREAM_ONLINE,this.ts),t(_e.STREAM_OFFLINE,this.es)},n.Ko=function(){this.userPlayState=!1},n.Yo=function(){this.Bo&&(this.Bo=!1,this.fire(ge.BUFFER_ENDED))},n.Jo=function(){this.Vo=!0},n.Zo=function(){this.Vo=!1},n.ns=function(){this.Wo=!0},n.rs=function(){this.Wo=!1},n.os=function(){clearInterval(this.Uo),this.Uo=setInterval(this.runIntervalCheck.bind(this),this.Go)},n.runIntervalCheck=function(){if(this.Zu.video){var t=this.Zu.video.currentScanner;if(t){var n=this.Zu.isLive(),i=t.currentTime,e=this.Go/2/1e3;if(this.playInitiated&&(!this.Vo||n)&&(!this.Zu.paused||this.userPlayState)&&!this.Bo&&i<this.Ho+e){if(n&&!this.Wo)return;for(var r=this.Zu.buffered,u=0;u<r.length;u++)if(i>=r.start(u)&&i+.2<=r.end(u))return;if(i+e>=this.Zu.duration)return;this.Bo=!0,this.fire(ge.BUFFER_STARTED)}(this.playInitiated&&this.Bo&&i>this.Ho+e||n&&!this.Wo&&this.Bo)&&(this.Bo=!1,this.fire(ge.BUFFER_ENDED)),this.Ho=i}}},N(t,[{key:"userPlayState",get:function(){return this.qo},set:function(t){this.qo=t,t||this.Yo()}}]),t}();function Nu(){var t,n;function i(){t.src?document.createElement("video").load():t.load()}function e(){if(!n)return vi.reject();t.preload="";var i=t.play();return void 0===i&&(i=new vi((function(n){t.addEventListener("playing",n)}))),i}function r(){n&&(n.resolve(),n=null)}function u(t){n&&(n.reject(t),n=null)}return{set video(n){t=n},get video(){return t},get active(){return!!n},start:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vi.resolve.bind(vi);return n||(n=new bi),i(),t().then(e).then(r).catch(u),n},cancel:function(){n&&(n.reject(new TelecineError("PlayInterrupted","The play() request was interrupted by a call to pause()")),n=null)}}}var Pu=function(){function t(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.B=t,this.ss=n,this.V=i,this.U=null,this.rt=tr(),this.as={},this.cs=new kr(t),this.V.playRequest=new Nu,this.hs=[],this.fs=[],this.ls=null,this.it=!1,this.ds=!1,ai(this)}var n=t.prototype;return n.supportsEffect=function(t){var n=this;return!!t.supported&&t.supportedScanners.some((function(t){return n.vs(n.cs)===t.displayName}))},n.getEffectByName=function(t){var n=this,i=null;return this.fs.forEach((function(e){t===n.ps(e)&&(i=e)})),i},n.activateEffect=function(t,n){var i=new t(this,n);return i.activate(),this.fs.push(i),i},n.deactivateEffect=function(t){var n=this;return this.fs.some((function(i,e){return i.constructor===t&&(i.deactivate(),n.fs.splice(e,1),!0)}))},n.deactivateEffects=function(){var t=this;this.fs.forEach((function(n){return t.deactivateEffect(n.constructor)}))},n.play=function(){if(!this.U||this.U.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");this.ms.playInitiated||(this.ms.playInitiated=!0),this.ms.userPlayState=!0;var t=this.cs.play();return this.as.paused=!1,t},n.pause=function(){if(!this.U||this.U.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this.ms.userPlayState=!1,this.cs.pause(),this.as.paused=!0,this},n.isLive=function(){return this.currentScannerName.includes("Live")},n.endLive=function(){this.cs.endLive()},n.getBitrateAtTime=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"MediaSourceScanner"!==this.vs(this.cs)&&"HLSLiveScanner"!==this.vs(this.cs)||"audio"===n&&this.cs.un[n].length<=1?0:this.cs.getBitrateAtTime(t,n)},n.getCurrentStream=function(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"video";return null==(t=(n=this.cs).getCurrentStream)?void 0:t.call(n,i)},n.showExternalDisplayPicker=function(t){this.cs.showExternalDisplayPicker(t)},n.requestPictureInPicture=function(){return this.cs.requestPictureInPicture()},n.exitPictureInPicture=function(){return this.cs.exitPictureInPicture()},n.addChapter=function(t,n){this.cs.addChapter(t,n)},n.removeChapter=function(t){this.cs.removeChapter(t)},n.addCuePoint=function(t,n){return this.cs.addCuePoint(t,n)},n.removeCuePoint=function(t){return this.cs.removeCuePoint(t)},n.removeAllCuePoints=function(){return this.cs.removeAllCuePoints()},n.addVideoEventListeners=function(){return this.cs.addVideoEventListeners()},n.removeVideoEventListeners=function(){return this.cs.removeVideoEventListeners()},n.ys=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.textTrackSupport,e=void 0!==i&&i,r=this.U.files.sort((function(t,n){return t.priority-n.priority})),u=this.ss,o=function(n){var i=r[n];for(var o in u){var s=u[o];if(s.supported&&(!e||s.supportsTextTracks)&&-1===t.hs.indexOf(t.vs(s))&&s.supportedVideoTypes.some((function(t){return i.mime===t})))return{v:s}}};for(var s in r){var a=o(s);if("object"===x(a))return a.v}return e?(this.dt("TextTracksNotSupported","None of the scanners support text tracks in this browser."),this.hs=[],this.ys()):null},n.reactivate=function(){var t;(null==(t=this.cs)?void 0:t.reactivate)&&this.cs.reactivate(),this.play()},n.checkRebuffer=function(t,n){this.ms&&(this.ms.playInitiated=t,this.ms.userPlayState=n,this.ms.runIntervalCheck())},n.ws=function(t,n){var i=this;if(this.cs.constructor!==t||this.cs.video!==n){this.it?(this.ls=this.cs,this.ls.it=!0,this.ds||(this.ls.takeSnapshot(),this.ds=!0),this.ls.deactivate()):this.cs.deactivate();var e=new t(this.B,this.V);Object.keys(Se).forEach((function(t){var n=Se[t];e.on(n,(function(t){return i.bs(n,t,e)}))})),this.cs=e,n.currentScanner=e,this.cs.video=n;for(var r=Object.keys(this.as),u=0;u<r.length;u++){var o=r[u];"paused"!==o?"currentTime"!==o&&(this.cs[o]=this.as[o]):!1===this.as.paused&&this.cs.play()}this.cs.addChapters(n.chapters,n.duration),this.fire(ge.SCANNER_CHANGE,this.vs(this.cs)),this.cs.on(["canplay","playing"],(function(){i.ls&&(i.ls.it=!1,i.ls.removeSnapshot(),i.ls=null,i.ds=!1)}))}},n._s=function(){if(null!==this.U){var t=this.ys({textTrackSupport:this.U.textTracks.length>0});t?this.ws(t,this.U):this.dt("FilesNotPlayable","None of the files could be played in this browser.")}},n.Es=function(){this.cs.deactivate(),this.cs=new kr(this.B)},n.bs=function(t,n,i){if(i===this.cs){switch(t){case ye.ERROR:return void(n instanceof TelecineError&&this.fire(ye.ERROR,n));case ge.SCANNER_ERROR:this.dt("ScannerError","The current scanner can no longer be used because ".concat(n.reason)),this.hs.push(this.vs(this.cs)),this._s([]);break;case ge.FILE_ERROR:this.dt("FileError","The current file can no longer be used because ".concat(n.reason)),this.cs.vt();break;case ge.DOWNLOAD_ERROR:this.dt("DownloadError",n),this.cs.vt();break;case ge.EME_UNSUPPORTED:this.dt("DRMFailure",{text:null,code:"emeunsupported"});break;case ge.DRM_FAILURE:case ge.DRM_AUTH_FAILURE:this.dt("DRMFailure",{text:n.text,code:n.code});break;case ge.DRM_OUTPUT_RESTRICTED:this.dt("DRMFailure",{text:null,code:"outputrestricted"});break;case ge.DRM_AUTH_SUCCESS:this.fire(ge.DRM_AUTH_SUCCESS);break;case ye.TIME_UPDATE:this.as.currentTime=this.cs.currentTime;break;case ge.MEDIA_URL_EXPIRED:this.dt("MediaUrlExpired",n);break;case ge.MEDIA_URL_BAD_REQUEST:this.dt("MediaUrlBadRequest",n);break;case Te.BRAIN_ML_MODEL_ERR:this.dt("MimirError",n);break;case Te.BRAIN_ML_MODEL_NET_ERR:this.dt("MimirNetworkError",n);break;case Te.BRAIN_ML_MODEL_TIMEOUT:this.dt("MimirNetworkTimeout",n);break;case Ee.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case ye.ENDED:this.as.paused=!0;break;case ye.WAITING:this.fire(ye.WAITING)}this.fs.forEach((function(n){"function"==typeof n["on".concat(t)]&&n["on".concat(t)]()})),this.fire(t,n)}},n.dt=function(t,n){this.fire(ye.ERROR,new TelecineError(t,n))},n.vs=function(t){return t instanceof kr?t.constructor.displayName:t.prototype.constructor.displayName},n.os=function(){var t=this;this.ms&&this.ms.destroy(),this.ms=new Du(this,this.V),this.ms.on(ge.BUFFER_STARTED,(function(){t.fire(ge.BUFFER_STARTED)})),this.ms.on(ge.BUFFER_ENDED,(function(){t.fire(ge.BUFFER_ENDED)}))},n.ps=function(t){return t instanceof gu?t.constructor.displayName:t.prototype.constructor.displayName},n.ks=function(t){"HLSLiveScanner"===this.vs(this.cs)&&this.cs.setCaptionsState(t)},N(t,[{key:"element",get:function(){return this.B}},{key:"videoElement",get:function(){return this.cs.videoElement}},{key:"manifest",get:function(){return this.cs.manifest||{video:[]}}},{key:"supportsSettingVolume",get:function(){return this.ss.some((function(t){return t.supported&&t.supportsSettingVolume}))}},{key:"supportsPlaybackRate",get:function(){return this.cs.constructor.supportsPlaybackRate}},{key:"supportsTextTracks",get:function(){return this.ss.some((function(t){return t.supported&&t.supportsTextTracks}))}},{key:"activeEffects",get:function(){return this.fs}},{key:"latency",get:function(){return this.cs.latency}},{key:"downloadSpeed",get:function(){return this.cs.downloadSpeed||0}},{key:"pictureInPictureActive",get:function(){return this.cs.pictureInPictureActive}},{key:"pictureInPictureEnabled",get:function(){return this.cs.pictureInPictureEnabled}},{key:"isLowerProfileAvailable",get:function(){return this.cs.isLowerProfileAvailable}},{key:"buffered",get:function(){return this.cs.buffered}},{key:"bufferTarget",get:function(){return this.cs.bufferTarget},set:function(t){this.as.bufferTarget=t,this.cs.bufferTarget=t}},{key:"presentationDelay",get:function(){return this.cs.presentationDelay},set:function(t){this.as.presentationDelay=t,this.cs.presentationDelay=t}},{key:"lowLatencyMode",get:function(){return this.cs.lowLatencyMode},set:function(t){this.as.lowLatencyMode=t,this.cs.lowLatencyMode=t}},{key:"manifestLoadDurations",get:function(){return this.cs.manifestLoadDurations?this.cs.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this.cs.successfulSegments?this.cs.successfulSegments:[]}},{key:"failedSegments",get:function(){return this.cs.failedSegments?this.cs.failedSegments:[]}},{key:"cuePoints",get:function(){return this.cs.cuePoints}},{key:"currentChapterID",get:function(){if(this.cs&&this.cs.chaptersTrack&&this.cs.chaptersTrack.activeCues.length){var t=this.cs.chaptersTrack.activeCues;return t[t.length-1].id}return null}},{key:"chapters",get:function(){return this.cs.chaptersTrack?this.cs.chaptersTrack.cues:[]}},{key:"chaptersTrack",get:function(){return this.cs.chaptersTrack}},{key:"currentFile",get:function(){return this.cs.currentFile},set:function(t){if("string"==typeof t&&(t=this.wt.filter((function(n){return n.id===t}))[0]),!t)throw new TelecineError("FileNotValid","The file is not valid.");this.cs.currentFile=t}},{key:"currentScannerName",get:function(){return this.vs(this.cs)}},{key:"currentScanner",get:function(){return this.cs}},{key:"currentTime",get:function(){return this.cs.currentTime},set:function(t){this.as.currentTime=t,this.cs.currentTime=t}},{key:"duration",get:function(){return this.cs.duration}},{key:"ended",get:function(){return this.cs.ended}},{key:"externalDisplayAvailable",get:function(){return this.cs.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this.cs.externalDisplayActive}},{key:"loop",get:function(){return this.cs.loop},set:function(t){this.as.loop=t,this.cs.loop=t}},{key:"muted",get:function(){return this.cs.muted},set:function(t){this.as.muted=!!t,this.cs.muted=!!t}},{key:"playsinline",get:function(){return this.cs.playsinline},set:function(t){this.as.playsinline=!!t,this.cs.playsinline=!!t}},{key:"paused",get:function(){return this.cs.paused}},{key:"played",get:function(){return this.cs.played}},{key:"seekable",get:function(){return this.cs.seekable}},{key:"seeking",get:function(){return this.cs.seeking}},{key:"defaultPlaybackRate",get:function(){return this.cs.defaultPlaybackRate},set:function(t){this.as.defaultPlaybackRate=t,this.cs.defaultPlaybackRate=t}},{key:"playbackRate",get:function(){return this.cs.playbackRate},set:function(t){this.as.playbackRate=t,this.cs.playbackRate=t}},{key:"preload",get:function(){return this.cs.preload},set:function(t){this.as.preload=t,this.cs.preload=t}},{key:"autoPictureInPicture",get:function(){return this.cs.autoPictureInPicture},set:function(t){this.as.autoPictureInPicture=!!t,this.cs.autoPictureInPicture=!!t}},{key:"disablePictureInPicture",get:function(){return this.cs.disablePictureInPicture},set:function(t){this.as.disablePictureInPicture=!!t,this.cs.disablePictureInPicture=!!t}},{key:"video",get:function(){return this.U},set:function(t){this.U&&this.U.deactivate(),this.hs=[],this.os(),null===t?(this.U=null,this.Es()):(this.U=new TelecineVideo(t),this._s())}},{key:"videoWidth",get:function(){return this.cs.videoWidth}},{key:"videoHeight",get:function(){return this.cs.videoHeight}},{key:"volume",get:function(){return this.cs.volume},set:function(t){if(t<0||t>1)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided (".concat(t,") is outside of the range [0, 1]."));this.as.volume=t,this.cs.volume=t}},{key:"brainDebug",get:function(){return this.cs.brainDebug}}]),t}(),Lu=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).Ts=!1,i.U=i.Zu.cs.U,i}U(n,t),N(n,null,[{key:"displayName",get:function(){return"CanvasEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[kr,Jr]}}]);var i=n.prototype;return i.activate=function(){this.Ts=!0,this.Ss=document.createElement("canvas"),this.Ss.className="vp-canvas-effect",this.Ss.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this.As=this.Ss.getContext("2d",{alpha:!1}),this.B.appendChild(this.Ss),this.Rs()},i.deactivate=function(){this.Ss&&this.B.removeChild(this.Ss),this.Os(),this.Ts=!1},i.Rs=function(){this.Ms()},i.Ms=function(){this.Cs=window.requestAnimationFrame(this.Is.bind(this))},i.Is=function(){var t=this.U,n=this.Ss;n.width=t.clientWidth,n.height=t.clientHeight;var i=Math.floor(this.xs()),e=Math.floor(this.Ds()),r=Math.floor((t.clientWidth-i)/2),u=Math.floor((t.clientHeight-e)/2);this.As.fillStyle="#000",this.As.fillRect(0,0,n.width,n.height),this.As.drawImage(t,r,u,i,e),this.Ms()},i.Ns=function(){return this.U.videoHeight/this.U.videoWidth},i.xs=function(){return Math.min(this.U.clientHeight/this.Ns(),this.U.clientWidth)},i.Ds=function(){return Math.min(this.U.clientWidth*this.Ns(),this.U.clientHeight)},i.Os=function(){this.Cs&&(window.cancelAnimationFrame(this.Cs),this.Cs=null)},n}(gu),Fu=function(){function t(){}return N(t,null,[{key:"Equirect",get:function(){return"equirectangular"}}]),t}(),Uu=function(){function t(){}return N(t,null,[{key:"Mono",get:function(){return"mono"}},{key:"TopBottom",get:function(){return"top-bottom"}}]),t}(),Hu=function(){function t(t,n,i){switch(this.isStereo=n!==Uu.Mono,this.Ps=null,this.Ls=null,t){case Fu.Equirect:this.createEquirectProjection(i,n);break;default:this.createEquirectProjection(i,Uu.Mono)}}var n=t.prototype;return n.createEquirectProjection=function(t,n){switch(n){case Uu.Mono:this.Ps=this.Fs(t);break;case Uu.TopBottom:this.Ps=this.Fs(t),this.Ls=this.Fs(t),this.Ps.layers.set(1),this.Ls.layers.set(2),this.Us(this.Ps.geometry,.5,0),this.Us(this.Ls.geometry,.5,.5)}},n.Fs=function(n,i,e,r){var u=new THREE.SphereBufferGeometry(i||t.SPHERE_RADIUS,e||t.TESSELATION_WIDTH,r||t.TESSELATION_HEIGHT);u.scale(-1,1,1);var o=new THREE.MeshBasicMaterial({map:n});return new THREE.Mesh(u,o)},n.Us=function(t,n,i){for(var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=0;r<t.attributes.uv.array.length;r+=2)t.attributes.uv.array[r+e]*=n,t.attributes.uv.array[r+e]+=i},N(t,[{key:"left",get:function(){return this.Ps}},{key:"right",get:function(){return this.Ls}}],[{key:"TESSELATION_WIDTH",get:function(){return 120}},{key:"TESSELATION_HEIGHT",get:function(){return 80}},{key:"SPHERE_RADIUS",get:function(){return 500}}]),t}(),Bu=function(){function t(t){this.Hs=t}var n=t.prototype;return n.hasVRHeadset=function(){var t=this;return Ge.webvr?navigator.getVRDisplays().then((function(n){return n.length>0?(t.Hs.vr.setDevice(n[0]),n[0]):null})):null},n.enter=function(){return this.Hs.vr.getDevice()&&this.Hs.vr.getDevice().requestPresent([{source:this.Hs.domElement}])},n.exit=function(){return this.Hs.vr.getDevice()&&this.Hs.vr.getDevice().exitPresent()},N(t,[{key:"supported",get:function(){return Ge.webvr}},{key:"device",get:function(){return this.Hs&&this.Hs.vr.getDevice()?this.Hs.vr.getDevice():null}},{key:"isPresenting",get:function(){return!(!this.Hs||!this.Hs.vr.getDevice())&&this.Hs.vr.getDevice().isPresenting}}]),t}(),Vu=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).Ts=!1,i.Bs=null,i.Vs=null,i.Hs=null,i.isUserInteracting=!1,i.qs=0,i.Ws=0,i._coordinates={lat:0,long:0},i.Gs={lat:0,long:0},i.$s={lat:0,long:0},i.Ys=i.cameraProps,i.zs=0,i.Ks=0,i.Xs=0,i.U=i.Zu.cs.U,i.Js=null,i.Qs={x:0,y:0},i.Zs={lat:0,long:0},i.ta={videoFps:i.V.fps,motionRenderSpeed:60},i.na=1e3/i.ta.videoFps,i.ia=[],i.ea=!1,i.ra=!1,i.oa=!1,i.sa={up:!1,down:!1,left:!1,right:!1},i}U(n,t),N(n,[{key:"isUserInteracting",set:function(t){t!==this.aa&&(this.aa=t,t?this.V.isMobile||this.Zu.fire(Ee.MOTION_START):this.V.isMobile||this.Zu.fire(Ee.MOTION_END))},get:function(){return this.aa}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(t){return this.Zu.cs.fire(Ee.SPATIAL_UNSUPPORTED),!1}}},{key:"supportedScanners",get:function(){return[kr,Jr]}}]),n.frustumSurfaceArea=function(t,n,i){var e=2*Hu.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(t/2));return e*(e*n/i)/(4*Math.PI*Math.pow(Hu.SPHERE_RADIUS,2))};var i=n.prototype;return i.activate=function(){var t=this;return new vi((function(n,i){if(window.THREE)n();else{var e=document.createElement("script");e.src=t.V.threeUrl,document.body.appendChild(e),e.onload=function(){n()}}})).then((function(){return t.It()}))},i.It=function(){var t=this;this.Ts=!0,this.Bs=new THREE.PerspectiveCamera(this.V.fieldOfView,this.U.clientWidth/this.U.clientHeight,1,2*Hu.SPHERE_RADIUS),this.Bs.target=new THREE.Vector3(0,0,0),this.Bs.layers.enable(1),this.ca(this.V.directorTimeline),this.Vs=new THREE.Scene,this.ha=new THREE.VideoTexture(this.U),this.ha.generateMipmaps=!1,this.ha.minFilter=THREE.NearestFilter,this.ha.maxFilter=THREE.NearestFilter,this.ha.format=THREE.RGBFormat,this.fa=new Hu(this.V.projection,this.V.stereoMode,this.ha),this.fa.isStereo&&this.Vs.add(this.fa.right),this.Vs.add(this.fa.left),this.Hs=new THREE.WebGLRenderer,this.Hs.vr.enabled=!0,this.Hs.setPixelRatio(window.devicePixelRatio),this.la=document.createElement("div"),this.la.appendChild(this.Hs.domElement),this.B.appendChild(this.la),this.da(),this.Zu.cs.U.setAttribute("crossorigin","anonymous"),this.Rs(),this.Zu.cs.paused||this.va(),this.pa=new Bu(this.Hs),this.pa.supported&&this.pa.hasVRHeadset().then((function(n){setTimeout((function(){t.Zu.fire(Ee.WEBVR_HARDWARE_AVAILABLE,t.pa.device)}),100)})).catch((function(t){}))},i.toggleVR=function(){var t=this;if(this.pa.isPresenting)this.pa.exit().then((function(){t.adjustRenderSize()})).catch((function(t){}));else{if(this.Zu.cs.paused)return;this.pa.enter().then((function(){t.adjustRenderSize()})).catch((function(t){}))}},i.onplay=function(){this.Ts&&(this.va(),this.adjustRenderSize())},i.deactivate=function(){this.la&&this.B.removeChild(this.la),this.Os(),this.Ts=!1},i.snapToCenter=function(){var t=this;this.ia.forEach((function(t){return clearTimeout(t)}));var n=((this._coordinates.long>=180?360:0)-this._coordinates.long)/11,i=(0-this._coordinates.lat)/11;this.Xs=0;for(var e=function(e){t.ia.push(setTimeout((function(){0===e&&(t.ea=!0,t.V.isMobile||(t.na=1e3/t.ta.motionRenderSpeed)),49===e&&(t.ea=!1,t.V.isMobile||(t.na=1e3/t.ta.videoFps)),t.ma(t._coordinates.lat+i/Math.pow(1.1,e),t._coordinates.long+n/Math.pow(1.1,e)),t.Zs.lat=THREE.Math.radToDeg(t.Qs.x)+t._coordinates.lat+i/Math.pow(1.1,e),t.Zs.long=THREE.Math.radToDeg(t.Qs.y)+t._coordinates.long+i/Math.pow(1.1,e)}),e*t.na))},r=0;r<50;r++)e(r)},i.isStereo=function(){return!!this.fa&&this.fa.isStereo},i.ca=function(t){t&&t[0]&&void 0!==t[0].p&&"undefined"!==t[0].y&&this.ma(t[0].p,t[0].y)},i.ma=function(t,n){this.Gs.long=this._coordinates.long,this.Gs.lat=this._coordinates.lat,t%=360,this._coordinates.lat=Math.max(-85,Math.min(85,t)),n=(n%=360)>=0?n:360+n,this._coordinates.long=n},i.makeContact=function(t){this.isUserInteracting=!0,this.ia.forEach((function(t){return clearTimeout(t)})),this.ea=!1,this.ya={x:t.x,y:t.y},this.$s.long=this._coordinates.long,this.$s.lat=this._coordinates.lat,this.wa={long:this._coordinates.long,lat:this._coordinates.lat},this.V.isMobile||(this.na=1e3/this.ta.motionRenderSpeed)},i.move=function(t){this.Zs.lat=THREE.Math.radToDeg(this.Qs.x)+this.Gs.lat,this.Zs.long=THREE.Math.radToDeg(this.Qs.y)+this.Gs.long;var n=this.wa.lat-.2*(this.ya.y-t.y),i=.2*(this.ya.x-t.x)+this.wa.long;this.ma(n,i)},i.moveWheel=function(t){this.Zs.lat=THREE.Math.radToDeg(this.Qs.x)+this.Gs.lat,this.Zs.long=THREE.Math.radToDeg(this.Qs.y)+this.Gs.long;var n=this._coordinates.lat-.1*t.y,i=this._coordinates.long+.1*t.x;this.ma(n,i)},i.moveDevice=function(t,n,i,e){this.oa=!0;var r=new THREE.Quaternion,u=window.orientation;null===u&&(u=this.U.clientWidth>this.U.clientHeight?90:0),t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0,i=i?THREE.Math.degToRad(i):0;var o=u?THREE.Math.degToRad(u):0,s=new THREE.Vector3(0,0,1),a=new THREE.Euler,c=new THREE.Quaternion,h=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));a.set(n,t,-i,"YXZ"),r.setFromEuler(a),r.multiply(h),r.multiply(c.setFromAxisAngle(s,-o)),this.Qs=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this.Xs=this.Qs.z,this.isUserInteracting||this.ea||this.ma(THREE.Math.radToDeg(this.Qs.x)-this.Zs.lat,-THREE.Math.radToDeg(this.Qs.y)+this.Zs.long),this.ra||(this.snapToCenter(),this.Zu.fire(Ee.MOTION_START),this.ra=!0)},i.releaseContact=function(t){if(this.Zs.lat=THREE.Math.radToDeg(this.Qs.x)-this._coordinates.lat,this.Zs.long=THREE.Math.radToDeg(this.Qs.y)+this._coordinates.long,this.isUserInteracting=!1,this.wa&&!t){var n=Math.hypot(this._coordinates.long-this.wa.long,this._coordinates.lat-this.wa.lat);this.ba(n)}},i.abandonMotion=function(){this.isUserInteracting=!1,this.wa=null},i.keyPress=function(t){this.V.keyboardDisabled||(this.ga()||(this.isUserInteracting=!0,this.ia&&this.ia.forEach((function(t){return clearTimeout(t)}))),this.sa[t]||(this.sa[t]=!0))},i.keyUp=function(t){this.sa[t]=!1,this.ga()||(this.isUserInteracting=!1,this.ba(1/0))},i._a=function(){var t=this;Object.keys(this.sa).forEach((function(n){if(t.sa[n])switch(n){case"up":t.ma(t._coordinates.lat+2,t._coordinates.long);break;case"down":t.ma(t._coordinates.lat-2,t._coordinates.long);break;case"left":t.ma(t._coordinates.lat,t._coordinates.long-2);break;case"right":t.ma(t._coordinates.lat,t._coordinates.long+2)}}))},i.ga=function(){var t=this;return Object.keys(this.sa).map((function(n){return t.sa[n]})).some((function(t){return t}))},i.ba=function(t){var n=this;t>=20&&function(){var i={long:n._coordinates.long-n.Gs.long,lat:n._coordinates.lat-n.Gs.lat};t===1/0&&(i.long/=2,i.lat/=2);for(var e=function(t){n.ia.push(setTimeout((function(){1===t&&(n.ea=!0),49===t&&(n.ea=!1,n.na=1e3/n.ta.videoFps);var e=2/Math.pow(t,1.5);n.Zs.lat=THREE.Math.radToDeg(n.Qs.x)+n._coordinates.lat+i.lat,n.Zs.long=THREE.Math.radToDeg(n.Qs.y)+n._coordinates.long+i.long,n.ma(n._coordinates.lat+i.lat*e,n._coordinates.long+i.long*e)}),t*n.na))},r=1;r<50;r++)e(r)}()},i.onseeked=function(){this.Ts&&this.Ea()},i.onresize=function(){this.adjustRenderSize(),this.isUserInteracting=!1},i.Ea=function(){if(!this.isVRPresenting){this.zs=THREE.Math.degToRad(90+this._coordinates.lat),this.Ks=THREE.Math.degToRad(this._coordinates.long),this.Bs.position.set(Math.sin(this.zs)*Math.cos(this.Ks),Math.cos(this.zs),Math.sin(this.zs)*Math.sin(this.Ks)),this.Bs.lookAt(this.Bs.target),this.Bs.rotation.z+=this.Xs;var t=this.cameraProps;this.Zu.fire(Ee.CAMERA_UPDATE,t),this.Ys.yaw===t.yaw&&this.Ys.pitch===t.pitch&&this.Ys.roll===t.roll&&this.Ys.fov===t.fov||(this.Ys=t,this.Zu.fire(Ee.CAMERA_CHANGE,t))}this.Hs.render(this.Vs,this.Bs)},i.adjustRenderSize=function(){if(this.isVRPresenting)this.Bs.aspect=this.U.clientWidth/this.U.clientHeight,this.Bs.updateProjectionMatrix(),this.Hs.setSize(this.U.clientWidth,this.U.clientHeight);else{this.U.clientWidth>this.U.clientHeight?this.Bs.aspect=Math.max(1,Math.min(2,this.U.clientWidth/this.U.clientHeight)):this.Bs.aspect=Math.max(1/3,Math.min(3,this.U.clientWidth/this.U.clientHeight)),this.Bs.updateProjectionMatrix();var t=or(this.U.clientWidth,this.U.clientHeight,this.Bs.aspect,1);this.Hs.setSize(t.width,t.height),this.la.style.paddingTop="".concat(t.top,"px")}},i.Rs=function(){var t=this;this.Hs.setAnimationLoop((function(){t.ga()&&t._a(),t.Ea()}))},i.Os=function(){this.Hs.setAnimationLoop(null)},i.va=function(){this.ka({backgroundColor:"#000",display:"block"})},i.da=function(){this.ka({backgroundColor:"#000",display:"none"})},i.ka=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.backgroundColor,i=t.display;this.la.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:".concat(n,";width:100%;height:100%;text-align:center;display:").concat(i)},N(n,[{key:"currentCoordinates",get:function(){return this._coordinates},set:function(t){var n=$(t,2),i=n[0],e=n[1];if(i>90||i<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(e<0||e>360)throw new RangeError("Longitude should be a float between 0 and 360.");this.ma(i,e),this.Ea()}},{key:"cameraProps",get:function(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}},set:function(t){t=F(F({},this.cameraProps),t),this.fieldOfView=t.fov,this.roll=t.roll,this.currentCoordinates=[t.pitch,t.yaw]}},{key:"roll",get:function(){return 180*this.Xs/Math.PI},set:function(t){if(t<-180||t>180)throw new RangeError("Roll should be a float between -180 and 180.");this.Xs=THREE.Math.degToRad(t)}},{key:"isVRPresenting",get:function(){return this.pa&&this.pa.isPresenting}},{key:"fieldOfView",get:function(){return this.Bs?this.Bs.fov:this.V.fieldOfView},set:function(t){this.Bs.fov=t,this.Bs.updateProjectionMatrix(),this.Hs.render(this.Vs,this.Bs)}},{key:"hasVRHeadset",get:function(){return this.pa&&!!this.pa.device}}]),n}(gu),qu=function(t){function n(n){var i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(i=t.call(this,n,e)||this).connected=!1,i.Ta=null,i.Sa=null,i.Aa=null,i.Ra=null,i.Oa=null,i}U(n,t),N(n,null,[{key:"displayName",get:function(){return"AmbisonicEffect"}},{key:"supported",get:function(){return void 0!==window.AudioContext}},{key:"supportedScanners",get:function(){return[kr,Jr]}}]);var i=n.prototype;return i.activate=function(){var t=this;return this.Ta=new AudioContext,new vi((function(n,i){if("undefined"==typeof ambisonics){var e=document.createElement("script");e.src=t.V.ambisonicsUrl,document.body.appendChild(e),e.onload=function(){return n()},e.onerror=function(){return i()}}else n()})).then((function(){return t.toggleAmbisonics()})).catch((function(){t.Zu.cs.fire(Ee.AMBISONIC_UNSUPPORTED)}))},i.deactivate=function(){this.Ma(!0)},i.toggleAmbisonics=function(){var t,n;(null!==(t=null==(n=this.Zu.getCurrentStream("audio"))?void 0:n.ambisonic_order)&&void 0!==t?t:0)<1?this.Ma():this.ja()},i.ja=function(){var t,n;if(this.Ta){var i=null!==(t=null==(n=this.Zu.getCurrentStream("audio"))?void 0:n.ambisonic_order)&&void 0!==t?t:0;if(!(this.connected||i<1)){var e=this.Zu.cs.U;this.Sa=this.Ta.createMediaElementSource(e),this.Aa=new ambisonics.sceneMirror(this.Ta,i),this.Ra=new ambisonics.sceneRotator(this.Ta,i),this.Oa=new ambisonics.binDecoder(this.Ta,i),this.Sa.connect(this.Aa.in),this.Aa.out.connect(this.Ra.in),this.Ra.out.connect(this.Oa.in),this.Oa.out.connect(this.Ta.destination),this.Aa.mirror(1),this.connected=!0}}},i.Ma=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.Sa&&this.Sa.disconnect(),t&&this.Ta&&(this.Ta.close(),this.Ta=null),this.Sa=null,this.Aa=null,this.Ra=null,this.Oa=null,this.connected=!1},i.updateRotation=function(t,n,i){this.Ra&&(this.Ra.yaw!==t||this.Ra.pitch!==n||this.Ra.roll!==i)&&(this.Ra.yaw=t,this.Ra.pitch=n,this.Ra.roll=i,this.Ra.updateRotMtx())},n}(gu),Wu={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},Gu={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"};function $u(t){return"symbol"==x(t)||Lt(t)&&"[object Symbol]"==ht(t)}var Yu=/^\s+|\s+$/g,zu=/^[-+]0x[0-9a-f]+$/i,Ku=/^0b[01]+$/i,Xu=/^0o[0-7]+$/i,Ju=parseInt;function Qu(t){if("number"==typeof t)return t;if($u(t))return NaN;if(ft(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=ft(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Yu,"");var i=Ku.test(t);return i||Xu.test(t)?Ju(t.slice(2),i?2:8):zu.test(t)?NaN:+t}var Zu=et?et.prototype:void 0,to=Zu?Zu.toString:void 0;function no(t){if("string"==typeof t)return t;if(qt(t))return function(t,n){for(var i=-1,e=null==t?0:t.length,r=Array(e);++i<e;)r[i]=n(t[i],i,t);return r}(t,no)+"";if($u(t))return to?to.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function io(t){return null==t?"":no(t)}var eo=it.isFinite,ro=Math.min,uo=function(t){var n=Math.round;return function(t,i){if(t=Qu(t),(i=null==i?0:ro(function(t){var n=function(t){return t?(t=Qu(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}(t),i=n%1;return n==n?i?n-i:n:0}(i),292))&&eo(t)){var e=(io(t)+"e").split("e");return+((e=(io(n(e[0]+"e"+(+e[1]+i)))+"e").split("e"))[0]+"e"+(+e[1]-i))}return n(t)}}();function oo(t){return!isNaN(t)}function so(t){return uo(t,3)}var ao=0;function co(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"b",n=++ao;return"".concat(t).concat(n)}co(),co();var ho=co(),fo=co(),lo=co(),vo=co(),po=co(),mo=co(),yo=co(),wo=co(),bo=co(),go=co(),_o=co(),Eo=co(),ko=co(),To=co(),So=co(),Ao=co(),Ro=co(),Oo=Object.freeze({__proto__:null,CONFIG_CHANGED:mo,TELECINE_READY:yo,TELECINE_VIDEO_INIT:wo,PLAY_INITIATED:bo,QUALITY_CHANGED:go,FORCED_QUALITY:_o,CUE_CHANGED:Eo,CAPTIONS_CHANGED:ko,SPATIAL_PLAYBACK_TOGGLED:To,PICTURE_IN_PICTURE_AVAILABLE_SAFARI:So,HLS_QUALITY_CHANGED:Ao,AUDIO_TRACK_CHANGED:Ro}),Mo=Object.freeze({__proto__:null,EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror",SETTINGS_UPDATED:"livesettingsupdated",LOW_LATENCY_FALLBACK:"lowlatencyfallback",LIVE_STATS_SUCCESS:"livestatssuccess",LIVE_STATS_FAILURE:"livestatsfailure"}),jo=(F(F(F(F(F(F(F(F(F({},ye),ge),_e),Mo),Ee),we),ke),Te),Oo),F(F({},_e),Mo));function Co(t){var n;return"done"===(null==t||null==(n=t.archive)?void 0:n.status)}function Io(t){return"pending"===(null==t?void 0:t.status)}function xo(t){return"started"===(null==t?void 0:t.status)}function Do(t){return"ended"===(null==t?void 0:t.status)}function No(t){return Po(t,"/playlist/refresh")}function Po(t,n){var i,e=null==(i=t.request.files.hls)?void 0:i.default_cdn,r=t.request,u=r.signature,o=r.timestamp,s=r.expires,a="https://".concat(t.player_url,"/live/").concat(t.video.id),c="?signature=".concat(u,"&time=").concat(o,"&expires=").concat(s,"&cdn=").concat(e);return"".concat(a).concat(n).concat(c)}var Lo=Object.prototype.hasOwnProperty;function Fo(t){if(null==t)return!0;if(vn(t)&&(qt(t)||"string"==typeof t||"function"==typeof t.splice||Yt(t)||un(t)||Vt(t)))return!t.length;var n=Wn(t);if("[object Map]"==n||"[object Set]"==n)return!t.size;if(cn(t))return!dn(t).length;for(var i in t)if(Lo.call(t,i))return!1;return!0}function Uo(t){var n=this,i={},e={get attributes(){return Object.assign({},n)},get previousAttributes(){return i},clear:function(){r();var t=n.attributes;for(var i in t)delete n[i]},set:function(t){for(var i in r(),t=si(t))n[i]=t[i]},clone:function(){return new Uo(n.attributes)},toJSON:function(){return si(n.attributes)}};function r(){Fo(n.attributes)||(i=si(n.attributes))}return e.set(t),hi(n,e)}function Ho(t,n){var i=new Uo(pe(t,n)),e=!1;return fi(i,{reset:function(t){return i.clear(),function(t){e=!0,i.set(t),pe(i,n)}(t),i},isNewVideo:function(){var t=i.previousAttributes;return!e||t.video.id!==i.video.id||t.video.version.current!==i.video.version.current||t.video.live_event&&!Co(t.video.live_event)&&(!i.video.live_event||Co(i.video.live_event))}})}var Bo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vo=/^\w*$/;function qo(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var i=function i(){var e=arguments,r=n?n.apply(this,e):e[0],u=i.cache;if(u.has(r))return u.get(r);var o=t.apply(this,e);return i.cache=u.set(r,o)||u,o};return i.cache=new(qo.Cache||jt),i}qo.Cache=jt;var Wo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Go=/\\(\\)?/g,$o=function(t){var n=qo((function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Wo,(function(t,i,e,r){n.push(e?r.replace(Go,"$1"):i||t)})),n}),(function(t){return 500===i.size&&i.clear(),t})),i=n.cache;return n}();function Yo(t){if("string"==typeof t||$u(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}function zo(t,n,i){var e=null==t?void 0:function(t,n){for(var i=0,e=(n=function(t,n){return qt(t)?t:function(t,n){if(qt(t))return!1;var i=x(t);return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!$u(t))||Vo.test(t)||!Bo.test(t)||null!=n&&t in Object(n)}(t,n)?[t]:$o(io(t))}(n,t)).length;null!=t&&i<e;)t=t[Yo(n[i++])];return i&&i==e?t:void 0}(t,n);return void 0===e?i:e}function Ko(t,n,i){return void 0===i&&(i=n,n=void 0),void 0!==i&&(i=(i=Qu(i))==i?i:0),void 0!==n&&(n=(n=Qu(n))==n?n:0),function(t,n,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==n&&(t=t>=n?t:n)),t}(Qu(t),n,i)}function Xo(t){return t.quality||t.metadata.quality}function Jo(t,n){t.request.flags.multiple_audio||(n=null);var i=t.request.files,e=is(i),r=as(t),u=t.request.cookie.quality||r||function(t){var n=is(t.request.files),i=n.some(os);Ge.mobileAndroid&&(i=!1);var e="720p";if(i){var r=n.map(Xo);-1!==r.indexOf("1080p")&&-1===r.indexOf("720p")&&(e="1080p")}return t.request.cookie.hd||t.video.default_to_hd?e:"360p"}(t),o=function(t){var n=t.files,i=void 0===n?[]:n,e=t.preference,r=void 0===e?"360p":e,u=t.priorityOffset,o=void 0===u?0:u;(i=Me(i)).sort(hs());var s=i.map(Xo);if(r){-1===s.indexOf(r)&&(s.push(r),s.sort((function(t,n){return ss(n)-ss(t)})));var a=s.indexOf(r),c=s.splice(0,a);c.reverse(),s.push.apply(s,Y(c))}return i.map((function(t){return{id:t.id,src:t.url,mime:t.mime,priority:s.indexOf(t.quality)+1+o,metadata:{profile:t.profile,cdn:t.cdn,origin:t.origin,quality:t.quality,fps:t.fps}}}))}({files:e,preference:u,priorityOffset:3});return i.hls&&(o=o.concat(ts(t,!1,n)),t.request.drm&&Ge.browser.safari)||i.dash&&(o=o.concat(ns(t,!1,n))),o}function Qo(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=t.url;if("avc_url"in t&&(e=t.avc_url),i)return e;var r=Ge.hevc&&(!n||Ge.spatialHEVC),u=Ge.hdr&&Ge.hevcMain10&&(!n||Ge.spatialHEVC),o=Ge.dolbyVision;return o&&"hevc_dvh1_url"in t?e=t.hevc_dvh1_url:u&&"hevc_hdr_url"in t?e=t.hevc_hdr_url:r&&"hevc_sdr_url"in t?e=t.hevc_sdr_url:Ge.av1&&"av1_url"in t&&(e=t.av1_url),e}function Zo(t){return t.fallback_url}function ts(t){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.request.files,u=r.hls.default_cdn,o=t.request.drm,s=r.hls.cdns[u],a=null==s||null==(n=s.alternatives)?void 0:n[e],c=a||s,h=i?Zo(c):Qo(c,t.video.spatial,o);return{id:"hls-".concat(u,"-").concat(t.video.id),src:h,mime:Wu.hls,priority:3,metadata:{cdn:u,origin:r.hls.cdns[u].origin,quality:"sd"}}}function ns(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=t.request.files;return Fo(e.dash)?[]:Object.keys(e.dash.cdns).map((function(r){var u,o=e.dash.cdns[r],s=(null==o||null==(u=o.alternatives)?void 0:u[i])||o,a=n?Zo(s):Qo(s,t.video.spatial);return{id:"dash-".concat(r,"-").concat(t.video.id),src:a,mime:t.request.drm?Wu.dashMpd:Wu.dash,priority:r===e.dash.default_cdn?1:2,metadata:{cdn:r,origin:e.dash.cdns[r].origin,quality:"sd"}}}))}function is(t){if(Fo(t.progressive))return[];var n=t.progressive;return"progressive_avc"in t&&(n=t.progressive_avc),n.filter(rs(n))}function es(t){if("number"==typeof t)return t;var n=t.split("-");return 5===n.length?n[0]:parseInt(n[0],10)}function rs(t){var n=t.filter(us).map(Xo);return function(t){return-1===n.indexOf(Xo(t))||us(t)}}function us(t){var n=t.fps;return"metadata"in t&&(n=t.metadata.fps),n>30}function os(t){return ss(t)>=720}function ss(t){return"string"!=typeof t&&(t=Xo(t)),parseInt(t,10)}function as(t){var n=is(t.request.files).map((function(t){return t.quality}));return cs(t,t.embed.quality,n)}function cs(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.embed.on_site||Ge.android||Ge.iOS||Ge.windowsPhone||!n||i.length&&-1===i.indexOf(n)?null:n}function hs(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc";return function(n,i){var e=ss(n),r=fs(n),u=ss(i),o=fs(i);return"asc"===t?e-u||r-o:u-e||o-r}}function fs(t){return"object"!==x(t)?0:"fps"in t?t.fps:"metadata"in t&&"fps"in t.metadata?t.metadata.fps:0}function ls(t){var n=t.video.live_event,i=t.request.files;if(!Fo(i.hls)){var e,r=i.hls.default_cdn,u=i.hls.cdns[r].json_url||(null==(e=n.playback)?void 0:e.hls_noredirect),o=t.request.flags.live_dash?2:1;return{id:"hls-".concat(r,"-").concat(t.video.id),src:u,mime:Wu.hlsLive,priority:o,metadata:{cdn:r,origin:i.hls.cdns[r].origin,quality:"sd"}}}return null}function ds(t,n){var i=[];if(n.video){var e=n.video.currentFile.mime;if(e===Wu.hlsLive)return n.manifest.video.map((function(t){return F(F({},t),{},{quality:"".concat(t.height,"p")})}));if([Wu.dash,Wu.dashMpd].includes(e)){var r=n.video.drmHandler&&"sd-fallback"===n.video.drmHandler.state;i=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return[];var e=t.streams;"streams_avc"in t&&(e=t.streams_avc);var r=n?Ge.spatialHEVC&&Ge.hevc:Ge.hevc,u=n?Ge.spatialHEVC&&Ge.hdr:Ge.hdr,o=Ge.dolbyVision;return o&&"streams_hevc_dvh1"in t?e=t.streams_hevc_dvh1:u&&"streams_hevc_hdr"in t?e=t.streams_hevc_hdr:r&&"streams_hevc_sdr"in t?e=t.streams_hevc_sdr:Ge.av1&&"streams_av1"in t&&(e=t.streams_av1),i&&"streams_fallback"in t&&(e=t.streams_fallback),e}(t.request.files.dash,t.video.spatial,r)}else i=n.video.files.filter((function(t){return"progressive"===Gu[t.mime]}))}return i.filter(rs(i)).sort(hs())}function vs(t){var n=Xo(t),i={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(var e in i)n=n.replace(e,i[e]);return n}function ps(t){return Ge.spatialPlayback&&t.video.spatial?35:75}function ms(t){return t.request.text_tracks.map((function(t){return{id:t.id,src:t.url,kind:t.kind,label:t.label,language:t.lang}}))}var ys={captureException:function(t){},captureMessage:function(t){},captureBreadcrumb:function(){}},ws=ys,bs=function(t){ws=Object.assign({},ys,t)},gs=function(t,n){return ws.captureException(t,n)},_s=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"backbone",e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return ws.captureBreadcrumb(t,n,i,e)};function Es(t,n,i){var e=!0===Ge.iOS,r=t.embed.playsinline&&(Ge.mobileAndroid||Ge.iOS>=10||e),u=!1,o=!1,s=!1,a=!0,c="auto";function h(t){var n,e,r,u,o,s,a=t.embed;i.disablePictureInPicture=!(null===(n=null!==(e=a.pip)&&void 0!==e?e:null==(r=a.settings)?void 0:r.pip)||void 0===n||n),i.autoPictureInPicture=null===(u=null!==(o=a.auto_pip)&&void 0!==o?o:null==(s=a.settings)?void 0:s.auto_pip)||void 0===u||u}function f(t){if(!a&&i.buffered&&i.buffered.length>0){t=t||i.currentTime;var e=function(t,n){var i=t.length-1;if(t.length>1)for(var e=0,r=t.length;e<r;e++)if(t.start(e)<=n&&t.end(e)>=n){i=e;break}return i}(i.buffered,t),r=i.buffered.end(e),o=r/i.duration,c=i.duration;if(n.fire(ye.PROGRESS,{loaded:r,duration:c,loadProgress:o}),s&&u&&r===i.duration)return void(u&&i.paused&&i.play().catch(gs))}}function l(n){if("auto"!==n){var e=ds(t,i).reverse().map((function(t){return t.quality})).indexOf(n);-1!==e&&(_s("Switched to ".concat(n),{},"video"),i.video.currentFile.restrictedStreamIndexes=[e])}else i.video.currentFile.restrictedStreamIndexes=[]}function d(e){var r=ds(t,i).map((function(t){return t.quality})),u=cs(t,t.embed.quality,r);u&&n.fire(_o,u),l(u||"auto")}return n.on(wo,(function(){var n;i.playsinline=r,i.muted=t.embed.muted,i.lowLatencyMode=null==(n=t.video.live_event)?void 0:n.low_latency})),n.on(fo,(function(){a=!0,i.paused||i.pause(),o=!1,u=!1,i.currentTime=0})),n.on(lo,(function(){i.paused||i.pause(),i.video=null})),i.on(ye.PLAY,(function(){a=!1,n.fire(ye.PLAY,i.currentTime)})),i.on(ye.PAUSE,(function(){u=!1,n.fire(ye.PAUSE,i.currentTime,i.ended)})),i.on(ye.PLAYING,(function(t){f()})),i.on(ye.TIME_UPDATE,(function(t){var e=i.currentTime;if(!a){var r=i.duration,u=e/r,o=i.playbackRate;n.fire(ye.TIME_UPDATE,{currentTime:e,duration:r,timeProgress:u,playbackRate:o})}})),i.on(ye.ENDED,(function(t){i.loop?i.play().catch(gs):(u=!1,n.fire(ye.ENDED,t))})),i.on(ye.LOADED_METADATA,(function(n){var e=i.duration;if(isFinite(e)&&e>0){if(e<t.video.duration-1||e>t.video.duration+1)return;t.video.duration=e}t.video.video_width=i.videoWidth,t.video.video_height=i.videoHeight})),i.on(ye.DURATION_CHANGE,(function(n){var e=i.duration;isFinite(e)&&(t.video.duration>0&&(e<t.video.duration-1||e>t.video.duration+1)||(t.video.duration=e))})),i.on(ye.PROGRESS,f),i.on(ge.BUFFER_STARTED,(function(){s=!0})),i.on(ge.BUFFER_ENDED,(function(){s=!1})),n.on(ho,(function(n,e){e||(e=(i.duration||t.video.duration)*Ko(n,0,1)),e=Ko(e,0,so(i.duration||t.video.duration)),i.currentTime=e})),i.on(ye.SEEKING,(function(){var t=i.currentTime,e=i.duration,r=t/e;n.fire(ye.SEEKING,{currentTime:t,duration:e,timeProgress:r})})),i.on(ye.SEEKED,(function(){f();var t=i.currentTime,e=i.duration,r=t/e;n.fire(ye.SEEKED,{currentTime:t,duration:e,timeProgress:r})})),i.on(ge.CURRENT_FILE_CHANGE,(function(e){_s("Current file changed",{id:e.id,mime:e.mime,src:e.src,metadata:e.metadata},"video"),e.metadata.quality,[Wu.dash,Wu.dashMpd].includes(e.mime)&&d(),[Wu.hlsLive].includes(e.mime)?i.once(ge.STREAMS_LOADED,(function(){d()})):function(i){var e=as(t);e&&n.fire(_o,e)}()})),i.on(ye.RESIZE,(function(){i.video.currentFile.mime===Wu.hls&&i.videoHeight&&n.fire(Ao,{height:i.videoHeight})})),h(t),n.on(mo,(function(t,n){var i,e;(null==n||null==(i=n.embed.settings)?void 0:i.pip)!==(null==(e=t.embed.settings)?void 0:e.pip)&&h(t)})),{play:function(){return u=!0,o||(n.fire(bo),o=!0),i.play()},pause:function(){u=!1,i.pause()},get quality(){return c},set quality(e){!function(e){var r=i.video.currentFile.mime;if([Wu.dash,Wu.dashMpd,Wu.hlsLive].includes(r))l(e);else{var u=ds(t,i).filter((function(t){return t.metadata.quality===e}));u.length>0&&(a=!0,i.video.currentFile=u[0])}c=e,n.fire(go,e)}(e)}}}function ks(t,n,i){var e=null;Ge.spatialPlayback&&(n.on(wo,(function(){e&&(i.deactivateEffect(Vu),e=null,n.fire(To,e));var r=t.video.spatial;r&&(t.request.drm||i.supportsEffect(Vu)&&(e=i.activateEffect(Vu,{threeUrl:t.request.urls.three_js,fps:t.video.fps,fieldOfView:r.fov,directorTimeline:r.director_timeline,projection:r.projection,stereoMode:r.stereo_mode,initialView:r.initial_view,isMobile:Ge.android,dimensions:t.embed.on_site?{width:1080,height:540}:{width:640,height:360},keyboardDisabled:!t.embed.keyboard}),n.fire(To,e)))})),i.on(Ee.SPATIAL_UNSUPPORTED,(function(){e&&(i.deactivateEffect(Vu),e=null,n.fire(To,e))})))}function Ts(t,n,i){var e=null;n.on(wo,(function(){e&&(i.deactivateEffect(Lu),e=null),t.video.canvas&&(t.request.drm||i.supportsEffect(Lu)&&(e=i.activateEffect(Lu)))}))}var Ss=de((function(t,n,i){fe(t,n,i)}));function As(t,n,i){return i?n?n(t):t:(t&&t.then||(t=vi.resolve(t)),n?t.then(n):t)}var Rs=function(){function t(t,n,i){ai(this),this.Ca=new bi,this.Ia=si(t),this.xa=t.session_url||t.sessionUrl,this.Da=n,this.Na=i,this.Pa=!1,this.La=!1,this.Fa()}var n=t.prototype;return n.disable=function(){this.La=!0},n.forcePolling=function(){this.isForcePolling||(this.Pa=!0,this.Fa())},n.unforcePolling=function(){this.Pa=!1},n.Fa=function(){!1!==this.Ia.polling&&(this.Ia.id&&this.Ca.resolve(),this.Ua()?this.Ha():this.Ba()&&this.Va())},n.Ba=function(){var t;return!(Do(this.Ia)&&"started"!==(null==(t=this.Ia.archive)?void 0:t.status)||!this.isForcePolling&&xo(this.Ia))},n.Ua=function(){return!this.xa||!(!Io(this.Ia)||null!==this.Ia.id)},n.qa=function(){try{var t=this;return As($i(t.Da).json(),(function(n){return t.xa=n.url,n.url}))}catch(t){return vi.reject(t)}},n.Va=function(){try{var t=this;if(t.La)return;var n,i={};return Ge.browser.ie&&(i={Pragma:"no-cache","Cache-Control":"no-cache"}),function(t,n){return t&&t.then?t.then(n):n()}(function(e,r){try{var u=As($i({url:t.xa,retry:3,retryStatus:function(t){return[410].includes(t)||Ai.retryStatus(t)},hooks:{beforeRetry:[t.Bt.bind(t)]},headers:i}).json(),(function(t){n=t}))}catch(t){return r()}return u&&u.then?u.then(void 0,r):u}(0,(function(){throw new Error("Hit max retries polling ".concat(t.xa))})),(function(i){if(n.status!==t.Ia.status){var e;if(Do(n)&&"provision_expire"===n.terminate_reason)return t.xa=null,t.Ia.id=null,void setTimeout(t.Fa.bind(t),5e3);var r=(P(e={},"active",jo.EVENT_ACTIVE),P(e,"pending",jo.EVENT_PENDING),P(e,"started",jo.EVENT_STARTED),P(e,"ended",jo.EVENT_ENDED),e)[n.status];try{t.fire(r,n)}catch(t){throw new Error("Error firing live event status change ".concat(t))}}if(n.archive&&(!t.Ia.archive||n.archive.status!==t.Ia.archive.status)){var u,o=(P(u={},"started",jo.ARCHIVE_STARTED),P(u,"done",jo.ARCHIVE_DONE),P(u,"error",jo.ARCHIVE_ERROR),u)[n.archive.status];t.fire(o,n)}t.Ia=Ss(t.Ia,n),t.Ba()&&setTimeout(t.Va.bind(t),5e3)}))}catch(t){return vi.reject(t)}},n.Bt=function(t,n){try{return As(this.qa(),(function(n){t.url=n}))}catch(t){return vi.reject(t)}},n.Ha=function(){try{var t=this;if(t.La)return;return As($i(t.Na).json(),(function(n){var i=!1;return function(e,r){var u=function(){if(null!==n.ingest.session_id)return t.Ca.resolve(),t.Ia.id=n.ingest.session_id,As(t.qa(),(function(){t.Va(),i=!0}))}();return u&&u.then?u.then(r):r(u)}(0,(function(n){if(i)return n;setTimeout(t.Ha.bind(t),5e3)}))}))}catch(t){return vi.reject(t)}},N(t,[{key:"isForcePolling",get:function(){return this.Pa}},{key:"liveEventIDReady",get:function(){return this.Ca}}]),t}();function Os(){}function Ms(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}function js(t,n,i){var e,r,u,o,s,a=Ms((function(t){return function(n,e){try{var r=function(t,n,i){try{var e=vi.resolve(t());return n?e.then(n):e}catch(t){return vi.reject(t)}}(y,(function(n){return n(i,{TelecineEvents:ge,VideoEvents:ye},t)}))}catch(t){return null}return r&&r.then?r.then(void 0,e):r}(0,(function(t){return null}))})),c=Ms((function(){var n,e=(null!==(n=t.video.ecdn)&&void 0!==n?n:{}).streamroot_key;if(e)return o=new bi,function(t,n){var r=function(){if(!u)return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;i.bufferTarget=t,i.presentationDelay=t}(),function(t,n,i){return t&&t.then||(t=vi.resolve(t)),n?t.then(n):t}(a(e),(function(t){u=t}))}();return r&&r.then?r.then(n):n()}(0,(function(){var t;null==(t=u)||t.setUp(),o.resolve()}))})),h=Ms((function(){return function(t,n){return t&&t.then?t.then(Os):vi.resolve()}({hive:function(){},kollective:function(){},streamroot:c}[t.video.ecdn.ecdn_provider]())})),f=!1,l=0,d=0;function v(){r&&(r.disable(),r=null)}function p(){o&&(o.resolve(),o=null)}function m(){i.endLive()}function y(){return yi("module/streamroot.js")}return n.on(mo,(function(){e&&!t.isNewVideo()||(e=!0,v(),p(),u&&u.stop(),t.video.live_event&&!Co(t.video.live_event)&&(function(i){(r=new Rs(i,function(t){return Po(t,"/session/refresh")}(t),function(t){return"https://".concat(t.vimeo_url,"/live_event/status?clip_id=").concat(t.video.id)}(t))).on(jo.EVENT_ENDED,m),Object.keys(jo).forEach((function(t){var i=jo[t];r.on(i,(function(t){n.fire(i,t)}))}))}(t.video.live_event),function(){l=0,d=0;var t=!1;i.once(ye.PLAYING,(function(){return t=!0}));var e=_i();clearInterval(s),s=setInterval((function(){i.paused||(l+=Ei(e)/1e3),t&&f&&(d+=Ei(e)/1e3),function(t){i.lowLatencyMode&&t>12&&i.latency>10&&f&&(n.fire(jo.LOW_LATENCY_FALLBACK,{msg:"Rebuffer ratio > 12% and latency > 10s, fallback to normal HLS w/ target latency of 12s."}),i.lowLatencyMode=!1,i.presentationDelay=12,i.bufferTarget=12)}(d/l*100),e=_i()}),500)}()),t.video.ecdn&&h())})),n.on(lo,(function(){p(),u&&(u.destroy(),u=null),v()})),i.on(jo.STREAM_ONLINE,(function(){r.isForcePolling&&r.unforcePolling()})),i.on(jo.STREAM_OFFLINE,(function(){r.isForcePolling||r.forcePolling()})),i.on(ge.BUFFER_STARTED,(function(){f=!0})),i.on(ge.BUFFER_ENDED,(function(){f=!1})),{get p2pReady(){return o}}}function Cs(t,n,i){if(i)return n?n(t()):t();try{var e=vi.resolve(t());return n?e.then(n):e}catch(t){return vi.reject(t)}}function Is(t,n){var i=t();return i&&i.then?i.then(n):n(i)}function xs(t,n){try{var i=t()}catch(t){return n(t)}return i&&i.then?i.then(void 0,n):i}function Ds(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{return vi.resolve(t.apply(this,n))}catch(t){return vi.reject(t)}}}function Ns(t,n,i){var e,r,u,o,s=Ds((function(){return xs((function(){return Cs(m,(function(n){return n(i,t)}))}),(function(t){throw gs(t),new Error("Failed to create Hive Module",t)}))})),a=Ds((function(){return xs((function(){return Cs(p,(function(t){return t(i)}))}),(function(t){return gs(t),null}))})),c=Ds((function(){return Is((function(){if(!r)return Cs(a,(function(t){r=t}))}),(function(){var n;return null==(n=r)?void 0:n.setUp(t.video.ecdn)}))})),h=Ds((function(){return xs((function(){return Is((function(){if(!u)return Cs(s,(function(t){u=t}))}),(function(){var t;return null==(t=u)?void 0:t.setUp(l)}))}),(function(t){var n;return null==(n=u)||n.stop(),null}))})),f=!1,l=!1,d=!1,v=null==(e=t.video.ecdn)?void 0:e.ecdn_provider;function p(){return yi("module/kollective.js")}function m(){return yi("module/hive.js")}function y(){r&&(r.destroy(),r=null),u&&(u.destroy(),u=null)}return n.on(mo,(function(){var n;t.isNewVideo()?y():!0!==t.preload||!1!==d||"kollective"!==v?f||("pending"!==(null==(n=t.video.live_event)?void 0:n.status)?(f=!0,y(),v&&(o={hive:h,kollective:c,streamroot:function(){}}[v]())):l=!0):d=!0})),n.on(lo,y),{get p2pReady(){return o}}}function Ps(t,n,i){var e=null;function r(){i.deactivateEffect(qu),e=null}n.on(bo,(function(){var n;e&&r(),(null==(n=t.video.channel_layout)?void 0:n.startsWith("ambisonic"))&&i.supportsEffect(qu)&&(e=i.activateEffect(qu,{ambisonicsUrl:t.request.urls.ambisonics_js}))})),i.on(Ee.CAMERA_UPDATE,(function(t){var n=t.yaw,i=t.pitch,r=t.roll;e&&e.updateRotation(n,i,r)})),i.on(Ee.AMBISONIC_UNSUPPORTED,(function(){e&&r()})),i.on(ge.STREAM_CHANGE,(function(){e&&e.toggleAmbisonics()}))}function Ls(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||"null"===t||0===n.length)return{track:null};var i=t.split("."),e=$(i,2),r=e[0],u=e[1],o=r.split(/[-_]/),s=$(o,1),a=s[0],c=r!==a,h=n.filter((function(t){return c&&t.language===r||t.language===a})).sort((function(t,n){var i=2*(t.language===a&&t.kind===u)+2*(t.language===r)+1*(t.kind===u);return 2*(n.language===a&&n.kind===u)+2*(n.language===r)+1*(n.kind===u)-i}));return h.length>0?{track:h[0],exactMatch:h[0].language===r&&h[0].kind===u}:{track:null}}function Fs(t){var n=t.split(/\n/g),i=[],e=[];return n.forEach((function(t){var n=t.match(/<[a-zA-Z]+ ?.*?>/g)||[],r=t.match(/<\/[a-zA-Z]+ ?.*?>/g)||[],u=e.map((function(t){return t.startTag}));e=[],(n=u.concat(n)).forEach((function(t){var n=$(t.replace(/<|>/g,"").split(" "),1)[0],i=r.indexOf("</".concat(n,">"));-1!==i?r.splice(i,1):e.push({startTag:t,closeTag:"</".concat(n,">")})}));var o=e.map((function(t){return t.closeTag})).reverse().join(""),s=u.join(""),a="".concat(s).concat(t).concat(o);i.push(a)})),i.join("<br>")}function Us(t){return t?t.split(/\n/g).join("↵"):t}function Hs(t,n,i,e){var r;function u(){return n.pictureInPictureActive?"showing":"hidden"}function o(){if(0!==n.video.textTracks.length){if(n.video.textTracks.forEach((function(t){t.on("cuechange",s),t.on("modechange",a)})),n.video.textTracks.language&&$(n.video.textTracks.language.split(/[-_]/),1)[0]!=$(n.video.textTracks.language.split(/[-_]/),1)[0]){var i="".concat(n.video.textTracks.language,".subtitles");if(Ls(i,n.video.textTracks).track)return void t.fire(vo,i)}t.fire(po)}else t.fire(po)}function s(n){for(var i,e=n.target,r=e.activeCues,u=[],o=0,s=r.length;o<s;o++)""!==r[o].text.replace(/^\s+|\s+$/gm,"")&&((i=document.createElement("span")).appendChild(r[o].getCueAsHTML()),u.push({html:Fs(i.innerHTML),text:Us(r[o].text)}));t.fire(Eo,e,u)}function a(n){var e=n.target,r=i.querySelector("video");Ge.iOS&&function(t){var n=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((function(t){return void 0!==t}));return void 0!==n?!!n:t.webkitDisplayingFullscreen}(r)&&"showing"===e.mode&&t.fire(ko,e)}t.on(wo,o),t.on(vo,(function(i){if(!r||r.id!==i){var e=n.video.textTracks.getTrackById(i),o=!0;if(!e){var s=Ls(i,n.video.textTracks);e=s.track,o=s.exactMatch}e!==r&&setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode=t===e?u():"disabled"})),t.fire(ko,e,!o),r=e}),0)}})),t.on(po,(function(){setTimeout((function(){n.video&&n.video.textTracks.forEach((function(t){t.mode="disabled"})),t.fire(Eo),r&&(r=null,t.fire(ko,null))}),0)})),t.on(ge.TEXT_TRACKS_AVAILABLE,o),t.on([ye.ENTER_PICTURE_IN_PICTURE,ye.LEAVE_PICTURE_IN_PICTURE],(function(){!function(t){r&&r.mode!==t&&(r.mode=t)}(u())}))}function Bs(t,n){return t.map((function(t){return F(F({},t),{},{enabled:t.id===n})}))}function Vs(t){return t.find((function(t){return t.enabled}))}function qs(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(null==t?void 0:t.length))return[];var i=n.language,e=n.kind,r=null==n?void 0:n.id;if(r)return Bs(t,r);if(e&&i){var u=t.find((function(t){return t.language===i&&t.kind===e}));if(r=null==u?void 0:u.id)return Bs(t,r)}if(i){var o=t.find((function(t){return t.language===i}));if(r=null==o?void 0:o.id)return Bs(t,r)}var s=t.find((function(t){return"main"===t.kind}));return Bs(t,r=null==s?void 0:s.id)}function Ws(t,n,i){var e,r,u,o,s,a;function c(){var n,i=t.video.live_event;if(Io(i)||function(t){return"active"===(null==t?void 0:t.status)}(i)||Do(i)&&!Co(i))e.video=null;else if(!xo(i)||!e.video||t.isNewVideo()){var r=function(t){return qs(t.request.audio_tracks,{language:t.request.cookie.audio_language,kind:t.request.cookie.audio_kind})}(t),u=null==(n=Vs(r))?void 0:n.id,o=xo(i)?function(t){var n=[],i=ls(t);i&&n.push(i);var e=function(t){var n,i=t.video.live_event,e=t.request.files;if(Fo(e.dash))return null;var r=e.dash.default_cdn,u=e.dash.cdns[r].url||(null==(n=i.playback)?void 0:n.dash_noredirect),o=t.request.flags.live_dash?2:1;return{id:"dash-".concat(r,"-").concat(t.video.id),src:u,mime:Wu.dashMpd,priority:o,metadata:{cdn:r,origin:e.dash.cdns[r].origin,quality:"sd"}}}(t);return e&&n.push(e),n}(t):Jo(t,u),a=ms(t);!e.video||t.isNewVideo()||s?f({files:o,textTracks:a,audioTracks:r,switchingVideo:!1}):h(o,a)}}function h(t,n){t.forEach((function(t){var n=e.video.files.getFileById(t.id);n&&n.src!==t.src&&(n.src=t.src)})),n.forEach((function(t){var n=e.video.textTracks.getTrackById(t.id);n&&n.src!==t.src&&(n.src=t.src)}))}function f(r){var s,c,h,f=r.files,l=r.textTracks,d=r.audioTracks,v=void 0===d?[]:d,p=r.switchingVideo,m=void 0!==p&&p,y=t.video.live_event,w=i.getBoundingClientRect(),b=xo(y)?ls(t):function(t){var n=t.request.files;if(!Fo(n.hls)){var i=n.hls.default_cdn,e=n.hls.cdns[i],r=e.captions||e.url;return r?{src:r,mime:Wu.hls,metadata:{cdn:i,origin:e.origin,quality:"sd"}}:null}return null}(t);a||(a=(null==(h=e.played)?void 0:h.length)>0);var g=!e.paused||(null==(s=e.ms)?void 0:s.Bo);e.it=m,e.video={id:t.video.id,title:t.video.title,subtitle:"from ".concat(t.video.owner.name),files:f,textTracks:l,audioTracks:v,chapters:zo(t,"embed.chapters",[]),duration:t.video.duration,externalDisplayFiles:{AirPlay:b},metadata:{playlistRefreshUrl:No(t),thumbnail:t.video.thumbs[640],useHls:t.request.drm&&Ge.browser.safari,drm:t.request.drm,p2pReady:t.video.ecdn&&(null!==(c=u.p2pReady)&&void 0!==c?c:o.p2pReady),percentShown:Vu.frustumSurfaceArea(t.video.spatial.fov,w.width,w.height)}},m?e.checkRebuffer(a,g):n.fire(wo)}return function(){var n;e=new Pu(i,[Jr,pu,bu,kr],{externalDisplays:[AirPlayExternalDisplay],mediaSourceScanner:{droppedFrameSwitchPercent:ps(t)},tests:t.request.ab_tests,fileCodecs:t.request.file_codecs,bufferTarget:t.video.buffer_target,presentationDelay:t.video.presentation_delay,lowLatencyMode:null==(n=t.video.live_event)?void 0:n.low_latency,sessionMetadata:{clipId:t.video.id,sessionId:t.request.session}})}(),Object.values(ye).filter((function(t){return![ye.TIME_UPDATE,ye.PROGRESS,ye.SUSPEND,ye.ERROR].includes(t)})).forEach((function(t){e.on(t,(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";_s(t,n,"video event")}))})),e.on(ge.STREAMS_LOADED,(function(n){n.video.forEach((function(n){var i=function(t,n){return n.find((function(n){return es(n.id)===String(t)||es(n.id)===es(t)}))}(n.id,ds(t,e));i?(n.profile=i.profile,n.quality=i.quality,n.fps=i.fps):(n.profile=null,n.quality="".concat(n.height,"p"),n.fps=n.framerate)}))})),e.on(ge.STREAM_CHANGE,(function(t){var i=t.index,e=t.streams,r=t.metadata,u=e[i];_s("Stream changed",u,"video"),n.fire(ge.STREAM_CHANGE,u,i,e,r)})),e.on(ge.STREAM_TARGET_CHANGE,(function(t){var i=t.index,e=t.streams,r=e[i];n.fire(ge.STREAM_TARGET_CHANGE,r,i,e)})),e.on(ge.DRM_KEY_SWITCH,(function(){if(t.request.drm.fallback_asset){var n=ms(t);h(function(t){var n=t.request.files,i=[],e=t.request.drm&&Ge.browser.safari;return(n.hls&&(Ge.iPhone||Ge.iPad)||e)&&(i=i.concat(ts(t,!0))),n.dash&&!e&&(i=i.concat(ns(t,!0))),i}(t),n)}})),function(t,n,i){i.forEach((function(i){t(i,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.apply(void 0,[i].concat(e))}))}))}(e.on,n.fire,[we.ACTIVATED,we.AVAILABLE,we.DEACTIVATED,we.UNAVAILABLE,_e.STREAM_OFFLINE,_e.STREAM_ONLINE,_e.BUFFER_GAP_JUMP,_e.BUFFER_GAP_JUMP_PREVENT,_e.STALL_JUMP,ke.MEDIASESSION_PAUSE,ke.MEDIASESSION_PLAY,ke.MEDIASESSION_SEEK_BACKWARD,ke.MEDIASESSION_SEEK_FORWARD,ge.AV_DURATION_MISMATCH,ge.BANDWIDTH,ge.BUFFER_ENDED,ge.BUFFER_OCCUPANCY,ge.BUFFER_STARTED,ge.CHAPTER_CUES_UPDATED,ge.CUE_POINT,ge.CURRENT_FILE_CHANGE,ge.DOWNLOAD_END,ge.DOWNLOAD_TIMEOUT,ge.DRM_AUTH_SUCCESS,ge.DRM_KEY_SWITCH,ge.DROPPED_FRAMES,ge.MANIFEST_LOADED,ge.MANIFEST_TIMEOUT,ge.QUOTA_EXCEEDED_ERROR,ge.SCANNER_CHANGE,ge.STREAM_CHANGE_START,ge.STREAM_BUFFER_END,ge.STREAM_BUFFER_START,ge.TEXT_TRACKS_AVAILABLE,ge.DROPPED_FRAME_PERCENT_EXCEEDED,Ee.CAMERA_UPDATE,Ee.CAMERA_CHANGE,Ee.MOTION_END,Ee.MOTION_START,Ee.SPATIAL_UNSUPPORTED,Ee.WEBVR_ENTER,Ee.WEBVR_EXIT,Ee.WEBVR_HARDWARE_AVAILABLE,Te.BRAIN_ML_SWITCH_TO_SKYFIRE,Te.BRAIN_ML_MODEL_INPUTS,ye.DURATION_CHANGE,ye.ERROR,ye.LOAD_START,ye.LOADED_DATA,ye.LOADED_METADATA,ye.PLAYING,ye.RATE_CHANGE,ye.RESIZE,ye.STALLED,ye.VOLUME_CHANGE,ye.WAITING,ye.ENTER_PICTURE_IN_PICTURE,ye.LEAVE_PICTURE_IN_PICTURE,ye.WEBKIT_BEGIN_FULLSCREEN,ye.WEBKIT_END_FULLSCREEN]),n.fire(yo),new Hs(n,e,i,t),new ks(t,n,e),new Ts(t,n,e),new Ps(t,n,e),u=new js(t,n,e),r=new Es(t,n,e),o=new Ns(t,n,e),n.on(mo,c),n.on(Ro,(function(n){var i,r=e.currentTime,u=qs(t.request.audio_tracks,n),o=null==(i=Vs(u))?void 0:i.id;f({files:Jo(t,o),textTracks:e.video.textTracks,audioTracks:u,switchingVideo:!0}),e.currentTime=r})),Ge.browser.safari&&window.addEventListener("pageshow",(function(t){t.persisted&&(s=!0,c())})),li({telecine:e},r)}function Gs(t,n,i){this.constructorName="BackboneError",this.message=t,this.name=n,this.source=i}Gs.prototype=new Error;var $s={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbs:{},version:{}},user:{}};function Ys(t,n){var i,e,r,u=ai(),o=null,s=new Ho(n,$s);function a(t,n){return u.fire(mo,t,n),t}var c={play:function(){return e.play()},pause:function(){return e.pause()},get currentTime(){return r.currentTime>.1?so(r.currentTime):0},set currentTime(t){if(t=parseFloat(t),isNaN(t)||t<0)throw new Gs("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");u.fire(ho,null,t)},get duration(){return so(s.video.duration)},get enabledTextTrack(){return o},loadVideo:function(t){var n=si(s);return s.reset(t),s=a(s,n),this},reactivate:function(){var t;return(null==(t=r)?void 0:t.reactivate)&&r.reactivate(),this},unload:function(){return u.fire(fo),this},destroy:function(){return u.fire(lo),this},on:function(t,n){return u.on(t,n),this},once:function(t,n){return u.once(t,n),this},off:function(t,n){return u.off(t,n),this},hasTextTrack:function(t){var n,i,e=this.textTracks;if(oo(t))i=e.getTrackById(t);else{var r=t.split(".")[0];n=e.some((function(t){return t.language.toLowerCase()===r.toLowerCase()}))}return!(!i&&!n)},enableTextTrack:function(t){var n,i,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.textTracks;if(oo(t))o=s.getTrackById(t);else{var a=t.split("."),c=$(a,2);n=c[0];var h=c[1];if(i=void 0===h?e:h,!this.hasTextTrack(t))throw new Gs("There are no tracks for “".concat(n.toUpperCase(),"”."),"InvalidTrackLanguageError","enableTextTrack");var f=i?"".concat(n,".").concat(i):n;o=Ls(f,s).track}if(!o||i&&o.kind!==i)throw new Gs("There are no ".concat(i," tracks for “").concat(n.toUpperCase(),"”."),"InvalidTrackError","enableTextTrack");r.ks(!0),u.fire(vo,o.id)},disableTextTrack:function(){o=null,r.ks(!1),u.fire(po)},enableAudioTrack:function(t){u.fire(Ro,t)},get qualities(){return function(t){var n,i=t.representations.map((function(n){var i=Xo(n);return{id:i,label:vs(n),active:t.quality===i}})),e=null==(n=t.video)?void 0:n.currentFile.mime;return[Wu.dash,Wu.dashMpd,Wu.hlsLive,Wu.hls].includes(e)&&i.unshift({id:"auto",label:"Auto",active:!t.quality||"auto"===t.quality}),i}(this)},get quality(){return e.quality},set quality(t){e.quality=t},get playbackRate(){return r?r.playbackRate:1},set playbackRate(t){r.playbackRate=t,r.defaultPlaybackRate=t},get textTracks(){return r.video?r.video.textTracks:[]},get representations(){return ds(s,r)},get volume(){return r?r.volume:so(s.request.cookie.volume)},set volume(t){if(t=parseFloat(t),isNaN(t)||t<0||t>1)throw new Gs("Volume should be a number between 0 and 1.","RangeError","setVolume");r.volume=t},get videoId(){return s.video.id},get videoWidth(){return r.videoWidth||s.video.width},get videoHeight(){return r.videoHeight||s.video.height},get readyState(){return r.videoElement.readyState},get telecine(){return r},get pictureInPictureEnabled(){var t=Ge.spatialPlayback&&s.video.spatial,n=Ge.browser.safari&&this.readyState<1;return n&&r.once(ye.LOADED_METADATA,(function(){return u.fire(So)})),!n&&!t&&r.pictureInPictureEnabled},get audioTracks(){var t,n;return(null==(t=r)||null==(n=t.video)?void 0:n.audioTracks)||[]}};return s=a(s),e=new Ws(s,u,t),r=e.telecine,i=Object.create(r),qs(s.request.audio_tracks,{language:s.request.cookie.audio_language,kind:s.request.cookie.audio_kind}),li(i,c)}var zs={};function Ks(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null==(t=zs.en)?void 0:t[n])&&(n=zs.en[n]),Object.keys(i).forEach((function(t){n=n.replace(new RegExp("{".concat(t,"}"),"g"),i[t])})),n.match(/\{\w+}/))throw new Error("Missing token definition.");return n}function Xs(t){return function(t){return/^(https?:)?\/\/(.+)\.(vimeo(ws)?|vimeo-(enterprise|work))\.(com|dev|work)(?=$|\/)/.test(t)}(t)?function(t){try{return new URL(t).origin}catch(t){}var n=document.createElement("a");return n.href=t,n.origin?n.origin:"".concat(n.protocol.replace(":",""),"://").concat(n.host)}(t):""}function Js(t,n,i){if(function(t){return/^(https?:)?\/\/(.+)\.(vimeo(ws)?|vimeo-(enterprise|work))\.(com|dev|work)\/video\/\d+\/config(?=$|\?)/.test(t)}(n))return n;var e=function(t){if(function(t){return!isNaN(t)&&parseInt(Number(t),10)==t&&!isNaN(parseInt(t,10))}(t))return parseInt(t,10);var n=t.match(/(video|\.com|\.dev)\/(\d+)/);if(!n||n.length<3)throw new Error("Please provide a Vimeo URL with a valid clip id.");return parseInt(n[2],10)}(n),r=Ti(window.location.search),u=Ti("".concat(n).split("?")[1]),o=Object.assign(r,u,i);return Si("".concat(t,"/video/").concat(e,"/config"),o)}function Qs(t,n){return-1!==Me(n).indexOf(t)}!function(t){for(var n=this,i=function i(e){return e.length>=t.length?t.apply(n,e):function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i([].concat(Y(e),n))}},e=arguments.length,r=new Array(e>1?e-1:0),u=1;u<e;u++)r[u-1]=arguments[u];i(r)}((function(t,n){return Object.keys(t).every((function(i){return t[i]===n[i]}))})),function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.reduce((function(t,n){return function(){return t(n.apply(void 0,arguments))}}))}((function(t){return t?Me(t.parentNode.children).indexOf(t):-1}),(function(t,n){for(;(null==(i=t)?void 0:i.parentElement)&&!Qs(t,n);){var i;t=t.parentElement}return Qs(t,n)?t:null}));var Zs=0;function ta(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"p",n=++Zs;return"".concat(t).concat(n)}ta(),ta(),ta(),ta();var na,ia,ea,ra,ua,oa,sa,aa=(P(na={},"vimeo.web_global",5),P(na,"workflow.copy_video_embed_code",5),P(na,"vimeo.player_performance_measurement",1),P(na,"vimeo.chapter_segment_click",2),P(na,"vimeo.click",83),P(na,"vimeo.embedded_transcript_click",6),P(na,"vimeo.closed_captions_click",2),P(na,"vimeo.multi_audio_track_click",1),P(ia={},"vimeo.web_global",["user","application","platform"]),P(ia,"workflow.copy_video_embed_code",["path","entry_page","page","location","video_id","video_privacy","video_embed_privacy","is_preset_applied","is_video_password_protected","video_app_id","team_owner_id","team_size","team_subscription_type","actor_team_role","video_status","upload_id","product","sizing","height","width","video_type","actor_resource_role","hash"]),P(ia,"vimeo.player_performance_measurement",["module_player","device_type","browser","device_os","iframed","measurement_type","measurement_value"]),P(ia,"vimeo.chapter_segment_click",["video_id","team_owner_id","is_chapter_seek","seek_event_start_time","nearest_chapter_start_time","chapter_seek_event_delta","fragment_no_chapters_at_seek","total_no_chapters_at_seek","is_creator_mode"]),P(ia,"vimeo.click",["page","location","target","name","copy","feature","type"]),P(ia,"vimeo.embedded_transcript_click",["name","embedded_transcript_session_id","total_clip_duration","video_timestamp","video_id","team_owner_id","default_transcript_language","session_duration","copy","location","element","current_transcript_language"]),P(ia,"vimeo.closed_captions_click",["video_id","video_privacy","language_selected","has_clicked_customize","has_customized","has_clicked_font","has_changed_font","has_clicked_background","has_changed_background","has_clicked_window","has_changed_window","has_reset_all","final_action_reset_all"]),P(ia,"vimeo.multi_audio_track_click",["event_name","video_id","video_privacy","initial_track","track_selected","has_selected_track","video_owner_id","page"]),"team_context"),ca=(P(ea={},aa,["team_owner_id","team_subscription_type","team_role","team_id","team_size","resource_permission_level","joined_team_at"]),P(ea,"action_context",["action_type","feature"]),P(ea,"view_context",["view_type","feature"]),P(ea,"web_context",["page_name","location","referrer_page_name","referrer","path","target","copy"]),P(ea,"video_context",["video_id","title","video_privacy","video_embed_privacy","content_rating","upload_method_api","upload_method_api_id","duration","resolution","video_height","video_width","orientation","is_auto_cc_enabled"]),P(ea,"player_context",["player_session_id","total_video_duration","video_timestamp"]),P(ra={},aa,5),P(ra,"action_context",4),P(ra,"view_context",2),P(ra,"web_context",6),P(ra,"video_context",2),P(ra,"player_context",2),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),ta(),{Wa:ta(),Ga:ta(),$a:ta(),Ya:ta(),or:ta(),za:ta(),Ka:ta(),Xa:ta(),Ja:ta(),Qa:ta(),Za:ta(),tc:ta(),nc:ta(),ic:ta(),ec:ta(),rc:ta(),uc:ta(),oc:ta(),sc:ta(),ac:ta(),cc:ta(),hc:ta(),fc:ta(),lc:ta(),dc:ta(),vc:ta(),pc:ta(),mc:ta(),yc:ta(),wc:ta(),bc:ta(),gc:ta(),_c:ta(),Ec:ta(),kc:ta(),Tc:ta(),Sc:ta(),Ac:ta(),Rc:ta(),Oc:ta(),Mc:ta(),jc:ta(),Cc:ta(),Ic:ta(),xc:ta(),Dc:ta(),Nc:ta(),Pc:ta(),Lc:ta(),Fc:ta(),Uc:ta(),Hc:ta(),Bc:ta(),Vc:ta(),qc:ta(),Wc:ta(),Gc:ta(),$c:ta(),Yc:ta(),zc:ta(),Kc:ta(),Xc:ta(),Jc:ta(),Qc:ta(),Zc:ta(),th:ta(),nh:ta(),ih:ta(),eh:ta(),rh:ta(),uh:ta(),oh:ta(),sh:ta(),ah:ta(),hh:ta(),fh:ta(),lh:ta(),dh:ta(),vh:ta(),ph:ta(),mh:ta(),yh:ta(),wh:ta(),bh:ta(),gh:ta(),_h:ta(),Eh:ta(),kh:ta(),Th:ta(),Sh:ta(),Ah:ta(),Rh:ta(),Oh:ta(),Mh:ta(),jh:ta(),Ch:ta(),Ih:ta(),xh:ta(),Dh:ta(),Nh:ta(),Ph:ta(),Lh:ta(),Fh:ta(),Uh:ta(),Hh:ta(),Bh:ta(),Vh:ta(),qh:ta(),_loadVideo:ta(),Wh:ta(),Gh:ta(),$h:ta(),Yh:ta(),zh:ta(),Kh:ta(),Xh:ta(),Jh:ta(),Qh:ta(),Zh:ta(),tf:ta(),nf:ta(),if:ta(),ef:ta(),rf:ta(),uf:ta(),sf:ta(),af:ta(),cf:ta(),ke:ta(),hf:ta(),ff:ta(),lf:ta(),df:ta(),vf:ta(),pf:ta(),mf:ta(),yf:ta(),wf:ta(),bf:ta(),gf:ta(),_f:ta(),Ef:ta(),kf:ta(),Tf:ta(),Sf:ta(),Af:ta(),Rf:ta(),Of:ta(),Mf:ta(),jf:ta(),Cf:ta(),If:ta(),xf:ta(),Df:ta(),Nf:ta(),Pf:ta(),Lf:ta(),Ff:ta(),Uf:ta(),Hf:ta(),Bf:ta()}),ha=(ta(),ta(),ta(),ta(),7),fa=(P(ua={},"one","000000"),P(ua,"two","00adef"),P(ua,"three","ffffff"),P(ua,"four","000000"),P(oa={},"one","color_one"),P(oa,"two","color_two"),P(oa,"three","color_three"),P(oa,"four","color_four"),P(sa={},"one","colorOne"),P(sa,"two","colorTwo"),P(sa,"three","colorThree"),P(sa,"four","colorFour"),function(){return{id:"network",title:Ks("Network error"),message:Ks("A network hiccup interrupted playback. Please {linkStart}reload the player{linkEnd} and try again.",{linkStart:'<a href="javascript:window.location.reload()" rel="noopener">',linkEnd:"</a>"}),final:!0}}),la=Object.freeze({__proto__:null,BrowserNotSupported:function(){return{id:"not-supported",title:Ks("Unsupported viewing environment"),message:Ks("Your system is having trouble playing this video. For more information, see our {linkStart}Help Center{linkEnd}.",{linkStart:'<a href="https://help.vimeo.com/hc/en-us/articles/115015677227-Troubleshoot-player-error-messages" target="_blank" rel="noopener" aria-describedby="new-window">',linkEnd:"</a>"}),deferred:!0,final:!0}},DRMFailure:function(){return{id:"drm-failure",title:Ks("Rights issue"),message:Ks("We’re having trouble authorizing playback for this video. "),final:!0}},FilesNotPlayable:function(){return{id:"not-supported",title:Ks("Player error"),message:Ks("The player is having trouble. We’ll have it back up and running as soon as possible."),deferred:!0,final:!0}},MediaSrcNotSupportedError:function(){return{id:"not-supported",final:!1}},MediaDecodeError:function(){return{id:"decode",final:!1}},MediaNetworkError:fa,MediaUnknownError:function(){return{id:"unknown",title:Ks("Browser error"),message:Ks("We’re having trouble playing this video file. Please {linkStart}reload the player{linkEnd} and try again.",{linkStart:'<a href="javascript:window.location.reload()" rel="noopener">',linkEnd:"</a>"}),final:!0}},FileError:function(){return{id:"telecine-file-error",final:!1}},DownloadError:function(){return{id:"telecine-download-error",final:!1}},MediaUrlExpired:function(){return{id:"media-url-expired",title:Ks("Playback error"),message:Ks("We’re having trouble playing this video. Please {linkStart}reload the player{linkEnd} and try again.",{linkStart:'<a href="javascript:window.location.reload()" rel="noopener">',linkEnd:"</a>"}),final:!1}},ScannerError:function(){return{id:"scanner-error",final:!1}},PlayerError:function(){return{id:"error",title:Ks("Player error"),message:Ks("The player is having trouble. We’ll have it back up and running as soon as possible."),modal:!0,final:!0}}});function da(t){return t.config.video.ecdn?t.config.video.live_event?"vimeo-live-ecdn":"vimeo-vod-ecdn":t.config.embed.wirewax?"vimeo-interactive-vod":t.config.request.flags.ott?"vimeo-ott-vod":t.config.video.webinar&&"ended"!==t.config.video.webinar.status?"vimeo-live-webinar":t.config.video.live_event?"vimeo-live":t.config.embed.context&&-1!==t.config.embed.context.indexOf("Stock")?"vimeo-stock-vod":t.config.video.vod?"vimeo-ondemand":"vimeo-vod"}var va=!!window.newrelic&&"function"==typeof window.newrelic.addToTrace&&"function"==typeof window.newrelic.noticeError&&"function"==typeof window.newrelic.setErrorHandler&&"function"==typeof window.newrelic.setCustomAttribute,pa=["chrome-extension:","moz-extension:"].includes(document.location.protocol),ma=Date.now(),ya=["NotAllowedError","AbortError","PlayInterrupted","Failed to load image","window.__withBuiltIn is not a function","window.__timeSinceLastTimeout is not a function","div:has(> iframe[id="],wa=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(va&&t){var i=Object.assign({},n,ba());newrelic.noticeError(t,i)}};function ba(){return{manually_captured:1,player_lifespan_seconds:Math.round((Date.now()-ma)/1e3)}}function ga(t){return Math.random()<=t}function _a(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,e=ga(i);e&&wa(t,n)}window.addEventListener("unhandledrejection",(function(t){t.preventDefault(),t.reason&&_a(t.reason,{unhandled_rejection:1})}));var Ea,ka={setUp:function(t){!function(t){va&&(function(t){var n,i={environment:"dev"===t.request.build.js?"dev":"production",js_modules:!1,version_js:t.request.build.js,version_backend:t.request.build.backend,visibility_state:document.visibilityState,vimeo_session:t.request.session,locale:t.request.lang,product:da({config:t}),video_embed_permission:t.video.embed_permission,video_privacy:t.video.privacy,live_session_id:null==(n=t.video.live_event)?void 0:n.id,rawUserAgent:navigator.userAgent};if(t.request.ab_tests)for(var e in t.request.ab_tests){var r=t.request.ab_tests[e];for(var u in i["".concat(e,"_test")]=1,i["".concat(e,"_group")]=r.group,r.data)i["".concat(e,"_data_").concat(u)]=r.data[u]}for(var o in t.user.logged_in&&(i.userId=t.user.id),i)newrelic.setCustomAttribute(o,i[o])}(t),newrelic.setErrorHandler((function(n){var i;return!!function(t,n){var i;return!!(Ge.appleMail||!n.request||pa||ya.some((function(n){var i,e;return(null==t||null==(i=t.message)?void 0:i.includes(n))||(null==t||null==(e=t.name)?void 0:e.includes(n))}))||(null==t||null==(i=t.message)?void 0:i.startsWith("ReportingObserver"))&&Math.random()>.01)}(n,t)||((null==n||null==(i=n.message)?void 0:i.startsWith("Non-Error exception captured"))&&newrelic.addToTrace({name:"nonErrorException",start:Date.now()}),!1)})))}(t.config)},captureException:_a,captureMessage:function(t){},captureBreadcrumb:function(t){!function(t){va&&newrelic.addToTrace({name:t,start:Date.now()})}(t)}};function Ta(t){var n=t.events,i=null,e=null,r=null,u=null,o=null,s={video:{},request:{},embed:{}};function a(){return e&&e-6e4<=Date.now()}function c(t){var n=Date.now()+1e3*t;return o=setTimeout((function(){"onLine"in navigator&&!navigator.onLine||u||(u=f().catch(ka.captureException))}),1e3*t-6e4-5e3),n}function h(t){var n,r,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(o);var a=i;if(isNaN(t)&&"string"!=typeof t)return e=c((i=t).request.expires),vi.resolve({old:a,loaded:i});Date.now();var h=(s=Ss(s,i)).request.referrer;h&&(u.referrer=h),s.video.webinar&&s.video.webinar.registrant&&(u.webinar_registrant_uuid=s.video.webinar.registrant),Ea||(Ea=Xs(t));var f=Ea||((null==(n=i)?void 0:n.player_url)?"https://".concat(null==(r=i)?void 0:r.player_url):""),l=Js(f,t,u);return $i(l,{withCredentials:!0,throwHttpErrors:!1}).json().then((function(t){return(i=t).view!==ha&&(e=c(i.request.expires),s.request.session&&i.video.id===s.video.id&&(i.request.session=s.request.session),h&&(i.request.referrer=h),s.embed.player_id&&(i.embed.player_id=s.embed.player_id),s.embed.on_site&&(i.embed.on_site=1,i.embed.context=s.embed.context)),Date.now(),{old:a,loaded:i}})).catch((function(t){ka.captureException(t)}))}function f(){var t;clearTimeout(o),Date.now();var r=null==(t=i)?void 0:t.request.referrer,s=i.request,a=s.signature,h=s.session,f=s.timestamp,l=s.expires,d=i.request.ott_chromecast_token,v="https://".concat(i.player_url,"/video/").concat(i.video.id,"/config/request?session=").concat(h,"&signature=").concat(a,"&time=").concat(f,"&expires=").concat(l);return d&&(v="".concat(v,"&ott_chromecast_token=").concat(d)),r&&(v+="".concat(-1===v.indexOf("?")?"?":"&","referrer=").concat(encodeURIComponent(r))),$i(v,{withCredentials:!0,retry:3}).json().then((function(t){return i.request=t,r&&(i.request.referrer=r),e=c(i.request.expires),Date.now(),u=null,n.fire(ca.Ih),i.request})).catch((function(t){var i=fa();throw n.fire(ca.Ga,i.id,i),t}))}return window.addEventListener("online",(function(){a()&&(u=f().catch(ka.captureException))})),n.on(ca.Ga,(function(t){u||"media-url-expired"!==t||(u=f().catch(ka.captureException))})),{get isExpired(){return a()},load:function(t,n){return h(t,n)},reload:function(){var t;return(null==(t=i)?void 0:t.video.id)?h(i.video.id):vi.reject(new Error("No config loaded."))},toJSON:function(){return i},get config(){return i},set config(t){i=t},verify:function(){return a()?(u||(u=f()),u):vi.resolve(i.request)},loadRequest:function(){return f()},get U(){return r},set U(t){r=t}}}t.BarebonePlayer=function(t,n){bs(ka);var i=null,e=document.createElement("style");e.setAttribute("type","text/css"),e.textContent="\n    .vp-telecine video {\n        width: 100%;\n        height: auto;\n    }\n",t.appendChild(e);var r=document.createElement("div");r.className="vp-video-wrapper";var u=document.createElement("div");u.className="vp-video";var o=document.createElement("div");o.className="vp-telecine",u.appendChild(o),r.appendChild(u),t.appendChild(r);var s=ai(),a=new Ta({events:s});function c(t){var n=la[t.name],i="function"==typeof n?n():{};"media-url-expired"===i.id&&s.fire(ca.Ga,i.id,i)}return s.on(ca.Ih,(function(){(null==a?void 0:a.config)&&i&&i.loadVideo(a.config)})),a.load(n).then((function(){return(i=new Ys(o,a.config)).on(ye.ERROR,c),i.loadVideo(a.config),i}))},Object.defineProperty(t,"Vf",{value:!0})}(this.window=this.window||{});

